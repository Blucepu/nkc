!function r(s,c,d){function u(e,t){if(!c[e]){if(!s[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(a)return a(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var i=c[e]={exports:{}};s[e][0].call(i.exports,function(t){return u(s[e][1][t]||t)},i,i.exports,r,s,c,d)}return c[e].exports}for(var a="function"==typeof require&&require,t=0;t<d.length;t++)u(d[t]);return u}({1:[function(t,e,n){"use strict";var o=NKC.methods.getDataById("data");o.note.notes.map(function(t){t.edit=!1,t.options=!1});var s=new Vue({el:"#note",data:{uid:NKC.configs.uid,note:o.note,submitting:!1,content:""},mounted:function(){document.body.addEventListener("click",function(t){t.target.classList.contains("note-options-icon")||s.note.notes.map(function(t){return t.options=!1})})},methods:{visitUrl:NKC.methods.visitUrl,getUrl:NKC.methods.tools.getUrl,fromNow:NKC.methods.fromNow,openOptions:function(t){s.note.notes.map(function(t){return t.options=!1}),t.options=!t.options},resetTextarea:function(t){var e=t?this.$refs[t._id][0]:this.$refs.newNote;e&&(e.style.height="5rem",60<e.scrollHeight&&(e.style.height=e.scrollHeight+"px"))},saveNewNote:function(){var i=this.content,r=this.note;Promise.resolve().then(function(){if(!i)throw"请输入笔记内容";var t=r.type,e=r.targetId,n=r._id,o=r.node;return s.submitting=!0,nkcAPI("/note","POST",{_id:n,type:t,targetId:e,node:o,content:i})}).then(function(t){s.content="",t.note.notes.map(function(t){t.options=!1,t.edit=!1}),s.note=t.note,s.submitting=!1,setTimeout(function(){s.resetTextarea()},50)}).catch(function(t){s.submitting=!1,sweetError(t)})},saveNote:function(e){var t,n,o=this.note,i=this.uid,r={};e.uid===i?(t="/note/".concat(o._id,"/c/").concat(e._id),n="PUT"):(t="/nkc/note",n="POST",r.type="modify",r.noteId=o._id,r.noteContentId=e._id),r.content=e.content,nkcAPI(t,n,r).then(function(t){e.html=t.noteContentHTML,s.modifyNoteContent(e),Vue.set(o.notes,o.notes.indexOf(e),e)}).catch(sweetError)},modifyNoteContent:function(t){t.edit=!t.edit,t.edit&&setTimeout(function(){s.resetTextarea(t)},50)},deleteNoteContent:function(t,e){var n,o,i=this.note,r={};"delete"===e?(n="/note/".concat(i._id,"/c/").concat(t._id),o="DELETE"):(o="POST",n="/nkc/note",t.disabled?r.type="cancelDisable":r.type="disable",r.noteId=i._id,r.noteContentId=t._id),sweetQuestion("确定要执行此操作？").then(function(){return nkcAPI(n,o,r)}).then(function(){"delete"===e?t.deleted=!0:t.disabled=!t.disabled,sweetSuccess("操作成功")}).catch(sweetError)}}})},{}]},{},[1]);