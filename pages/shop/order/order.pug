extends ../account/shopAccountBase
block shopAccountTitle
  title=`我的订单 | 科创商城`
block shopAccountContent
  .row
    //- .col-md-12.col-sm-12.col-xs-12
    //-   button.btn.btn-primary(onclick=`addClassify()`) 添加分类
    .col-md-12.col-sm-12.col-xs-12(style="margin-bottom:20px")
      ul.nav.nav-pills(style="border:1px solid #ddd")
        li(class=!data.orderStatus || data.orderStatus == "all"?"active":"")
          a(href=`/shop/order?orderStatus=all`, data-toggle='url') 全部订单
        li(class=data.orderStatus == "unCost"?"active":"")
          a(href=`/shop/order?orderStatus=unCost`, data-toggle='url') 待付款
        li(class=data.orderStatus == "unShip"?"active":"")
          a(href=`/shop/order?orderStatus=unShip`, data-toggle='url') 待发货
        li(class=data.orderStatus == "unSign"?"active":"")
          a(href=`/shop/order?orderStatus=unSign`, data-toggle='url') 待收货
        li(class=data.orderStatus == "finish"?"active":"")
          a(href=`/shop/order?orderStatus=finish`, data-toggle='url') 完成的订单
        li(class=data.orderStatus == "close"?"active":"") 
          a(href=`/shop/order?orderStatus=close`, data-toggle="url") 关闭的订单
        li(class=data.orderStatus == "refunding"?"active":"")
          a(href=`/shop/order?orderStatus=refunding`, data-toggle='url') 退款中的订单
    .col-md-12.col-sm-12.col-xs-12(style="text-align:end")
      include ../../interface_navigation_paging
    .col-md-12.col-sm-12.col-xs-12  
      table.table.table-bordered
        thead
          tr(style="background-color:silver")
            th(style="width:200px") 商品名称
            //- th 属性
            th 商家
            th 交易状态
            th 商品单价
            th 数量
            th 运费
            th 实际收付款
            th 交易操作
        tbody
          for order in data.orders
            tr(style="background-color: #d3f2ff;border-top:2px solid black;") 
              td(colspan="11") 
                p
                  span(style="font-weight:800") 订单号:&nbsp;
                  span=order.orderId
                  span(style="margin-left:20px;font-weight:800") 创建时间:&nbsp;
                  span=order.orderToc.toLocaleString()
            //- tr(style="border-bottom:20px solid white;")
            tr(style="min-height:100px")
              //- td=order.orderId
              //- td=order.orderToc.toLocaleString()
              td
                //- img(src=`/r/${order.product.imgMaster}` style="width:100px;height:100px")
                span
                  a(href=`/shop/product/${order.product.productId}` target="_blank")=order.product.name
                span(style="font-size:18px;color:red;font-weight:800;margin-left:10px")=order.productParam.name
              //- td=order.productParam.name
              td
                a(href=`/shop/store/${order.product.storeId}`)!=`${order.product.store.storeName}`
              td= order.status
                | &nbsp;  
                a(href=`/shop/order/${order.orderId}/detail` target="_blank") 订单详情
              td #{numToFloatTwo(order.productParam.price)}
              td=order.count
              td #{numToFloatTwo(calculateFreightPrice(order.product.freightPrice,order.count,order.product.isFreePost))}
              //- td=order.user.username
              td #{numToFloatTwo(order.orderPrice)}
              td 
                if order.orderStatus !== "finish" && order.closeStatus !== true
                  if order.orderStatus === "unCost"
                    a(href=`/shop/order/${order.orderId}/refund`) 取消订单
                  else 
                    a(href=`/shop/order/${order.orderId}/refund`) 申请退款
                if order.orderStatus == "unCost"&& order.closeStatus !== true
                  p
                    a(href=`/shop/pay?ordersId=${order.orderId}`) 立即付款
                if order.orderStatus == "unSign" || order.orderStatus == "finish"
                  p
                    button(onclick=`visitLogisticsInfo(${order.orderId})`) 查看物流
                if order.refundStatus == "ing"
                  p
                    a(href=`/shop/order/${order.orderId}/refund`) 退款详情
                if order.orderStatus == "unSign" && order.closeStatus !== true
                  p
                    button(onclick=`comfirmReceipt(${order.orderId})`) 确认收货
                if order.orderStatus == "finish"
                  p
                    button(onclick=`joinToDiscuss(${order.product.tid})`) 参与讨论
    .col-md-12.col-sm-12.col-xs-12(style="text-align:end")
      include ../../interface_navigation_paging
block shopScripts
  +includeJS('/shop/cart/cart.js')
  +includeJS('/shop/order/order.js')
