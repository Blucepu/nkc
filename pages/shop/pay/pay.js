(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

var data = NKC.methods.getDataById('data');
var app = new Vue({
  el: '#app',
  data: {
    rechargeSettings: data.rechargeSettings,
    userMainScore: data.userMainScore,
    mainScore: data.mainScore,
    totalMoney: data.totalMoney,
    ordersId: data.ordersId,
    payment: 'mainScore',
    password: ''
  },
  computed: {
    aliPay: function aliPay() {
      var a = this.rechargeSettings.aliPay;
      var totalPrice = this.totalMoney / (1 - a.fee);
      var feePrice = totalPrice - this.totalMoney;
      return {
        enabled: a.enabled,
        fee: a.fee,
        _fee: Number((a.fee * 100).toFixed(4)),
        totalPrice: Number(totalPrice.toFixed(2)),
        feePrice: Number(feePrice.toFixed(2))
      };
    },
    weChat: function weChat() {
      return this.rechargeSettings.weChat;
    },
    needRecharge: function needRecharge() {
      var userMainScore = this.userMainScore,
          totalMoney = this.totalMoney;
      return userMainScore / 100 < totalMoney;
    }
  },
  methods: {
    getUrl: NKC.methods.tools.getUrl,
    selectPayment: function selectPayment(type) {
      this.payment = type;
    },
    submit: function submit() {
      var password = this.password,
          ordersId = this.ordersId,
          totalMoney = this.totalMoney;
      var self = this;
      Promise.resolve().then(function () {
        if (!password) throw '请输入登录密码';
        return nkcAPI('/shop/pay', 'POST', {
          ordersId: ordersId,
          password: password,
          totalPrice: totalMoney
        });
      }).then(function () {
        sweetSuccess('支付成功');
        self.password = '';
        setTimeout(function () {
          NKC.methods.visitUrl('/shop/order');
        }, 3000);
      })["catch"](sweetError);
    },
    useAliPay: function useAliPay() {
      var ordersId = this.ordersId,
          aliPay = this.aliPay;
      var totalPrice = aliPay.totalPrice,
          feePrice = aliPay.feePrice;
      var url = "/shop/pay/alipay?ordersId=".concat(ordersId, "&money=").concat(totalPrice);
      var isPhone = NKC.methods.isPhone();
      var newWindow;

      if (NKC.configs.platform !== 'reactNative') {
        if (isPhone) {
          url += '&redirect=true';
          screenTopAlert('正在前往支付宝...');
          return window.location.href = url;
        } else {
          newWindow = window.open();
        }
      }

      Promise.resolve().then(function () {
        return nkcAPI(url, 'GET').then(function (data) {
          if (NKC.configs.platform === 'reactNative') {
            NKC.methods.visitUrl(data.alipayUrl, true);
          } else {
            newWindow.location = data.alipayUrl;
          }

          sweetInfo('请在浏览器新打开的窗口完成支付！若没有新窗口打开，请检查新窗口是否已被浏览器拦截。');
        })["catch"](function (err) {
          sweetError(err);

          if (newWindow) {
            newWindow.document.body.innerHTML = err.error || err;
          }
        });
      });
    }
  }
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwYWdlcy9zaG9wL3BheS9wYXkubWpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxJQUFNLElBQUksR0FBRyxHQUFHLENBQUMsT0FBSixDQUFZLFdBQVosQ0FBd0IsTUFBeEIsQ0FBYjtBQUVBLElBQU0sR0FBRyxHQUFHLElBQUksR0FBSixDQUFRO0FBQ2xCLEVBQUEsRUFBRSxFQUFFLE1BRGM7QUFFbEIsRUFBQSxJQUFJLEVBQUU7QUFDSixJQUFBLGdCQUFnQixFQUFFLElBQUksQ0FBQyxnQkFEbkI7QUFFSixJQUFBLGFBQWEsRUFBRSxJQUFJLENBQUMsYUFGaEI7QUFHSixJQUFBLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FIWjtBQUlKLElBQUEsVUFBVSxFQUFFLElBQUksQ0FBQyxVQUpiO0FBS0osSUFBQSxRQUFRLEVBQUUsSUFBSSxDQUFDLFFBTFg7QUFNSixJQUFBLE9BQU8sRUFBRSxXQU5MO0FBT0osSUFBQSxRQUFRLEVBQUU7QUFQTixHQUZZO0FBV2xCLEVBQUEsUUFBUSxFQUFFO0FBQ1IsSUFBQSxNQURRLG9CQUNDO0FBQ1AsVUFBTSxDQUFDLEdBQUcsS0FBSyxnQkFBTCxDQUFzQixNQUFoQztBQUNBLFVBQUksVUFBVSxHQUFHLEtBQUssVUFBTCxJQUFtQixJQUFJLENBQUMsQ0FBQyxHQUF6QixDQUFqQjtBQUNBLFVBQUksUUFBUSxHQUFHLFVBQVUsR0FBRyxLQUFLLFVBQWpDO0FBQ0EsYUFBTztBQUNMLFFBQUEsT0FBTyxFQUFFLENBQUMsQ0FBQyxPQUROO0FBRUwsUUFBQSxHQUFHLEVBQUUsQ0FBQyxDQUFDLEdBRkY7QUFHTCxRQUFBLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRixHQUFRLEdBQVQsRUFBYyxPQUFkLENBQXNCLENBQXRCLENBQUQsQ0FIUDtBQUlMLFFBQUEsVUFBVSxFQUFFLE1BQU0sQ0FBRSxVQUFVLENBQUMsT0FBWCxDQUFtQixDQUFuQixDQUFGLENBSmI7QUFLTCxRQUFBLFFBQVEsRUFBRSxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQVQsQ0FBaUIsQ0FBakIsQ0FBRDtBQUxYLE9BQVA7QUFPRCxLQVpPO0FBYVIsSUFBQSxNQWJRLG9CQWFDO0FBQ1AsYUFBTyxLQUFLLGdCQUFMLENBQXNCLE1BQTdCO0FBQ0QsS0FmTztBQWdCUixJQUFBLFlBaEJRLDBCQWdCTztBQUFBLFVBQ04sYUFETSxHQUN1QixJQUR2QixDQUNOLGFBRE07QUFBQSxVQUNTLFVBRFQsR0FDdUIsSUFEdkIsQ0FDUyxVQURUO0FBRWIsYUFBTyxhQUFhLEdBQUcsR0FBaEIsR0FBc0IsVUFBN0I7QUFDRDtBQW5CTyxHQVhRO0FBZ0NsQixFQUFBLE9BQU8sRUFBRTtBQUNQLElBQUEsTUFBTSxFQUFFLEdBQUcsQ0FBQyxPQUFKLENBQVksS0FBWixDQUFrQixNQURuQjtBQUVQLElBQUEsYUFGTyx5QkFFTyxJQUZQLEVBRWE7QUFDbEIsV0FBSyxPQUFMLEdBQWUsSUFBZjtBQUNELEtBSk07QUFLUCxJQUFBLE1BTE8sb0JBS0U7QUFBQSxVQUNBLFFBREEsR0FDa0MsSUFEbEMsQ0FDQSxRQURBO0FBQUEsVUFDVSxRQURWLEdBQ2tDLElBRGxDLENBQ1UsUUFEVjtBQUFBLFVBQ29CLFVBRHBCLEdBQ2tDLElBRGxDLENBQ29CLFVBRHBCO0FBRVAsVUFBTSxJQUFJLEdBQUcsSUFBYjtBQUNBLE1BQUEsT0FBTyxDQUFDLE9BQVIsR0FDRyxJQURILENBQ1EsWUFBTTtBQUNWLFlBQUcsQ0FBQyxRQUFKLEVBQWMsTUFBTSxTQUFOO0FBQ2QsZUFBTyxNQUFNLENBQUMsV0FBRCxFQUFjLE1BQWQsRUFBc0I7QUFDakMsVUFBQSxRQUFRLEVBQVIsUUFEaUM7QUFFakMsVUFBQSxRQUFRLEVBQVIsUUFGaUM7QUFHakMsVUFBQSxVQUFVLEVBQUU7QUFIcUIsU0FBdEIsQ0FBYjtBQUtELE9BUkgsRUFTRyxJQVRILENBU1EsWUFBTTtBQUNWLFFBQUEsWUFBWSxDQUFDLE1BQUQsQ0FBWjtBQUNBLFFBQUEsSUFBSSxDQUFDLFFBQUwsR0FBZ0IsRUFBaEI7QUFDQSxRQUFBLFVBQVUsQ0FBQyxZQUFNO0FBQ2YsVUFBQSxHQUFHLENBQUMsT0FBSixDQUFZLFFBQVosQ0FBcUIsYUFBckI7QUFDRCxTQUZTLEVBRVAsSUFGTyxDQUFWO0FBR0QsT0FmSCxXQWdCUyxVQWhCVDtBQWlCRCxLQXpCTTtBQTBCUCxJQUFBLFNBMUJPLHVCQTBCSztBQUFBLFVBQ0gsUUFERyxHQUNpQixJQURqQixDQUNILFFBREc7QUFBQSxVQUNPLE1BRFAsR0FDaUIsSUFEakIsQ0FDTyxNQURQO0FBQUEsVUFFSCxVQUZHLEdBRXFCLE1BRnJCLENBRUgsVUFGRztBQUFBLFVBRVMsUUFGVCxHQUVxQixNQUZyQixDQUVTLFFBRlQ7QUFHVixVQUFJLEdBQUcsdUNBQWdDLFFBQWhDLG9CQUFrRCxVQUFsRCxDQUFQO0FBQ0EsVUFBTSxPQUFPLEdBQUcsR0FBRyxDQUFDLE9BQUosQ0FBWSxPQUFaLEVBQWhCO0FBQ0EsVUFBSSxTQUFKOztBQUNBLFVBQUcsR0FBRyxDQUFDLE9BQUosQ0FBWSxRQUFaLEtBQXlCLGFBQTVCLEVBQTJDO0FBQ3pDLFlBQUcsT0FBSCxFQUFZO0FBQ1YsVUFBQSxHQUFHLElBQUksZ0JBQVA7QUFDQSxVQUFBLGNBQWMsQ0FBQyxZQUFELENBQWQ7QUFDQSxpQkFBTyxNQUFNLENBQUMsUUFBUCxDQUFnQixJQUFoQixHQUF1QixHQUE5QjtBQUNELFNBSkQsTUFJTztBQUNMLFVBQUEsU0FBUyxHQUFHLE1BQU0sQ0FBQyxJQUFQLEVBQVo7QUFDRDtBQUNGOztBQUNELE1BQUEsT0FBTyxDQUFDLE9BQVIsR0FDRyxJQURILENBQ1EsWUFBTTtBQUNWLGVBQU8sTUFBTSxDQUFDLEdBQUQsRUFBTSxLQUFOLENBQU4sQ0FDSixJQURJLENBQ0MsVUFBQSxJQUFJLEVBQUk7QUFDWixjQUFHLEdBQUcsQ0FBQyxPQUFKLENBQVksUUFBWixLQUF5QixhQUE1QixFQUEyQztBQUN6QyxZQUFBLEdBQUcsQ0FBQyxPQUFKLENBQVksUUFBWixDQUFxQixJQUFJLENBQUMsU0FBMUIsRUFBcUMsSUFBckM7QUFDRCxXQUZELE1BRU87QUFDTCxZQUFBLFNBQVMsQ0FBQyxRQUFWLEdBQXFCLElBQUksQ0FBQyxTQUExQjtBQUNEOztBQUNELFVBQUEsU0FBUyxDQUFDLDJDQUFELENBQVQ7QUFDRCxTQVJJLFdBU0UsVUFBQSxHQUFHLEVBQUk7QUFDWixVQUFBLFVBQVUsQ0FBQyxHQUFELENBQVY7O0FBQ0EsY0FBRyxTQUFILEVBQWM7QUFDWixZQUFBLFNBQVMsQ0FBQyxRQUFWLENBQW1CLElBQW5CLENBQXdCLFNBQXhCLEdBQW9DLEdBQUcsQ0FBQyxLQUFKLElBQWEsR0FBakQ7QUFDRDtBQUNGLFNBZEksQ0FBUDtBQWVELE9BakJIO0FBa0JEO0FBM0RNO0FBaENTLENBQVIsQ0FBWiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImNvbnN0IGRhdGEgPSBOS0MubWV0aG9kcy5nZXREYXRhQnlJZCgnZGF0YScpO1xyXG5cclxuY29uc3QgYXBwID0gbmV3IFZ1ZSh7XHJcbiAgZWw6ICcjYXBwJyxcclxuICBkYXRhOiB7XHJcbiAgICByZWNoYXJnZVNldHRpbmdzOiBkYXRhLnJlY2hhcmdlU2V0dGluZ3MsXHJcbiAgICB1c2VyTWFpblNjb3JlOiBkYXRhLnVzZXJNYWluU2NvcmUsXHJcbiAgICBtYWluU2NvcmU6IGRhdGEubWFpblNjb3JlLFxyXG4gICAgdG90YWxNb25leTogZGF0YS50b3RhbE1vbmV5LFxyXG4gICAgb3JkZXJzSWQ6IGRhdGEub3JkZXJzSWQsXHJcbiAgICBwYXltZW50OiAnbWFpblNjb3JlJyxcclxuICAgIHBhc3N3b3JkOiAnJyxcclxuICB9LFxyXG4gIGNvbXB1dGVkOiB7XHJcbiAgICBhbGlQYXkoKSB7XHJcbiAgICAgIGNvbnN0IGEgPSB0aGlzLnJlY2hhcmdlU2V0dGluZ3MuYWxpUGF5O1xyXG4gICAgICBsZXQgdG90YWxQcmljZSA9IHRoaXMudG90YWxNb25leSAvICgxIC0gYS5mZWUpO1xyXG4gICAgICBsZXQgZmVlUHJpY2UgPSB0b3RhbFByaWNlIC0gdGhpcy50b3RhbE1vbmV5O1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGVuYWJsZWQ6IGEuZW5hYmxlZCxcclxuICAgICAgICBmZWU6IGEuZmVlLFxyXG4gICAgICAgIF9mZWU6IE51bWJlcigoYS5mZWUgKiAxMDApLnRvRml4ZWQoNCkpLFxyXG4gICAgICAgIHRvdGFsUHJpY2U6IE51bWJlcigodG90YWxQcmljZS50b0ZpeGVkKDIpKSksXHJcbiAgICAgICAgZmVlUHJpY2U6IE51bWJlcihmZWVQcmljZS50b0ZpeGVkKDIpKVxyXG4gICAgICB9O1xyXG4gICAgfSxcclxuICAgIHdlQ2hhdCgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMucmVjaGFyZ2VTZXR0aW5ncy53ZUNoYXQ7XHJcbiAgICB9LFxyXG4gICAgbmVlZFJlY2hhcmdlKCkge1xyXG4gICAgICBjb25zdCB7dXNlck1haW5TY29yZSwgdG90YWxNb25leX0gPSB0aGlzO1xyXG4gICAgICByZXR1cm4gdXNlck1haW5TY29yZSAvIDEwMCA8IHRvdGFsTW9uZXk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgbWV0aG9kczoge1xyXG4gICAgZ2V0VXJsOiBOS0MubWV0aG9kcy50b29scy5nZXRVcmwsXHJcbiAgICBzZWxlY3RQYXltZW50KHR5cGUpIHtcclxuICAgICAgdGhpcy5wYXltZW50ID0gdHlwZTtcclxuICAgIH0sXHJcbiAgICBzdWJtaXQoKSB7XHJcbiAgICAgIGNvbnN0IHtwYXNzd29yZCwgb3JkZXJzSWQsIHRvdGFsTW9uZXl9ID0gdGhpcztcclxuICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgIFByb21pc2UucmVzb2x2ZSgpXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgaWYoIXBhc3N3b3JkKSB0aHJvdyAn6K+36L6T5YWl55m75b2V5a+G56CBJztcclxuICAgICAgICAgIHJldHVybiBua2NBUEkoJy9zaG9wL3BheScsICdQT1NUJywge1xyXG4gICAgICAgICAgICBvcmRlcnNJZCxcclxuICAgICAgICAgICAgcGFzc3dvcmQsXHJcbiAgICAgICAgICAgIHRvdGFsUHJpY2U6IHRvdGFsTW9uZXlcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgc3dlZXRTdWNjZXNzKCfmlK/ku5jmiJDlip8nKTtcclxuICAgICAgICAgIHNlbGYucGFzc3dvcmQgPSAnJztcclxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICBOS0MubWV0aG9kcy52aXNpdFVybCgnL3Nob3Avb3JkZXInKTtcclxuICAgICAgICAgIH0sIDMwMDApO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKHN3ZWV0RXJyb3IpO1xyXG4gICAgfSxcclxuICAgIHVzZUFsaVBheSgpIHtcclxuICAgICAgY29uc3Qge29yZGVyc0lkLCBhbGlQYXl9ID0gdGhpcztcclxuICAgICAgY29uc3Qge3RvdGFsUHJpY2UsIGZlZVByaWNlfSA9IGFsaVBheTtcclxuICAgICAgbGV0IHVybCA9IGAvc2hvcC9wYXkvYWxpcGF5P29yZGVyc0lkPSR7b3JkZXJzSWR9Jm1vbmV5PSR7dG90YWxQcmljZX1gO1xyXG4gICAgICBjb25zdCBpc1Bob25lID0gTktDLm1ldGhvZHMuaXNQaG9uZSgpO1xyXG4gICAgICBsZXQgbmV3V2luZG93O1xyXG4gICAgICBpZihOS0MuY29uZmlncy5wbGF0Zm9ybSAhPT0gJ3JlYWN0TmF0aXZlJykge1xyXG4gICAgICAgIGlmKGlzUGhvbmUpIHtcclxuICAgICAgICAgIHVybCArPSAnJnJlZGlyZWN0PXRydWUnO1xyXG4gICAgICAgICAgc2NyZWVuVG9wQWxlcnQoJ+ato+WcqOWJjeW+gOaUr+S7mOWunS4uLicpO1xyXG4gICAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdXJsO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBuZXdXaW5kb3cgPSB3aW5kb3cub3BlbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBQcm9taXNlLnJlc29sdmUoKVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgIHJldHVybiBua2NBUEkodXJsLCAnR0VUJylcclxuICAgICAgICAgICAgLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYoTktDLmNvbmZpZ3MucGxhdGZvcm0gPT09ICdyZWFjdE5hdGl2ZScpIHtcclxuICAgICAgICAgICAgICAgIE5LQy5tZXRob2RzLnZpc2l0VXJsKGRhdGEuYWxpcGF5VXJsLCB0cnVlKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbmV3V2luZG93LmxvY2F0aW9uID0gZGF0YS5hbGlwYXlVcmw7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIHN3ZWV0SW5mbygn6K+35Zyo5rWP6KeI5Zmo5paw5omT5byA55qE56qX5Y+j5a6M5oiQ5pSv5LuY77yB6Iul5rKh5pyJ5paw56qX5Y+j5omT5byA77yM6K+35qOA5p+l5paw56qX5Y+j5piv5ZCm5bey6KKr5rWP6KeI5Zmo5oum5oiq44CCJyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICAgIHN3ZWV0RXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgICBpZihuZXdXaW5kb3cpIHtcclxuICAgICAgICAgICAgICAgIG5ld1dpbmRvdy5kb2N1bWVudC5ib2R5LmlubmVySFRNTCA9IGVyci5lcnJvciB8fCBlcnI7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxufSk7XHJcbiJdfQ==
