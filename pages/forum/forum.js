!function n(r,i,a){function d(e,t){if(!i[e]){if(!r[e]){var o="function"==typeof require&&require;if(!t&&o)return o(e,!0);if(s)return s(e,!0);throw(o=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",o}o=i[e]={exports:{}},r[e][0].call(o.exports,function(t){return d(r[e][1][t]||t)},o,o.exports,n,r,i,a)}return i[e].exports}for(var s="function"==typeof require&&require,t=0;t<a.length;t++)d(a[t]);return d}({1:[function(t,e,o){"use strict";var n=NKC.methods.getDataById("forumInfo"),r=n.fid,a=n.page,d=n.digest,s=n.sort;$(function(){var t=$("#navbar_custom_dom"),e=$("#leftDom");t.html(e.html()),NKC.configs.lid&&(window.Library=new NKC.modules.Library({lid:NKC.configs.lid,folderId:NKC.configs.folderId,tLid:NKC.configs.tLid,closed:NKC.configs.closed,uploadResourcesId:NKC.configs.uploadResourcesId?NKC.configs.uploadResourcesId.split("-"):[]}));e=$("#threadUrlSwitch");e.length&&(c("true"===localStorage.getItem(i)),e.on("click",function(){c($(this).prop("checked"))})),NKC.configs.uid&&(socket.on("connect",function(){l()}),socket.on("forumMessage",function(t){var e=t.html,o=t.tid,n=t.contentType,r=$("div.normal-thread-list"),i=r.find('div[data-tid="'+o+'"]')||{a:1};if(0!==a||d!==t.digest||"thread"!==n&&"tlm"!==s){if(!i)return}else i.remove(),i=$(e),r.prepend(i);i=NKC.methods.getThreadListNewPostCount(o);i++,NKC.methods.setThreadListNewPostCount(o,i),u(o,i),floatUserPanel.initPanel(),floatForumPanel.initPanel()}),socket.connected&&l(),function t(){setTimeout(function(){f(),t()},1e4)}(),document.body.addEventListener("click",function(t){t=t.target;"a"===t.tagName.toLowerCase()&&(t=(t=$(t)).attr("href"),/^\/t\/([0-9]+)\??/gi.test(t)&&(t=RegExp.$1,NKC.methods.setThreadListNewPostCount(t,0),u(t,0)))}),f())});var i="forum_thread_a_target";function c(t){var e=t?"_blank":"_self";$(".thread-panel-url").attr("target",e),$("#threadUrlSwitch").prop("checked",!!t),t=t,localStorage.setItem(i,t)}function l(){socket.emit("joinRoom",{type:"forum",data:{forumId:r}})}function f(){for(var t=$("div.normal-thread-list").find(".thread-panel"),e=0;e<t.length;e++){var o=t.eq(e).attr("data-tid");u(o,NKC.methods.getThreadListNewPostCount(o))}}function u(t,e){var o=$("div.normal-thread-list"),n=o.find('div[data-tid="'+t+'"]');n.length&&(o.find('div[data-tid="'+t+'"] span.thread-panel-counter').remove(),0!==e&&(e=$("<span class='thread-panel-counter' data-count='"+e+"' title='"+e+"条更新'>"+e+"</span>"),n.prepend(e)))}window.openEditSite=function(){var t=window.location.origin+"/editor?type=forum&id="+r;"reactNative"===NKC.configs.platform?NKC.methods.rn.emit("openEditorPage",{url:t}):"apiCloud"===NKC.configs.platform?api.openWin({name:t,url:"widget://html/common/editorInfo.html",pageParam:{realUrl:t,shareType:"common"}}):NKC.methods.visitUrl(t,!0)}},{}]},{},[1]);