!function n(e,s,r){function d(o,t){if(!s[o]){if(!e[o]){var i="function"==typeof require&&require;if(!t&&i)return i(o,!0);if(u)return u(o,!0);throw(i=new Error("Cannot find module '"+o+"'")).code="MODULE_NOT_FOUND",i}i=s[o]={exports:{}},e[o][0].call(i.exports,function(t){return d(e[o][1][t]||t)},i,i.exports,n,e,s,r)}return s[o].exports}for(var u="function"==typeof require&&require,t=0;t<r.length;t++)d(r[t]);return d}({1:[function(t,o,i){"use strict";var n,e;function s(){return e.apply(this,arguments)}window.PostOption=new Vue({el:"#modulePostOptions",data:{show:!1,loading:!0,jqDOM:null,uid:NKC.configs.uid,pid:"",postType:"",isComment:!1,postUserId:"",tid:"",toc:"",author:{username:"",uid:""},top:300,left:300,domHeight:0,domWidth:0,anonymous:null,anonymousUser:null,blacklist:null,collection:null,complaint:null,digest:null,disable:null,edit:null,hidePost:null,history:null,inColumn:null,kcb:null,subscribe:null,topped:null,violation:null,warningPost:null,xsf:null,ipInfo:null,reviewed:null,commentControl:null},computed:{position:function(){var t=this.direction,o=this.jqDOM,i=this.domHeight,n=this.domWidth;if(null===o)return{left:0,top:0};var e=o.offset(),s=e.top,e=e.left;return"up"===t?{top:s-i,left:e-n+o.width()}:{top:s+o.height(),left:e+o.width()-n}}},mounted:function(){var o=this;document.addEventListener("click",function(t){o.show=!1})},updated:function(){var t=$(this.$el);this.domHeight=t.height(),this.domWidth=t.width()},methods:{getUrl:NKC.methods.tools.getUrl,format:NKC.methods.format,visitUrl:NKC.methods.visitUrl,clickElement:function(t){t.stopPropagation()},close:function(){this.show=!1},open:function(t){var o=t.pid,i=t.direction,t=t.jqDOM;this.jqDOM=t,this.direction=i;var u=this;u.show=!0,u.loading=!0,nkcAPI("/p/".concat(o,"/option"),"GET").then(function(t){var o=t.tid,i=t.pid,n=t.toc,e=t.options,s=t.userColumnId,r=t.postType,d=t.postUserId,t=t.isComment;u.isComment=t,u.anonymous=e.anonymous,u.anonymousUser=e.anonymousUser,u.blacklist=e.blacklist,u.collection=e.collection,u.complaint=e.complaint,u.digest=e.digest,u.disable=e.disable,u.edit=e.edit,u.hidePost=e.hidePost,u.history=e.history,u.inColumn=e.inColumn,u.kcb=e.kcb,u.subscribe=e.subscribe,u.topped=e.topped,u.violation=e.violation,u.warningPost=e.warningPost,u.xsf=e.xsf,u.ipInfo=e.ipInfo,u.reviewed=e.reviewed,u.commentControl=e.commentControl,u.userColumnId=s,u.postType=r,u.tid=o,u.pid=i,u.toc=n,u.postUserId=d,u.loading=!1}).catch(function(t){sweetError(t)})},toColumn:function(){var t=this.inColumn,o=this.pid,i=this.userColumnId;(t?removeToColumn:addToColumn)(o,i)},setAnonymous:function(){var o=this,t=this.anonymous,i=this.pid;nkcAPI("/p/"+i+"/anonymous","POST",{anonymous:!t}).then(function(t){o.anonymous=t.anonymous,o.anonymous?sweetSuccess("内容已匿名"):sweetSuccess("内容已取消匿名")}).catch(function(t){sweetError(t)})},viewAuthorInfo:function(){(n=n||new NKC.modules.UserInfo).open({type:"showUserByPid",pid:this.pid})},collectionThread:function(){var t=this.tid,o=this.collection,i=this;SubscribeTypes.collectionThreadPromise(t,!o).then(function(){i.collection=!o,o?sweetSuccess("已取消收藏"):sweetSuccess("已加入收藏")}).catch(sweetError)},subscribeThread:function(){var t=this.tid,o=this.subscribe;SubscribeTypes.subscribeThread(t,!o)},replyPost:function(){window.quotePost(this.pid)},hidePostContent:function(){var t=this.pid,o=this.hidePost;window.hidePostPanel||(window.hidePostPanel=new NKC.modules.HidePost),window.hidePostPanel.open(function(){sweetSuccess("执行成功")},{pid:t,hide:o})},postTopped:function(){var t=this.pid,o=this.topped,i=this;nkcAPI("/p/"+t+"/topped","POST",{topped:!o}).then(function(){sweetSuccess("操作成功"),i.topped=!o}).catch(function(t){sweetError(t)})},addXSF:function(){var t=this.pid;credit(t,"xsf")},addKCB:function(){var t=this.pid;credit(t,"kcb")},postDigest:function(){var t=this.pid;(this.digest?unDigestPost:digestPost)(t)},postWarning:function(){openPostWarningDom(this.pid)},disablePost:function(){disabledThreadPost(this.pid)},viewViolationRecord:function(){NKC.modules.violationRecord.open({uid:this.postUserId})},complaintPost:function(){"thread"===this.postType?moduleComplaint.open("thread",this.tid):moduleComplaint.open("post",this.pid)},userBlacklist:function(){var t=this.blacklist,o=this.postUserId;t?NKC.methods.removeUserFromBlacklist(o):NKC.methods.addUserToBlacklist(o,"post",this.pid)},displayIpInfo:function(){NKC.methods.getIpInfo(this.ipInfo)},reviewPost:(e=function(){var t=this.pid;reviewPost(t)},s.toString=function(){return e.toString()},s),toCommentControl:function(){var t=this.pid;window.commentControl||(window.commentControl=new NKC.modules.CommentControl),window.commentControl.open(t)}}}),NKC.methods.initPostOption=function(){for(var o=$('[data-type="postOption"]'),t=0;t<o.length;t++)(function(t){var n=o.eq(t);if("true"===n.attr("data-init"))return;n.on("click",function(t){var o=n.offset(),i=(o.left,o.top,n.attr("data-pid")),o=n.attr("data-direction")||"up";PostOption.open({pid:i,direction:o,jqDOM:n}),t.stopPropagation()}),n.attr("data-init","true")})(t)},$(function(){NKC.methods.initPostOption()})},{}]},{},[1]);
