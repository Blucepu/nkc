extends ../../bootstrap_base

block title
  link(href='/experimental/index.css' rel='stylesheet')
  title 操作设置
  style.
    .user-agent{
      max-height: 2rem;
      display: -webkit-box;
      overflow: hidden;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 1;
    }
    .referer{
      max-height: 4rem;
      display: -webkit-box;
      overflow: hidden;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3;
    }
block content

  .container-fluid.max-width
    .row
      include ../nav
      .col-xs-12.col-md-12
        .row
          .col-xs-12.col-md-2
            .form
              .form-group
                label 开始时间
                input.form-control#startTime(req="true" onclick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})" value=`${data.searchMap.sTime||""}`)
              .form-group
                label 结束时间  
                input.form-control#endTime(req="true" onclick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})" value=`${data.searchMap.eTime||""}`)
              .form-group
                label 用户ID
                input.form-control#userId(value=`${data.searchMap.uid||''}`)
              .form-group
                label IP
                input.form-control#ipAdress(value=`${data.searchMap.ip||''}`)
              .form-group
                label 操作ID
                input.form-control#operationId(value=`${data.searchMap.operationId || ""}`)
              .form-group
                button.btn.btn-primary.btn-block(onclick='searchLogs()') 查询
          .col-xs-12.col-md-10
            include ../../publicModules/paging/paging
            .table-responsive
              table.table.table-bordered
                thead
                  tr
                    th 时间
                    th 用户
                    th 操作名（操作ID）
                    th 方法
                    th IP
                    th 来源
                    th 客户端（点击查看详情）
                tbody
                  for log, index in data.result
                    tr
                      th= format("YYYY/MM/DD HH:mm:ss", log.reqTime)
                      th
                        if log.user
                          a(href=`/u/${log.uid}` target="_blank")=log.user.username
                        else
                          |游客
                      th= `${lang("operations", log.operationId)}（${log.operationId}）`
                      th= log.method
                      th
                        a(href=ipUrl(log.ip) target="_blank")=log.ip
                      th
                        .referer
                          a(href=log.referer target="_blank")=log.referer
                      th
                        .user-agent(onclick=`sweetAlert('${log.userAgent}')`)=log.userAgent
            include ../../publicModules/paging/paging_input


block scripts

  script(src='/icheck/icheck.js')
  script(src='/interface_common.js')
  script(src='/experimental/settings/operation.js')
  script(src='/experimental/log/public.js')
  script(src='/laydate/laydate.dev.js')



