extends ../../experimental
block eTitle
  title 积分设置
  +includeCSS(`/experimental/settings/score/score.css`)
block eContent
  .container-fluid.max-width
    #data.hidden=objToStr({scoreSettings: data.scoreSettings})
    .row#app(v-cloak)
      .col-xs-12.col-md-12.m-b-2
        h4 积分列表
        table.table.table-bordered
          tbody
            tr
              th 启用
              th(v-for='a in typeArr')
                .checkbox
                  label
                    input(type='checkbox' :value='true' v-model='a.enabled')
                    .checkbox-span {{a.type}}
            tr
              th 名称
              th(v-for='a in nameArr')
                input.form-control(type='text' v-model.trim='a.name')
            tr
              th 图标
              th(v-for='a in iconArr')
                .score-icon
                  img(:src="a.iconData" v-if='a.iconData')
                  img(:src="getUrl('scoreIcon', a.icon)" v-else)
                button.btn.btn-default.btn-xs(@click='selectIcon(a)') 更换
            tr
              th 单位
              th(v-for='a in unitArr')
                input.form-control(type='text' v-model.trim='a.unit')
            tr
              th 比重
              th(v-for='a, index in weightArr')
                input.form-control(type='text' v-model.number='a.weight' v-if='index === 0' disabled)
                input.form-control(type='text' v-model.number='a.weight' v-else)
            tr
              th 允许充值
              th(v-for='a in m2sArr')
                .checkbox
                  label
                    input(type='checkbox' :value='true' v-model='a.money2score')
            tr
              th 允许提现
              th(v-for='a in s2mArr')
                .checkbox
                  label
                    input(type='checkbox' :value='true' v-model='a.score2money')
            tr
              th 兑出到其他积分
              th(v-for='a in s2oArr')
                .checkbox
                  label
                    input(type='checkbox' :value='true' v-model='a.score2other')
            tr
              th 从其他积分兑入
              th(v-for='a in o2sArr')
                .checkbox
                  label
                    input(type='checkbox' :value='true' v-model='a.other2score')
            tr(v-for='o in scoreSettings.operations')
              th {{o.name}}
              th
                input.form-control(type='text' v-model.number='o.score1')
              th
                input.form-control(type='text' v-model.number='o.score2')
              th
                input.form-control(type='text' v-model.number='o.score3')
              th
                input.form-control(type='text' v-model.number='o.score4')
              th
                input.form-control(type='text' v-model.number='o.score5')
      .col-xs-12.col-md-12.m-b-2
        h4 其他
        .form.form-horizontal
          .form-group
            label.col-sm-2.control-label 交易积分
            .col-sm-3.form-inline
              select.form-control(v-model='scoreSettings.mainScore')
                option(v-for='n in mainScoreSelect' :value='n.type') {{n.name}}
          .form-group
            label.col-sm-2.control-label 附件上传下载
            .col-sm-3.form-inline
              select.form-control(v-model='scoreSettings.attachmentScore')
                option(v-for='n in commonScoreSelect' :value='n.type') {{n.name}}
          .form-group
            label.col-sm-2.control-label 商品买卖
            .col-sm-3.form-inline
              select.form-control(v-model='scoreSettings.shopScore')
                option(v-for='n in commonScoreSelect' :value='n.type') {{n.name}}
          .form-group
            label.col-sm-2.control-label 鼓励转账
            .col-sm-3.form-inline
              select.form-control(v-model='scoreSettings.creditScore')
                option(v-for='n in commonScoreSelect' :value='n.type') {{n.name}}
          .form-group
            label.col-sm-2.control-label 最小鼓励数额
            .col-sm-3.form-inline
              input.form-control(type='text' v-model.number='scoreSettings.creditMin')
          .form-group
            label.col-sm-2.control-label 最大鼓励数额
            .col-sm-3.form-inline
              input.form-control(type='text' v-model.number='scoreSettings.creditMax')
      .col-xs-12.col-md-12.m-b-2
        h4 提现设置
        .form
          .form-horizontal
            .form-group
              label.col-sm-2.control-label 提现
              .col-sm-10
                .radio
                  label.m-r-1
                    input(type='radio' :value="true" v-model='scoreSettings.withdrawEnabled')
                    span 启用
                  label
                    input(type='radio' :value="false" v-model='scoreSettings.withdrawEnabled')
                    span 禁用
            .form-group
              label.col-sm-2.control-label 最小提现金额
              .col-sm-3.form-inline
                input.form-control(type='text' v-model.number='scoreSettings.withdrawMin')
                span &nbsp;元
            .form-group
              label.col-sm-2.control-label 最大提现金额
              .col-sm-3.form-inline
                input.form-control(type='text' v-model.number='scoreSettings.withdrawMin')
                span &nbsp;元
            .form-group
              label.col-sm-2.control-label 每天最大提现次数
              .col-sm-3.form-inline
                input.form-control(type='text' v-model.number='scoreSettings.withdrawCountOneDay')
            .form-group
              label.col-sm-2.control-label 允许提现的时间段
              .col-sm-10.form-inline
                select.form-control(v-model.number="scoreSettings._withdrawTimeBegin.hour")
                  -for (var i = 0; i < 24; i++)
                    option(:value=i)=i
                span 时
                select.form-control(v-model.number="scoreSettings._withdrawTimeBegin.min")
                  -for (var i = 0; i < 60; i++)
                    option(:value=i)=i
                span 分
                select.form-control(v-model.number="scoreSettings._withdrawTimeBegin.sec")
                  -for (var i = 0; i < 60; i++)
                    option(:value=i)=i
                span 秒
                span.m-l-1.m-r-1 至
                select.form-control(v-model.number="scoreSettings._withdrawTimeEnd.hour")
                  -for (var i = 0; i < 24; i++)
                    option(:value=i)=i
                span 时
                select.form-control(v-model.number="scoreSettings._withdrawTimeEnd.min")
                  -for (var i = 0; i < 60; i++)
                    option(:value=i)=i
                span 分
                select.form-control(v-model.number="scoreSettings._withdrawTimeEnd.sec")
                  -for (var i = 0; i < 60; i++)
                    option(:value=i)=i
                span 秒
            .form-group
              label.col-sm-2.control-label 提现手续费
              .col-sm-3.form-inline
                input.form-control(type='text' v-model.number='scoreSettings.withdrawFee')
                span &nbsp;%
                h5 提现1000，实际到账{{1000 - 1000 * scoreSettings.withdrawFee / 100}}
      .col-xs-12.col-md-12.m-b-2
        h4
        .m-t-1
          button.btn.btn-primary(@click='save' v-if='!submitting') 保存
          button.btn.btn-primary(disabled v-else) 保存中...
            .fa.fa-spinner.fa-spin
block scripts
  include ../../../publicModules/crop/crop_new
  +includeJS(`/experimental/settings/score/score.js`)
