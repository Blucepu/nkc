(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

NKC.methods.rn = {};

NKC.methods.rn.postMessage = function (obj) {
  window.ReactNativeWebView.postMessage(JSON.stringify(obj));
};

NKC.methods.rn.emit = function (type, data) {
  data = data || {};
  NKC.methods.rn.postMessage({
    type: type,
    data: data
  });
};

function urlPathEval(fromUrl, toUrl) {
  if (!toUrl) {
    toUrl = fromUrl;
    fromUrl = location.href;
  }

  var fullFromUrl = new URL(fromUrl, location.origin);
  return new URL(toUrl, fullFromUrl).href;
}

document.body.addEventListener('click', function (e) {
  var target = e.target;
  var targetNodeName = target.nodeName.toLowerCase();
  var dataType = target.getAttribute('data-type');
  var src = target.getAttribute('src');
  if (!src) src = target.getAttribute('data-src');

  if (targetNodeName === 'img' && dataType === 'view' && src) {
    src = window.location.origin + src; // 图片处理

    var images = document.querySelectorAll('img[data-type="view"]');
    var urls = [];
    var index;

    for (var i = 0; i < images.length; i++) {
      var image = images[i];
      var name = image.getAttribute('alt');

      var _src = image.getAttribute('src');

      if (!_src) {
        _src = image.getAttribute('data-src');
      }

      if (!_src) return;
      _src = window.location.origin + _src;

      if (_src === src) {
        index = i;
      }

      urls.push({
        url: _src,
        name: (name || '').replace(/[/\\]/g, '-')
      });
    }

    NKC.methods.rn.emit('viewImage', {
      urls: urls,
      index: index
    });
    e.preventDefault();
  } else {
    // 链接处理
    var $a = null;

    if (targetNodeName === 'a') {
      $a = target;
    } else {
      $a = $(target).parents('a');
      if ($a.length) $a = $a[0];
    }

    var href;
    if ($a) href = $a.getAttribute('href');

    if (href && $a.getAttribute('data-type') !== 'reload') {
      e.preventDefault();
      var targetUrl = urlPathEval(location.href, href);
      NKC.methods.rn.emit('openNewPage', {
        href: targetUrl
      });
    }
  }
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9fYnJvd3Nlci1wYWNrQDYuMS4wQGJyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsInBhZ2VzL2FwcEFwaS9yZWFjdE5hdGl2ZS5tanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLEdBQUcsQ0FBQyxPQUFKLENBQVksRUFBWixHQUFpQixFQUFqQjs7QUFFQSxHQUFHLENBQUMsT0FBSixDQUFZLEVBQVosQ0FBZSxXQUFmLEdBQTZCLFVBQVMsR0FBVCxFQUFjO0FBQ3pDLEVBQUEsTUFBTSxDQUFDLGtCQUFQLENBQTBCLFdBQTFCLENBQXNDLElBQUksQ0FBQyxTQUFMLENBQWUsR0FBZixDQUF0QztBQUNELENBRkQ7O0FBSUEsR0FBRyxDQUFDLE9BQUosQ0FBWSxFQUFaLENBQWUsSUFBZixHQUFzQixVQUFTLElBQVQsRUFBZSxJQUFmLEVBQXFCO0FBQ3pDLEVBQUEsSUFBSSxHQUFHLElBQUksSUFBSSxFQUFmO0FBQ0EsRUFBQSxHQUFHLENBQUMsT0FBSixDQUFZLEVBQVosQ0FBZSxXQUFmLENBQTJCO0FBQ3pCLElBQUEsSUFBSSxFQUFFLElBRG1CO0FBRXpCLElBQUEsSUFBSSxFQUFFO0FBRm1CLEdBQTNCO0FBSUQsQ0FORDs7QUFRQSxTQUFTLFdBQVQsQ0FBcUIsT0FBckIsRUFBOEIsS0FBOUIsRUFBcUM7QUFDbkMsTUFBSSxDQUFDLEtBQUwsRUFBWTtBQUNWLElBQUEsS0FBSyxHQUFHLE9BQVI7QUFDQSxJQUFBLE9BQU8sR0FBRyxRQUFRLENBQUMsSUFBbkI7QUFDRDs7QUFDRCxNQUFJLFdBQVcsR0FBRyxJQUFJLEdBQUosQ0FBUSxPQUFSLEVBQWlCLFFBQVEsQ0FBQyxNQUExQixDQUFsQjtBQUNBLFNBQU8sSUFBSSxHQUFKLENBQVEsS0FBUixFQUFlLFdBQWYsRUFBNEIsSUFBbkM7QUFDRDs7QUFFRCxRQUFRLENBQUMsSUFBVCxDQUFjLGdCQUFkLENBQStCLE9BQS9CLEVBQXdDLFVBQUMsQ0FBRCxFQUFRO0FBQzlD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QyxRQUFBLElBQUksRUFBRTtBQUQyQixPQUFuQztBQUdEO0FBQ0Y7QUFDRixDQXJERCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIk5LQy5tZXRob2RzLnJuID0ge307XHJcblxyXG5OS0MubWV0aG9kcy5ybi5wb3N0TWVzc2FnZSA9IGZ1bmN0aW9uKG9iaikge1xyXG4gIHdpbmRvdy5SZWFjdE5hdGl2ZVdlYlZpZXcucG9zdE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7XHJcbn07XHJcblxyXG5OS0MubWV0aG9kcy5ybi5lbWl0ID0gZnVuY3Rpb24odHlwZSwgZGF0YSkge1xyXG4gIGRhdGEgPSBkYXRhIHx8IHt9O1xyXG4gIE5LQy5tZXRob2RzLnJuLnBvc3RNZXNzYWdlKHtcclxuICAgIHR5cGU6IHR5cGUsXHJcbiAgICBkYXRhOiBkYXRhXHJcbiAgfSk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiB1cmxQYXRoRXZhbChmcm9tVXJsLCB0b1VybCkge1xyXG4gIGlmICghdG9VcmwpIHtcclxuICAgIHRvVXJsID0gZnJvbVVybDtcclxuICAgIGZyb21VcmwgPSBsb2NhdGlvbi5ocmVmO1xyXG4gIH1cclxuICBsZXQgZnVsbEZyb21VcmwgPSBuZXcgVVJMKGZyb21VcmwsIGxvY2F0aW9uLm9yaWdpbik7XHJcbiAgcmV0dXJuIG5ldyBVUkwodG9VcmwsIGZ1bGxGcm9tVXJsKS5ocmVmO1xyXG59XHJcblxyXG5kb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpICA9PiB7XHJcbiAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XHJcbiAgY29uc3QgdGFyZ2V0Tm9kZU5hbWUgPSB0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcclxuICBjb25zdCBkYXRhVHlwZSA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdHlwZScpO1xyXG4gIGxldCBzcmMgPSB0YXJnZXQuZ2V0QXR0cmlidXRlKCdzcmMnKTtcclxuICBpZighc3JjKSBzcmMgPSB0YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXNyYycpO1xyXG4gIGlmKHRhcmdldE5vZGVOYW1lID09PSAnaW1nJyAmJiBkYXRhVHlwZSA9PT0gJ3ZpZXcnICYmIHNyYykge1xyXG4gICAgc3JjID0gd2luZG93LmxvY2F0aW9uLm9yaWdpbiArIHNyYztcclxuICAgIC8vIOWbvueJh+WkhOeQhlxyXG4gICAgY29uc3QgaW1hZ2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW1nW2RhdGEtdHlwZT1cInZpZXdcIl0nKTtcclxuICAgIGNvbnN0IHVybHMgPSBbXTtcclxuICAgIGxldCBpbmRleDtcclxuICAgIGZvcihsZXQgaSA9IDA7IGkgPCBpbWFnZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3QgaW1hZ2UgPSBpbWFnZXNbaV07XHJcbiAgICAgIGNvbnN0IG5hbWUgPSBpbWFnZS5nZXRBdHRyaWJ1dGUoJ2FsdCcpO1xyXG4gICAgICBsZXQgX3NyYyA9IGltYWdlLmdldEF0dHJpYnV0ZSgnc3JjJyk7XHJcbiAgICAgIGlmKCFfc3JjKSB7XHJcbiAgICAgICAgX3NyYyA9IGltYWdlLmdldEF0dHJpYnV0ZSgnZGF0YS1zcmMnKTtcclxuICAgICAgfVxyXG4gICAgICBpZighX3NyYykgcmV0dXJuO1xyXG4gICAgICBfc3JjID0gd2luZG93LmxvY2F0aW9uLm9yaWdpbiArIF9zcmM7XHJcbiAgICAgIGlmKF9zcmMgPT09IHNyYykge1xyXG4gICAgICAgIGluZGV4ID0gaTtcclxuICAgICAgfVxyXG4gICAgICB1cmxzLnB1c2goe1xyXG4gICAgICAgIHVybDogX3NyYyxcclxuICAgICAgICBuYW1lOiAobmFtZSB8fCAnJykucmVwbGFjZSgvWy9cXFxcXS9nLCAnLScpXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgTktDLm1ldGhvZHMucm4uZW1pdCgndmlld0ltYWdlJywge1xyXG4gICAgICB1cmxzLFxyXG4gICAgICBpbmRleCxcclxuICAgIH0pO1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyDpk77mjqXlpITnkIZcclxuICAgIGxldCAkYSA9IG51bGw7XHJcbiAgICBpZiAodGFyZ2V0Tm9kZU5hbWUgPT09ICdhJykge1xyXG4gICAgICAkYSA9IHRhcmdldDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICRhID0gJCh0YXJnZXQpLnBhcmVudHMoJ2EnKTtcclxuICAgICAgaWYoJGEubGVuZ3RoKSAkYSA9ICRhWzBdO1xyXG4gICAgfVxyXG4gICAgbGV0IGhyZWY7XHJcbiAgICBpZigkYSkgaHJlZiA9ICRhLmdldEF0dHJpYnV0ZSgnaHJlZicpO1xyXG4gICAgaWYoaHJlZiAmJiAkYS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdHlwZScpICE9PSAncmVsb2FkJykge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNvbnN0IHRhcmdldFVybCA9IHVybFBhdGhFdmFsKGxvY2F0aW9uLmhyZWYsIGhyZWYpO1xyXG4gICAgICBOS0MubWV0aG9kcy5ybi5lbWl0KCdvcGVuTmV3UGFnZScsIHtcclxuICAgICAgICBocmVmOiB0YXJnZXRVcmxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG59KTtcclxuIl19
