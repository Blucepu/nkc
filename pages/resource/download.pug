extends ../bootstrap_base

block title
  title 资源下载

block content
  +includeCSS("/resource/download.css")
  .container-fluid.max-width(style="padding-bottom: 100px")
    .tip-wrap
      .error-list.b-s-10
        - let text = (() => {
        -  let str = "";
        -  for(let score of data.myAllScore) {
        -    if(score.addNumber == 0) continue;
        -    str += score.name;
        -    str += score.addNumber * -1 / 100;
        -    str += score.unit;
        -    str += "、";
        -  }
        -  str = str.substring(0, str.length - 1);
        -  return str;
        - })()
        .error-header= `下载${data.resource.ext === "pdf"? "或预览":""}此资源需要${text}。`
        .error-code= `您今日总下载次数为${data.todyOperationCount}次`

        - let text2 = (() => {
        -  let str = "";
        -  for(let score of data.myAllScore) {
        -    if(score.addNumber == 0) continue;
        -    str += score.name;
        -    str += score.number / 100;
        -    str += score.unit;
        -    str += "、";
        -  }
        -  str = str.substring(0, str.length - 1);
        -  return str;
        - })()
        .error-code
          span= `你当前剩余${text2}。`
          code= data.enough? '确认要支付积分吗?' : '积分不足'
        .error-info
          if data.enough
            a.m-l-0(onclick=`payForDownloadResource(${data.rid})`) 下载
            if data.resource.ext === "pdf"
              | &nbsp;&nbsp;&nbsp;
              a.m-l-0(onclick=`previewPDFResource(${data.rid})`) 预览
          else 
            a.m-l-0(href=`/account/finance/recharge`) 充值
          | &nbsp;&nbsp;&nbsp;
          a(onclick="window.close()") 返回上一页

  +includeJS("/resource/download.js")
    