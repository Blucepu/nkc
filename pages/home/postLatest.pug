if !isIncluded('postActivity')
  +includeCSS('/subscribe/postActivity.css')
  mixin postlatest(props)
    -var {from, user, quote, title, content, toc, cover, url, type, parentPost, parentPostId} = props;
    mixin postActivityHeader(headerData)
      -var {toc, parentPost, showFrom, user} = headerData;
      .post-activity-header(class=headerData.from?'post-activity-main-header':'')
        .post-activity-avatar
          if headerData.user.avatar
            img(src=headerData.user.avatar data-float-uid=headerData.user.uid || undefined style="cursor: pointer")
          else
            div(style=`background-color: ${headerData.user.color}`)
        .post-activity-user
          if headerData.user.uid
            a(
              href=tools.getUrl('userHome', user.uid) target="_blank"
              data-float-uid=headerData.user.uid || undefined
            ).post-activity-username=headerData.user.username
          else
            .post-activity-username=headerData.user.username
          if showFrom
            if !headerData.parentPostId
              span.post-activity-from=`发表回复`
              span &nbsp;
              +fromNow(toc)
            else
              span.post-activity-from=`发表评论`
              span &nbsp;
              +fromNow(toc)

    mixin postActivityContent(contentData)
      -var {cover, title, content, url} = contentData;
      .post-activity-content
        if title
          a(href=url target="_blank").post-activity-title=title
        .post-activity-content-container(class=cover? 'cover':'')
          if content
            a(href=url target="_blank").post-post-abstract=content
          if cover
            .post-activity-cover(style=`background-image: url(${cover})`)
    mixin postPostsContent(contentData, parentPost)
      -var {cover, title, content, url} = contentData;
      .post-activity-content
        .post-activity-content-container
          if parentPost
            div
              a(href=parentPost.url target="_blank").post-post-abstract=parentPost.content
          if title
            div
              a(href=url target="_blank").post-post-title=`《${title}》`
          //if cover
          //  .post-activity-cover(style=`background-image: url(${cover})`)
    .post-activity
      .post-activity-content
        +postActivityHeader({user, toc, parentPost, showFrom: true, parentPostId})
        +postActivityContent({title, content, cover, url})
      if quote
        .post-activity-content.post-activity-quote
          if parentPost
            +postActivityHeader({user: parentPost.user, toc: parentPost.toc, parentPostId})
            +postPostsContent(quote, parentPost)
          else
            //+postActivityHeader({...quote, parentPostId})
            +postPostsContent(quote, '')
