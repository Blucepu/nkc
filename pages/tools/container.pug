extends ../bootstrap_base

block title
  title=data.toolInfo.name

block content
  .container-fluid.max-width.p-l-0.p-r-0
    iframe.col-xs-12.col-md-12.p-l-0.p-r-0#toolContainer(src=`/tools/${data.toolInfo._id}${data.toolInfo.entry}`, frameborder="0",  scrolling="no", style="width: 100%; overflow: hidden; border: none;", onload="initIFrame()")
    style.
      #toolContainer {
        min-height: 1024px;
        min-height: 100vh;
      }

block scripts
  script.
    function initIFrame() {
      var frame = document.getElementById("toolContainer");
      // 调整 iframe 高度
      try {
        var doc = frame.contentDocument || frame.contentWindow.document;
        // 隐藏内部滚动条
        doc.documentElement.style.overflow = 'hidden';
        doc.body.style.overflow = 'hidden';

        var docBody = doc.body;
        frame.style.height = docBody.scrollHeight + 'px';
      } catch (e) {
        console.warn('无法访问 iframe 文档以获取高度或隐藏滚动条', e);
      }

      // 劫持所有链接，在新标签打开
      try {
        var innerDoc = frame.contentDocument || frame.contentWindow.document;
        var links = innerDoc.querySelectorAll('a[href]');
        links.forEach(function(a) {
          a.setAttribute('target', '_blank');
          a.setAttribute('rel', 'noopener noreferrer');
        });
      } catch (e) {
        console.warn('无法访问 iframe 文档以劫持链接（可能跨域）', e);
      }
    }
