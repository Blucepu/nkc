(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

var url = "http://a.test:9000/r/10";
var container, pageDiv, pdfDoc;
var page = 0;
$("button.page").on("click", function () {
  if ($(this).attr("data-type") === "next") {
    page++;
  } else if (page > 1) {
    page--;
  }

  renderPDF(page);
});

function getPDF(url) {
  pdfjsLib.getDocument({
    url: url,
    rangeChunkSize: 65536
  }).then(function (pdf) {
    console.log(pdf);
    pdfDoc = pdf;
    container = document.getElementById('container');
  });
}

function renderPDF(num) {
  console.log(1);
  pdfDoc.getPage(num).then(function (page) {
    console.log(2);
    var scale = 1.5;
    var viewport = page.getViewport(scale);
    pageDiv = document.createElement('div');
    pageDiv.setAttribute('id', 'page-' + (page.pageIndex + 1));
    pageDiv.setAttribute('style', 'position: relative');
    container.appendChild(pageDiv);
    var canvas = document.createElement('canvas');
    pageDiv.appendChild(canvas);
    var context = canvas.getContext('2d');
    canvas.height = viewport.height;
    canvas.width = viewport.width;
    var renderContext = {
      canvasContext: context,
      viewport: viewport
    };
    var pageDiv_ = pageDiv;
    page.render(renderContext).then(function () {
      return page.getTextContent();
    }).then(function (textContent) {
      // 创建文本图层div
      var textLayerDiv = document.createElement('div');
      console.log("-------------------------");
      textLayerDiv.setAttribute('class', 'textLayer'); // 将文本图层div添加至每页pdf的div中

      pageDiv_.appendChild(textLayerDiv);
      console.log(pageDiv_);
      console.log(textLayerDiv); // 创建新的TextLayerBuilder实例

      var textLayer = new TextLayerBuilder({
        textLayerDiv: textLayerDiv,
        pageIndex: page.pageIndex,
        viewport: viewport
      });
      textLayer.setTextContent(textContent);
      textLayer.render();
    });
  });
}

getPDF(url);

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwYWdlcy90ZXN0L3Rlc3QubWpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxJQUFNLEdBQUcsR0FBRyx5QkFBWjtBQUVBLElBQUksU0FBSixFQUFlLE9BQWYsRUFBd0IsTUFBeEI7QUFFQSxJQUFJLElBQUksR0FBRyxDQUFYO0FBRUEsQ0FBQyxDQUFDLGFBQUQsQ0FBRCxDQUFpQixFQUFqQixDQUFvQixPQUFwQixFQUE2QixZQUFXO0FBQ3RDLE1BQUcsQ0FBQyxDQUFDLElBQUQsQ0FBRCxDQUFRLElBQVIsQ0FBYSxXQUFiLE1BQThCLE1BQWpDLEVBQXlDO0FBQ3ZDLElBQUEsSUFBSTtBQUNMLEdBRkQsTUFFTyxJQUFHLElBQUksR0FBRyxDQUFWLEVBQWE7QUFDbEIsSUFBQSxJQUFJO0FBQ0w7O0FBQ0QsRUFBQSxTQUFTLENBQUMsSUFBRCxDQUFUO0FBQ0QsQ0FQRDs7QUFVQSxTQUFTLE1BQVQsQ0FBZ0IsR0FBaEIsRUFBcUI7QUFDbkIsRUFBQSxRQUFRLENBQUMsV0FBVCxDQUFxQjtBQUNuQixJQUFBLEdBQUcsRUFBRSxHQURjO0FBRW5CLElBQUEsY0FBYyxFQUFFO0FBRkcsR0FBckIsRUFHRyxJQUhILENBR1EsVUFBQyxHQUFELEVBQVM7QUFDZixJQUFBLE9BQU8sQ0FBQyxHQUFSLENBQVksR0FBWjtBQUNBLElBQUEsTUFBTSxHQUFHLEdBQVQ7QUFDQSxJQUFBLFNBQVMsR0FBRyxRQUFRLENBQUMsY0FBVCxDQUF3QixXQUF4QixDQUFaO0FBQ0QsR0FQRDtBQVFEOztBQUVELFNBQVMsU0FBVCxDQUFtQixHQUFuQixFQUF3QjtBQUN0QixFQUFBLE9BQU8sQ0FBQyxHQUFSLENBQVksQ0FBWjtBQUNBLEVBQUEsTUFBTSxDQUFDLE9BQVAsQ0FBZSxHQUFmLEVBQW9CLElBQXBCLENBQXlCLFVBQUMsSUFBRCxFQUFVO0FBQ2pDLElBQUEsT0FBTyxDQUFDLEdBQVIsQ0FBWSxDQUFaO0FBQ0EsUUFBSSxLQUFLLEdBQUcsR0FBWjtBQUNBLFFBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxXQUFMLENBQWlCLEtBQWpCLENBQWY7QUFDQSxJQUFBLE9BQU8sR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixLQUF2QixDQUFWO0FBQ0EsSUFBQSxPQUFPLENBQUMsWUFBUixDQUFxQixJQUFyQixFQUEyQixXQUFXLElBQUksQ0FBQyxTQUFMLEdBQWlCLENBQTVCLENBQTNCO0FBQ0EsSUFBQSxPQUFPLENBQUMsWUFBUixDQUFxQixPQUFyQixFQUE4QixvQkFBOUI7QUFDQSxJQUFBLFNBQVMsQ0FBQyxXQUFWLENBQXNCLE9BQXRCO0FBQ0EsUUFBSSxNQUFNLEdBQUcsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsUUFBdkIsQ0FBYjtBQUNBLElBQUEsT0FBTyxDQUFDLFdBQVIsQ0FBb0IsTUFBcEI7QUFDQSxRQUFJLE9BQU8sR0FBRyxNQUFNLENBQUMsVUFBUCxDQUFrQixJQUFsQixDQUFkO0FBQ0EsSUFBQSxNQUFNLENBQUMsTUFBUCxHQUFnQixRQUFRLENBQUMsTUFBekI7QUFDQSxJQUFBLE1BQU0sQ0FBQyxLQUFQLEdBQWUsUUFBUSxDQUFDLEtBQXhCO0FBRUEsUUFBSSxhQUFhLEdBQUc7QUFDbEIsTUFBQSxhQUFhLEVBQUUsT0FERztBQUVsQixNQUFBLFFBQVEsRUFBRTtBQUZRLEtBQXBCO0FBSUEsUUFBSSxRQUFRLEdBQUcsT0FBZjtBQUNBLElBQUEsSUFBSSxDQUFDLE1BQUwsQ0FBWSxhQUFaLEVBQTJCLElBQTNCLENBQWdDLFlBQU07QUFDcEMsYUFBTyxJQUFJLENBQUMsY0FBTCxFQUFQO0FBQ0QsS0FGRCxFQUVHLElBRkgsQ0FFUSxVQUFDLFdBQUQsRUFBaUI7QUFDdkI7QUFDQSxVQUFNLFlBQVksR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixLQUF2QixDQUFyQjtBQUNBLE1BQUEsT0FBTyxDQUFDLEdBQVI7QUFDQSxNQUFBLFlBQVksQ0FBQyxZQUFiLENBQTBCLE9BQTFCLEVBQW1DLFdBQW5DLEVBSnVCLENBS3ZCOztBQUNBLE1BQUEsUUFBUSxDQUFDLFdBQVQsQ0FBcUIsWUFBckI7QUFDQSxNQUFBLE9BQU8sQ0FBQyxHQUFSLENBQVksUUFBWjtBQUNBLE1BQUEsT0FBTyxDQUFDLEdBQVIsQ0FBWSxZQUFaLEVBUnVCLENBVXZCOztBQUNBLFVBQUksU0FBUyxHQUFHLElBQUksZ0JBQUosQ0FBcUI7QUFDbkMsUUFBQSxZQUFZLEVBQUUsWUFEcUI7QUFFbkMsUUFBQSxTQUFTLEVBQUUsSUFBSSxDQUFDLFNBRm1CO0FBR25DLFFBQUEsUUFBUSxFQUFFO0FBSHlCLE9BQXJCLENBQWhCO0FBTUEsTUFBQSxTQUFTLENBQUMsY0FBVixDQUF5QixXQUF6QjtBQUVBLE1BQUEsU0FBUyxDQUFDLE1BQVY7QUFDRCxLQXRCRDtBQXVCRCxHQTFDRDtBQTJDRDs7QUFJRCxNQUFNLENBQUMsR0FBRCxDQUFOIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiY29uc3QgdXJsID0gXCJodHRwOi8vYS50ZXN0OjkwMDAvci8xMFwiO1xyXG5cclxudmFyIGNvbnRhaW5lciwgcGFnZURpdiwgcGRmRG9jO1xyXG5cclxudmFyIHBhZ2UgPSAwO1xyXG5cclxuJChcImJ1dHRvbi5wYWdlXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgaWYoJCh0aGlzKS5hdHRyKFwiZGF0YS10eXBlXCIpID09PSBcIm5leHRcIikge1xyXG4gICAgcGFnZSArKztcclxuICB9IGVsc2UgaWYocGFnZSA+IDEpIHtcclxuICAgIHBhZ2UgLS07XHJcbiAgfVxyXG4gIHJlbmRlclBERihwYWdlKTtcclxufSk7XHJcblxyXG5cclxuZnVuY3Rpb24gZ2V0UERGKHVybCkge1xyXG4gIHBkZmpzTGliLmdldERvY3VtZW50KHtcclxuICAgIHVybDogdXJsLFxyXG4gICAgcmFuZ2VDaHVua1NpemU6IDY1NTM2LFxyXG4gIH0pLnRoZW4oKHBkZikgPT4ge1xyXG4gICAgY29uc29sZS5sb2cocGRmKTtcclxuICAgIHBkZkRvYyA9IHBkZjtcclxuICAgIGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250YWluZXInKTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyUERGKG51bSkge1xyXG4gIGNvbnNvbGUubG9nKDEpXHJcbiAgcGRmRG9jLmdldFBhZ2UobnVtKS50aGVuKChwYWdlKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZygyKVxyXG4gICAgdmFyIHNjYWxlID0gMS41O1xyXG4gICAgdmFyIHZpZXdwb3J0ID0gcGFnZS5nZXRWaWV3cG9ydChzY2FsZSk7XHJcbiAgICBwYWdlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBwYWdlRGl2LnNldEF0dHJpYnV0ZSgnaWQnLCAncGFnZS0nICsgKHBhZ2UucGFnZUluZGV4ICsgMSkpO1xyXG4gICAgcGFnZURpdi5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ3Bvc2l0aW9uOiByZWxhdGl2ZScpO1xyXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHBhZ2VEaXYpO1xyXG4gICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgcGFnZURpdi5hcHBlbmRDaGlsZChjYW52YXMpO1xyXG4gICAgdmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgIGNhbnZhcy5oZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQ7XHJcbiAgICBjYW52YXMud2lkdGggPSB2aWV3cG9ydC53aWR0aDtcclxuICAgIFxyXG4gICAgdmFyIHJlbmRlckNvbnRleHQgPSB7XHJcbiAgICAgIGNhbnZhc0NvbnRleHQ6IGNvbnRleHQsXHJcbiAgICAgIHZpZXdwb3J0OiB2aWV3cG9ydFxyXG4gICAgfTtcclxuICAgIHZhciBwYWdlRGl2XyA9IHBhZ2VEaXY7XHJcbiAgICBwYWdlLnJlbmRlcihyZW5kZXJDb250ZXh0KS50aGVuKCgpID0+IHtcclxuICAgICAgcmV0dXJuIHBhZ2UuZ2V0VGV4dENvbnRlbnQoKTtcclxuICAgIH0pLnRoZW4oKHRleHRDb250ZW50KSA9PiB7XHJcbiAgICAgIC8vIOWIm+W7uuaWh+acrOWbvuWxgmRpdlxyXG4gICAgICBjb25zdCB0ZXh0TGF5ZXJEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgY29uc29sZS5sb2coYC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1gKVxyXG4gICAgICB0ZXh0TGF5ZXJEaXYuc2V0QXR0cmlidXRlKCdjbGFzcycsICd0ZXh0TGF5ZXInKTtcclxuICAgICAgLy8g5bCG5paH5pys5Zu+5bGCZGl25re75Yqg6Iez5q+P6aG1cGRm55qEZGl25LitXHJcbiAgICAgIHBhZ2VEaXZfLmFwcGVuZENoaWxkKHRleHRMYXllckRpdik7XHJcbiAgICAgIGNvbnNvbGUubG9nKHBhZ2VEaXZfKTtcclxuICAgICAgY29uc29sZS5sb2codGV4dExheWVyRGl2KTtcclxuICAgIFxyXG4gICAgICAvLyDliJvlu7rmlrDnmoRUZXh0TGF5ZXJCdWlsZGVy5a6e5L6LXHJcbiAgICAgIHZhciB0ZXh0TGF5ZXIgPSBuZXcgVGV4dExheWVyQnVpbGRlcih7XHJcbiAgICAgICAgdGV4dExheWVyRGl2OiB0ZXh0TGF5ZXJEaXYsXHJcbiAgICAgICAgcGFnZUluZGV4OiBwYWdlLnBhZ2VJbmRleCxcclxuICAgICAgICB2aWV3cG9ydDogdmlld3BvcnRcclxuICAgICAgfSk7XHJcbiAgICBcclxuICAgICAgdGV4dExheWVyLnNldFRleHRDb250ZW50KHRleHRDb250ZW50KTtcclxuICAgIFxyXG4gICAgICB0ZXh0TGF5ZXIucmVuZGVyKCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuXHJcblxyXG5nZXRQREYodXJsKTsiXX0=
