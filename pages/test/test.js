(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

var url = "http://a.test:9000/r/22";
var container, pageDiv, pdfDoc;
var page = 0;
$("button.page").on("click", function () {
  if ($(this).attr("data-type") === "next") {
    page++;
  } else if (page > 1) {
    page--;
  }

  renderPDF(page);
});

function getPDF(url) {
  pdfjsLib.getDocument({
    url: url,
    rangeChunkSize: 65536 * 20,
    disableAutoFetch: true,
    disableStream: true
  }).then(function (pdf) {
    console.log(pdf);
    pdfDoc = pdf;
    container = document.getElementById('container');
  });
}

function renderPDF(num) {
  console.log(1);
  pdfDoc.getPage(num).then(function (page) {
    console.log(2);
    var scale = 1.5;
    var viewport = page.getViewport(scale);
    pageDiv = document.createElement('div');
    pageDiv.setAttribute('id', 'page-' + (page.pageIndex + 1));
    pageDiv.setAttribute('style', 'position: relative');
    container.appendChild(pageDiv);
    var canvas = document.createElement('canvas');
    pageDiv.appendChild(canvas);
    var context = canvas.getContext('2d');
    canvas.height = viewport.height;
    canvas.width = viewport.width;
    var renderContext = {
      canvasContext: context,
      viewport: viewport
    };
    var pageDiv_ = pageDiv;
    page.render(renderContext).then(function () {
      return page.getTextContent();
    }).then(function (textContent) {
      // 创建文本图层div
      var textLayerDiv = document.createElement('div');
      console.log("-------------------------");
      textLayerDiv.setAttribute('class', 'textLayer'); // 将文本图层div添加至每页pdf的div中

      pageDiv_.appendChild(textLayerDiv);
      console.log(pageDiv_);
      console.log(textLayerDiv); // 创建新的TextLayerBuilder实例

      var textLayer = new TextLayerBuilder({
        textLayerDiv: textLayerDiv,
        pageIndex: page.pageIndex,
        viewport: viewport
      });
      textLayer.setTextContent(textContent);
      textLayer.render();
    });
  });
}

getPDF(url);

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwYWdlcy90ZXN0L3Rlc3QubWpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxJQUFNLEdBQUcsR0FBRyx5QkFBWjtBQUVBLElBQUksU0FBSixFQUFlLE9BQWYsRUFBd0IsTUFBeEI7QUFFQSxJQUFJLElBQUksR0FBRyxDQUFYO0FBRUEsQ0FBQyxDQUFDLGFBQUQsQ0FBRCxDQUFpQixFQUFqQixDQUFvQixPQUFwQixFQUE2QixZQUFXO0FBQ3RDLE1BQUcsQ0FBQyxDQUFDLElBQUQsQ0FBRCxDQUFRLElBQVIsQ0FBYSxXQUFiLE1BQThCLE1BQWpDLEVBQXlDO0FBQ3ZDLElBQUEsSUFBSTtBQUNMLEdBRkQsTUFFTyxJQUFHLElBQUksR0FBRyxDQUFWLEVBQWE7QUFDbEIsSUFBQSxJQUFJO0FBQ0w7O0FBQ0QsRUFBQSxTQUFTLENBQUMsSUFBRCxDQUFUO0FBQ0QsQ0FQRDs7QUFVQSxTQUFTLE1BQVQsQ0FBZ0IsR0FBaEIsRUFBcUI7QUFDbkIsRUFBQSxRQUFRLENBQUMsV0FBVCxDQUFxQjtBQUNuQixJQUFBLEdBQUcsRUFBRSxHQURjO0FBRW5CLElBQUEsY0FBYyxFQUFFLFFBQU0sRUFGSDtBQUduQixJQUFBLGdCQUFnQixFQUFFLElBSEM7QUFJbkIsSUFBQSxhQUFhLEVBQUM7QUFKSyxHQUFyQixFQUtHLElBTEgsQ0FLUSxVQUFDLEdBQUQsRUFBUztBQUNmLElBQUEsT0FBTyxDQUFDLEdBQVIsQ0FBWSxHQUFaO0FBQ0EsSUFBQSxNQUFNLEdBQUcsR0FBVDtBQUNBLElBQUEsU0FBUyxHQUFHLFFBQVEsQ0FBQyxjQUFULENBQXdCLFdBQXhCLENBQVo7QUFDRCxHQVREO0FBVUQ7O0FBRUQsU0FBUyxTQUFULENBQW1CLEdBQW5CLEVBQXdCO0FBQ3RCLEVBQUEsT0FBTyxDQUFDLEdBQVIsQ0FBWSxDQUFaO0FBQ0EsRUFBQSxNQUFNLENBQUMsT0FBUCxDQUFlLEdBQWYsRUFBb0IsSUFBcEIsQ0FBeUIsVUFBQyxJQUFELEVBQVU7QUFDakMsSUFBQSxPQUFPLENBQUMsR0FBUixDQUFZLENBQVo7QUFDQSxRQUFJLEtBQUssR0FBRyxHQUFaO0FBQ0EsUUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDLFdBQUwsQ0FBaUIsS0FBakIsQ0FBZjtBQUNBLElBQUEsT0FBTyxHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLEtBQXZCLENBQVY7QUFDQSxJQUFBLE9BQU8sQ0FBQyxZQUFSLENBQXFCLElBQXJCLEVBQTJCLFdBQVcsSUFBSSxDQUFDLFNBQUwsR0FBaUIsQ0FBNUIsQ0FBM0I7QUFDQSxJQUFBLE9BQU8sQ0FBQyxZQUFSLENBQXFCLE9BQXJCLEVBQThCLG9CQUE5QjtBQUNBLElBQUEsU0FBUyxDQUFDLFdBQVYsQ0FBc0IsT0FBdEI7QUFDQSxRQUFJLE1BQU0sR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixRQUF2QixDQUFiO0FBQ0EsSUFBQSxPQUFPLENBQUMsV0FBUixDQUFvQixNQUFwQjtBQUNBLFFBQUksT0FBTyxHQUFHLE1BQU0sQ0FBQyxVQUFQLENBQWtCLElBQWxCLENBQWQ7QUFDQSxJQUFBLE1BQU0sQ0FBQyxNQUFQLEdBQWdCLFFBQVEsQ0FBQyxNQUF6QjtBQUNBLElBQUEsTUFBTSxDQUFDLEtBQVAsR0FBZSxRQUFRLENBQUMsS0FBeEI7QUFFQSxRQUFJLGFBQWEsR0FBRztBQUNsQixNQUFBLGFBQWEsRUFBRSxPQURHO0FBRWxCLE1BQUEsUUFBUSxFQUFFO0FBRlEsS0FBcEI7QUFJQSxRQUFJLFFBQVEsR0FBRyxPQUFmO0FBQ0EsSUFBQSxJQUFJLENBQUMsTUFBTCxDQUFZLGFBQVosRUFBMkIsSUFBM0IsQ0FBZ0MsWUFBTTtBQUNwQyxhQUFPLElBQUksQ0FBQyxjQUFMLEVBQVA7QUFDRCxLQUZELEVBRUcsSUFGSCxDQUVRLFVBQUMsV0FBRCxFQUFpQjtBQUN2QjtBQUNBLFVBQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLEtBQXZCLENBQXJCO0FBQ0EsTUFBQSxPQUFPLENBQUMsR0FBUjtBQUNBLE1BQUEsWUFBWSxDQUFDLFlBQWIsQ0FBMEIsT0FBMUIsRUFBbUMsV0FBbkMsRUFKdUIsQ0FLdkI7O0FBQ0EsTUFBQSxRQUFRLENBQUMsV0FBVCxDQUFxQixZQUFyQjtBQUNBLE1BQUEsT0FBTyxDQUFDLEdBQVIsQ0FBWSxRQUFaO0FBQ0EsTUFBQSxPQUFPLENBQUMsR0FBUixDQUFZLFlBQVosRUFSdUIsQ0FVdkI7O0FBQ0EsVUFBSSxTQUFTLEdBQUcsSUFBSSxnQkFBSixDQUFxQjtBQUNuQyxRQUFBLFlBQVksRUFBRSxZQURxQjtBQUVuQyxRQUFBLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FGbUI7QUFHbkMsUUFBQSxRQUFRLEVBQUU7QUFIeUIsT0FBckIsQ0FBaEI7QUFNQSxNQUFBLFNBQVMsQ0FBQyxjQUFWLENBQXlCLFdBQXpCO0FBRUEsTUFBQSxTQUFTLENBQUMsTUFBVjtBQUNELEtBdEJEO0FBdUJELEdBMUNEO0FBMkNEOztBQUlELE1BQU0sQ0FBQyxHQUFELENBQU4iLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJjb25zdCB1cmwgPSBcImh0dHA6Ly9hLnRlc3Q6OTAwMC9yLzIyXCI7XHJcblxyXG52YXIgY29udGFpbmVyLCBwYWdlRGl2LCBwZGZEb2M7XHJcblxyXG52YXIgcGFnZSA9IDA7XHJcblxyXG4kKFwiYnV0dG9uLnBhZ2VcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICBpZigkKHRoaXMpLmF0dHIoXCJkYXRhLXR5cGVcIikgPT09IFwibmV4dFwiKSB7XHJcbiAgICBwYWdlICsrO1xyXG4gIH0gZWxzZSBpZihwYWdlID4gMSkge1xyXG4gICAgcGFnZSAtLTtcclxuICB9XHJcbiAgcmVuZGVyUERGKHBhZ2UpO1xyXG59KTtcclxuXHJcblxyXG5mdW5jdGlvbiBnZXRQREYodXJsKSB7XHJcbiAgcGRmanNMaWIuZ2V0RG9jdW1lbnQoe1xyXG4gICAgdXJsOiB1cmwsXHJcbiAgICByYW5nZUNodW5rU2l6ZTogNjU1MzYqMjAsXHJcbiAgICBkaXNhYmxlQXV0b0ZldGNoOiB0cnVlLFxyXG4gICAgZGlzYWJsZVN0cmVhbTp0cnVlXHJcbiAgfSkudGhlbigocGRmKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhwZGYpO1xyXG4gICAgcGRmRG9jID0gcGRmO1xyXG4gICAgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhaW5lcicpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJQREYobnVtKSB7XHJcbiAgY29uc29sZS5sb2coMSlcclxuICBwZGZEb2MuZ2V0UGFnZShudW0pLnRoZW4oKHBhZ2UpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKDIpXHJcbiAgICB2YXIgc2NhbGUgPSAxLjU7XHJcbiAgICB2YXIgdmlld3BvcnQgPSBwYWdlLmdldFZpZXdwb3J0KHNjYWxlKTtcclxuICAgIHBhZ2VEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHBhZ2VEaXYuc2V0QXR0cmlidXRlKCdpZCcsICdwYWdlLScgKyAocGFnZS5wYWdlSW5kZXggKyAxKSk7XHJcbiAgICBwYWdlRGl2LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAncG9zaXRpb246IHJlbGF0aXZlJyk7XHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocGFnZURpdik7XHJcbiAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICBwYWdlRGl2LmFwcGVuZENoaWxkKGNhbnZhcyk7XHJcbiAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgY2FudmFzLmhlaWdodCA9IHZpZXdwb3J0LmhlaWdodDtcclxuICAgIGNhbnZhcy53aWR0aCA9IHZpZXdwb3J0LndpZHRoO1xyXG4gICAgXHJcbiAgICB2YXIgcmVuZGVyQ29udGV4dCA9IHtcclxuICAgICAgY2FudmFzQ29udGV4dDogY29udGV4dCxcclxuICAgICAgdmlld3BvcnQ6IHZpZXdwb3J0XHJcbiAgICB9O1xyXG4gICAgdmFyIHBhZ2VEaXZfID0gcGFnZURpdjtcclxuICAgIHBhZ2UucmVuZGVyKHJlbmRlckNvbnRleHQpLnRoZW4oKCkgPT4ge1xyXG4gICAgICByZXR1cm4gcGFnZS5nZXRUZXh0Q29udGVudCgpO1xyXG4gICAgfSkudGhlbigodGV4dENvbnRlbnQpID0+IHtcclxuICAgICAgLy8g5Yib5bu65paH5pys5Zu+5bGCZGl2XHJcbiAgICAgIGNvbnN0IHRleHRMYXllckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICBjb25zb2xlLmxvZyhgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLWApXHJcbiAgICAgIHRleHRMYXllckRpdi5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3RleHRMYXllcicpO1xyXG4gICAgICAvLyDlsIbmlofmnKzlm77lsYJkaXbmt7vliqDoh7Pmr4/pobVwZGbnmoRkaXbkuK1cclxuICAgICAgcGFnZURpdl8uYXBwZW5kQ2hpbGQodGV4dExheWVyRGl2KTtcclxuICAgICAgY29uc29sZS5sb2cocGFnZURpdl8pO1xyXG4gICAgICBjb25zb2xlLmxvZyh0ZXh0TGF5ZXJEaXYpO1xyXG4gICAgXHJcbiAgICAgIC8vIOWIm+W7uuaWsOeahFRleHRMYXllckJ1aWxkZXLlrp7kvotcclxuICAgICAgdmFyIHRleHRMYXllciA9IG5ldyBUZXh0TGF5ZXJCdWlsZGVyKHtcclxuICAgICAgICB0ZXh0TGF5ZXJEaXY6IHRleHRMYXllckRpdixcclxuICAgICAgICBwYWdlSW5kZXg6IHBhZ2UucGFnZUluZGV4LFxyXG4gICAgICAgIHZpZXdwb3J0OiB2aWV3cG9ydFxyXG4gICAgICB9KTtcclxuICAgIFxyXG4gICAgICB0ZXh0TGF5ZXIuc2V0VGV4dENvbnRlbnQodGV4dENvbnRlbnQpO1xyXG4gICAgXHJcbiAgICAgIHRleHRMYXllci5yZW5kZXIoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcblxyXG5cclxuXHJcbmdldFBERih1cmwpOyJdfQ==
