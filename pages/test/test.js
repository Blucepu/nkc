(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

var url = "http://a.test:9000/r/22";
var container, pageDiv, pdfDoc;
var page = 0;
$("button.page").on("click", function () {
  if ($(this).attr("data-type") === "next") {
    page++;
  } else if (page > 1) {
    page--;
  }

  renderPDF(page);
});

function getPDF(url) {
  pdfjsLib.getDocument({
    url: url,
    rangeChunkSize: 65536 * 20,
    disableAutoFetch: true,
    disableStream: true
  }).then(function (pdf) {
    console.log(pdf);
    pdfDoc = pdf;
    container = document.getElementById('container');
  });
}

function renderPDF(num) {
  console.log(1);
  pdfDoc.getPage(num).then(function (page) {
    console.log(2);
    var scale = 1.5;
    var viewport = page.getViewport(scale);
    pageDiv = document.createElement('div');
    pageDiv.setAttribute('id', 'page-' + (page.pageIndex + 1));
    pageDiv.setAttribute('style', 'position: relative');
    container.appendChild(pageDiv);
    var canvas = document.createElement('canvas');
    pageDiv.appendChild(canvas);
    var context = canvas.getContext('2d');
    canvas.height = viewport.height;
    canvas.width = viewport.width;
    var renderContext = {
      canvasContext: context,
      viewport: viewport
    };
    var pageDiv_ = pageDiv;
    page.render(renderContext).then(function () {
      return page.getTextContent();
    }).then(function (textContent) {
      // 创建文本图层div
      var textLayerDiv = document.createElement('div');
      console.log("-------------------------");
      textLayerDiv.setAttribute('class', 'textLayer'); // 将文本图层div添加至每页pdf的div中

      pageDiv_.appendChild(textLayerDiv);
      console.log(pageDiv_);
      console.log(textLayerDiv); // 创建新的TextLayerBuilder实例

      var textLayer = new TextLayerBuilder({
        textLayerDiv: textLayerDiv,
        pageIndex: page.pageIndex,
        viewport: viewport
      });
      textLayer.setTextContent(textContent);
      textLayer.render();
    });
  });
}

getPDF(url);

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9fYnJvd3Nlci1wYWNrQDYuMS4wQGJyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsInBhZ2VzL3Rlc3QvdGVzdC5tanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLElBQU0sR0FBRyxHQUFHLHlCQUFaO0FBRUEsSUFBSSxTQUFKLEVBQWUsT0FBZixFQUF3QixNQUF4QjtBQUVBLElBQUksSUFBSSxHQUFHLENBQVg7QUFFQSxDQUFDLENBQUMsYUFBRCxDQUFELENBQWlCLEVBQWpCLENBQW9CLE9BQXBCLEVBQTZCLFlBQVc7QUFDdEMsTUFBRyxDQUFDLENBQUMsSUFBRCxDQUFELENBQVEsSUFBUixDQUFhLFdBQWIsTUFBOEIsTUFBakMsRUFBeUM7QUFDdkMsSUFBQSxJQUFJO0FBQ0wsR0FGRCxNQUVPLElBQUcsSUFBSSxHQUFHLENBQVYsRUFBYTtBQUNsQixJQUFBLElBQUk7QUFDTDs7QUFDRCxFQUFBLFNBQVMsQ0FBQyxJQUFELENBQVQ7QUFDRCxDQVBEOztBQVVBLFNBQVMsTUFBVCxDQUFnQixHQUFoQixFQUFxQjtBQUNuQixFQUFBLFFBQVEsQ0FBQyxXQUFULENBQXFCO0FBQ25CLElBQUEsR0FBRyxFQUFFLEdBRGM7QUFFbkIsSUFBQSxjQUFjLEVBQUUsUUFBTSxFQUZIO0FBR25CLElBQUEsZ0JBQWdCLEVBQUUsSUFIQztBQUluQixJQUFBLGFBQWEsRUFBQztBQUpLLEdBQXJCLEVBS0csSUFMSCxDQUtRLFVBQUMsR0FBRCxFQUFTO0FBQ2YsSUFBQSxPQUFPLENBQUMsR0FBUixDQUFZLEdBQVo7QUFDQSxJQUFBLE1BQU0sR0FBRyxHQUFUO0FBQ0EsSUFBQSxTQUFTLEdBQUcsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsV0FBeEIsQ0FBWjtBQUNELEdBVEQ7QUFVRDs7QUFFRCxTQUFTLFNBQVQsQ0FBbUIsR0FBbkIsRUFBd0I7QUFDdEIsRUFBQSxPQUFPLENBQUMsR0FBUixDQUFZLENBQVo7QUFDQSxFQUFBLE1BQU0sQ0FBQyxPQUFQLENBQWUsR0FBZixFQUFvQixJQUFwQixDQUF5QixVQUFDLElBQUQsRUFBVTtBQUNqQyxJQUFBLE9BQU8sQ0FBQyxHQUFSLENBQVksQ0FBWjtBQUNBLFFBQUksS0FBSyxHQUFHLEdBQVo7QUFDQSxRQUFJLFFBQVEsR0FBRyxJQUFJLENBQUMsV0FBTCxDQUFpQixLQUFqQixDQUFmO0FBQ0EsSUFBQSxPQUFPLEdBQUcsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsS0FBdkIsQ0FBVjtBQUNBLElBQUEsT0FBTyxDQUFDLFlBQVIsQ0FBcUIsSUFBckIsRUFBMkIsV0FBVyxJQUFJLENBQUMsU0FBTCxHQUFpQixDQUE1QixDQUEzQjtBQUNBLElBQUEsT0FBTyxDQUFDLFlBQVIsQ0FBcUIsT0FBckIsRUFBOEIsb0JBQTlCO0FBQ0EsSUFBQSxTQUFTLENBQUMsV0FBVixDQUFzQixPQUF0QjtBQUNBLFFBQUksTUFBTSxHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLFFBQXZCLENBQWI7QUFDQSxJQUFBLE9BQU8sQ0FBQyxXQUFSLENBQW9CLE1BQXBCO0FBQ0EsUUFBSSxPQUFPLEdBQUcsTUFBTSxDQUFDLFVBQVAsQ0FBa0IsSUFBbEIsQ0FBZDtBQUNBLElBQUEsTUFBTSxDQUFDLE1BQVAsR0FBZ0IsUUFBUSxDQUFDLE1BQXpCO0FBQ0EsSUFBQSxNQUFNLENBQUMsS0FBUCxHQUFlLFFBQVEsQ0FBQyxLQUF4QjtBQUVBLFFBQUksYUFBYSxHQUFHO0FBQ2xCLE1BQUEsYUFBYSxFQUFFLE9BREc7QUFFbEIsTUFBQSxRQUFRLEVBQUU7QUFGUSxLQUFwQjtBQUlBLFFBQUksUUFBUSxHQUFHLE9BQWY7QUFDQSxJQUFBLElBQUksQ0FBQyxNQUFMLENBQVksYUFBWixFQUEyQixJQUEzQixDQUFnQyxZQUFNO0FBQ3BDLGFBQU8sSUFBSSxDQUFDLGNBQUwsRUFBUDtBQUNELEtBRkQsRUFFRyxJQUZILENBRVEsVUFBQyxXQUFELEVBQWlCO0FBQ3ZCO0FBQ0EsVUFBTSxZQUFZLEdBQUcsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsS0FBdkIsQ0FBckI7QUFDQSxNQUFBLE9BQU8sQ0FBQyxHQUFSO0FBQ0EsTUFBQSxZQUFZLENBQUMsWUFBYixDQUEwQixPQUExQixFQUFtQyxXQUFuQyxFQUp1QixDQUt2Qjs7QUFDQSxNQUFBLFFBQVEsQ0FBQyxXQUFULENBQXFCLFlBQXJCO0FBQ0EsTUFBQSxPQUFPLENBQUMsR0FBUixDQUFZLFFBQVo7QUFDQSxNQUFBLE9BQU8sQ0FBQyxHQUFSLENBQVksWUFBWixFQVJ1QixDQVV2Qjs7QUFDQSxVQUFJLFNBQVMsR0FBRyxJQUFJLGdCQUFKLENBQXFCO0FBQ25DLFFBQUEsWUFBWSxFQUFFLFlBRHFCO0FBRW5DLFFBQUEsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUZtQjtBQUduQyxRQUFBLFFBQVEsRUFBRTtBQUh5QixPQUFyQixDQUFoQjtBQU1BLE1BQUEsU0FBUyxDQUFDLGNBQVYsQ0FBeUIsV0FBekI7QUFFQSxNQUFBLFNBQVMsQ0FBQyxNQUFWO0FBQ0QsS0F0QkQ7QUF1QkQsR0ExQ0Q7QUEyQ0Q7O0FBSUQsTUFBTSxDQUFDLEdBQUQsQ0FBTiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImNvbnN0IHVybCA9IFwiaHR0cDovL2EudGVzdDo5MDAwL3IvMjJcIjtcclxuXHJcbnZhciBjb250YWluZXIsIHBhZ2VEaXYsIHBkZkRvYztcclxuXHJcbnZhciBwYWdlID0gMDtcclxuXHJcbiQoXCJidXR0b24ucGFnZVwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gIGlmKCQodGhpcykuYXR0cihcImRhdGEtdHlwZVwiKSA9PT0gXCJuZXh0XCIpIHtcclxuICAgIHBhZ2UgKys7XHJcbiAgfSBlbHNlIGlmKHBhZ2UgPiAxKSB7XHJcbiAgICBwYWdlIC0tO1xyXG4gIH1cclxuICByZW5kZXJQREYocGFnZSk7XHJcbn0pO1xyXG5cclxuXHJcbmZ1bmN0aW9uIGdldFBERih1cmwpIHtcclxuICBwZGZqc0xpYi5nZXREb2N1bWVudCh7XHJcbiAgICB1cmw6IHVybCxcclxuICAgIHJhbmdlQ2h1bmtTaXplOiA2NTUzNioyMCxcclxuICAgIGRpc2FibGVBdXRvRmV0Y2g6IHRydWUsXHJcbiAgICBkaXNhYmxlU3RyZWFtOnRydWVcclxuICB9KS50aGVuKChwZGYpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKHBkZik7XHJcbiAgICBwZGZEb2MgPSBwZGY7XHJcbiAgICBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlclBERihudW0pIHtcclxuICBjb25zb2xlLmxvZygxKVxyXG4gIHBkZkRvYy5nZXRQYWdlKG51bSkudGhlbigocGFnZSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coMilcclxuICAgIHZhciBzY2FsZSA9IDEuNTtcclxuICAgIHZhciB2aWV3cG9ydCA9IHBhZ2UuZ2V0Vmlld3BvcnQoc2NhbGUpO1xyXG4gICAgcGFnZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgcGFnZURpdi5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3BhZ2UtJyArIChwYWdlLnBhZ2VJbmRleCArIDEpKTtcclxuICAgIHBhZ2VEaXYuc2V0QXR0cmlidXRlKCdzdHlsZScsICdwb3NpdGlvbjogcmVsYXRpdmUnKTtcclxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChwYWdlRGl2KTtcclxuICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgIHBhZ2VEaXYuYXBwZW5kQ2hpbGQoY2FudmFzKTtcclxuICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICBjYW52YXMuaGVpZ2h0ID0gdmlld3BvcnQuaGVpZ2h0O1xyXG4gICAgY2FudmFzLndpZHRoID0gdmlld3BvcnQud2lkdGg7XHJcbiAgICBcclxuICAgIHZhciByZW5kZXJDb250ZXh0ID0ge1xyXG4gICAgICBjYW52YXNDb250ZXh0OiBjb250ZXh0LFxyXG4gICAgICB2aWV3cG9ydDogdmlld3BvcnRcclxuICAgIH07XHJcbiAgICB2YXIgcGFnZURpdl8gPSBwYWdlRGl2O1xyXG4gICAgcGFnZS5yZW5kZXIocmVuZGVyQ29udGV4dCkudGhlbigoKSA9PiB7XHJcbiAgICAgIHJldHVybiBwYWdlLmdldFRleHRDb250ZW50KCk7XHJcbiAgICB9KS50aGVuKCh0ZXh0Q29udGVudCkgPT4ge1xyXG4gICAgICAvLyDliJvlu7rmlofmnKzlm77lsYJkaXZcclxuICAgICAgY29uc3QgdGV4dExheWVyRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tYClcclxuICAgICAgdGV4dExheWVyRGl2LnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAndGV4dExheWVyJyk7XHJcbiAgICAgIC8vIOWwhuaWh+acrOWbvuWxgmRpdua3u+WKoOiHs+avj+mhtXBkZueahGRpduS4rVxyXG4gICAgICBwYWdlRGl2Xy5hcHBlbmRDaGlsZCh0ZXh0TGF5ZXJEaXYpO1xyXG4gICAgICBjb25zb2xlLmxvZyhwYWdlRGl2Xyk7XHJcbiAgICAgIGNvbnNvbGUubG9nKHRleHRMYXllckRpdik7XHJcbiAgICBcclxuICAgICAgLy8g5Yib5bu65paw55qEVGV4dExheWVyQnVpbGRlcuWunuS+i1xyXG4gICAgICB2YXIgdGV4dExheWVyID0gbmV3IFRleHRMYXllckJ1aWxkZXIoe1xyXG4gICAgICAgIHRleHRMYXllckRpdjogdGV4dExheWVyRGl2LFxyXG4gICAgICAgIHBhZ2VJbmRleDogcGFnZS5wYWdlSW5kZXgsXHJcbiAgICAgICAgdmlld3BvcnQ6IHZpZXdwb3J0XHJcbiAgICAgIH0pO1xyXG4gICAgXHJcbiAgICAgIHRleHRMYXllci5zZXRUZXh0Q29udGVudCh0ZXh0Q29udGVudCk7XHJcbiAgICBcclxuICAgICAgdGV4dExheWVyLnJlbmRlcigpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcblxyXG5cclxuZ2V0UERGKHVybCk7Il19
