if !isIncluded('publicModules/moment/moment.pug')
  +includeCSS('/publicModules/moment/moment.css')
  include ../../publicModules/mediaPreview/mediaPreview

  mixin momentList(momentsData)
    .moments-container
      for momentData in momentsData
        .moment-item
          +singleMoment(momentData)

  mixin momentFiles(files)
    if files && files.length > 0
      -var fileType = files[0].type;
      -var fileCount = files.length;
      .single-moment-files(
        data-file-type=fileType
        data-file-count=fileCount
        )
        for file in files
          .single-moment-file
            if fileType === 'video'
              +singleVideo(file)
            else
              div(style=`background-image: url(${file.url})`)
                img(
                  data-src=file.url
                  data-tag='nkcsource'
                  data-type='picture'
                  class="lazyload"
                  alt=file.filename
                  title=file.filename
                  )

  mixin singleMoment(momentData)
    -var {uid, toc, username, avatarUrl, userHome, time, content, voteUp, files} = momentData;
    .single-moment-container
      .single-moment-left
        .single-moment-avatar(data-float-uid=uid)
          img(src=avatarUrl)
      .single-moment-right
        .single-moment-header
          .single-moment-user(data-float-uid=uid)
            a(href=userHome target="_blank")=username
          .single-moment-time
            +fromNow(toc)
        .single-moment-content!=content
        +momentFiles(files)
        .single-moment-bottom
          .single-moment-bottom-left
            .fa.fa-comment-o
          .single-moment-bottom-center
            .fa.fa-retweet
          .single-moment-bottom-right
            .fa.fa-thumbs-o-up

