(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var StickerViewer = function StickerViewer() {
  _classCallCheck(this, StickerViewer);

  var self = this;
  self.dom = $("#moduleStickerViewer");
  self.dom.modal({
    show: false
  });
  self.app = new Vue({
    el: "#moduleStickerViewerApp",
    data: {
      sticker: "",
      uid: NKC.configs.uid,
      management: false,
      loading: false
    },
    mounted: function mounted() {
      this.init();
    },
    methods: {
      getUrl: NKC.methods.tools.getUrl,
      fromNow: NKC.methods.fromNow,
      collection: function collection() {
        nkcAPI("/sticker", "POST", {
          type: "collection",
          stickersId: [this.sticker._id]
        }).then(function () {
          self.app.close();
          sweetSuccess("表情已添加");
        })["catch"](sweetError);
      },
      moveSticker: function moveSticker() {
        var sticker = this.sticker;
        var body = {
          type: "move",
          stickersId: [sticker.collected._id]
        };
        nkcAPI("/sticker", "POST", body).then(function () {
          self.app.close();
          window.location.reload();
        })["catch"](sweetError);
      },
      shareSticker: function shareSticker() {
        var sticker = this.sticker;
        var body = {
          type: "share",
          stickersId: [sticker._id]
        };
        nkcAPI("/sticker", "POST", body).then(function () {
          sweetSuccess("操作成功");
        })["catch"](sweetError);
      },
      removeSticker: function removeSticker() {
        var sticker = this.sticker;
        sweetQuestion("\u786E\u5B9A\u8981\u5220\u9664\u8868\u60C5\uFF1F").then(function () {
          var body = {
            type: "delete",
            stickersId: [sticker.collected._id]
          };
          return nkcAPI("/sticker", "POST", body);
        }).then(function () {
          self.app.close();
          window.location.reload();
        })["catch"](sweetError);
      },
      init: function init() {
        // 旧 数据统一后可移除
        var dom = $("[data-sticker-rid]");

        for (var i = 0; i < dom.length; i++) {
          var d = dom.eq(i);
          if (d.attr("data-sticker-init") === "true") continue;
          d.on("click", function () {
            self.app.open($(this).attr("data-sticker-rid"), !!$(this).attr("data-sticker-management"));
          });
          d.attr("data-sticker-init", "true");
        } // 新


        var dom2 = $("span[data-tag='nkcsource'][data-type='sticker']");
        dom2.each(function () {
          var d = $(this);
          if (d.attr("data-sticker-init") === "true") return;
          d.on("click", function () {
            self.app.open($(this).attr("data-id"), !!$(this).attr("data-sticker-management"));
          });
          d.attr("data-sticker-init", "true");
        });
      },
      open: function open(rid, management) {
        self.app.management = !!management;
        self.dom.modal("show");
        this.loading = true;
        nkcAPI("/sticker/".concat(rid, "?t=json"), "GET").then(function (data) {
          self.app.sticker = data.sticker;
          self.app.loading = false;
        })["catch"](sweetError);
      },
      close: function close() {
        self.dom.modal("hide");
      }
    }
  });
  self.initPanel = self.app.init;
};

var stickerViewer = new StickerViewer();
NKC.methods.initStickerViewer = stickerViewer.app.init;

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwYWdlcy9wdWJsaWNNb2R1bGVzL3N0aWNrZXIvc3RpY2tlci5tanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0lDQU0sYSxHQUNKLHlCQUFjO0FBQUE7O0FBQ1osTUFBTSxJQUFJLEdBQUcsSUFBYjtBQUNBLEVBQUEsSUFBSSxDQUFDLEdBQUwsR0FBVyxDQUFDLENBQUMsc0JBQUQsQ0FBWjtBQUNBLEVBQUEsSUFBSSxDQUFDLEdBQUwsQ0FBUyxLQUFULENBQWU7QUFDYixJQUFBLElBQUksRUFBRTtBQURPLEdBQWY7QUFHQSxFQUFBLElBQUksQ0FBQyxHQUFMLEdBQVcsSUFBSSxHQUFKLENBQVE7QUFDakIsSUFBQSxFQUFFLEVBQUUseUJBRGE7QUFFakIsSUFBQSxJQUFJLEVBQUU7QUFDSixNQUFBLE9BQU8sRUFBRSxFQURMO0FBRUosTUFBQSxHQUFHLEVBQUUsR0FBRyxDQUFDLE9BQUosQ0FBWSxHQUZiO0FBR0osTUFBQSxVQUFVLEVBQUUsS0FIUjtBQUlKLE1BQUEsT0FBTyxFQUFFO0FBSkwsS0FGVztBQVFqQixJQUFBLE9BUmlCLHFCQVFQO0FBQ1IsV0FBSyxJQUFMO0FBQ0QsS0FWZ0I7QUFXakIsSUFBQSxPQUFPLEVBQUU7QUFDUCxNQUFBLE1BQU0sRUFBRSxHQUFHLENBQUMsT0FBSixDQUFZLEtBQVosQ0FBa0IsTUFEbkI7QUFFUCxNQUFBLE9BQU8sRUFBRSxHQUFHLENBQUMsT0FBSixDQUFZLE9BRmQ7QUFHUCxNQUFBLFVBSE8sd0JBR007QUFDWCxRQUFBLE1BQU0sYUFBYSxNQUFiLEVBQXFCO0FBQ3pCLFVBQUEsSUFBSSxFQUFFLFlBRG1CO0FBRXpCLFVBQUEsVUFBVSxFQUFFLENBQUMsS0FBSyxPQUFMLENBQWEsR0FBZDtBQUZhLFNBQXJCLENBQU4sQ0FJRyxJQUpILENBSVEsWUFBVztBQUNmLFVBQUEsSUFBSSxDQUFDLEdBQUwsQ0FBUyxLQUFUO0FBQ0Es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IjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJjbGFzcyBTdGlja2VyVmlld2VyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5kb20gPSAkKFwiI21vZHVsZVN0aWNrZXJWaWV3ZXJcIik7XG4gICAgc2VsZi5kb20ubW9kYWwoe1xuICAgICAgc2hvdzogZmFsc2VcbiAgICB9KTtcbiAgICBzZWxmLmFwcCA9IG5ldyBWdWUoe1xuICAgICAgZWw6IFwiI21vZHVsZVN0aWNrZXJWaWV3ZXJBcHBcIixcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgc3RpY2tlcjogXCJcIixcbiAgICAgICAgdWlkOiBOS0MuY29uZmlncy51aWQsXG4gICAgICAgIG1hbmFnZW1lbnQ6IGZhbHNlLFxuICAgICAgICBsb2FkaW5nOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIG1vdW50ZWQoKSB7XG4gICAgICAgIHRoaXMuaW5pdCgpO1xuICAgICAgfSxcbiAgICAgIG1ldGhvZHM6IHtcbiAgICAgICAgZ2V0VXJsOiBOS0MubWV0aG9kcy50b29scy5nZXRVcmwsXG4gICAgICAgIGZyb21Ob3c6IE5LQy5tZXRob2RzLmZyb21Ob3csXG4gICAgICAgIGNvbGxlY3Rpb24oKSB7XG4gICAgICAgICAgbmtjQVBJKGAvc3RpY2tlcmAsIFwiUE9TVFwiLCB7XG4gICAgICAgICAgICB0eXBlOiBcImNvbGxlY3Rpb25cIixcbiAgICAgICAgICAgIHN0aWNrZXJzSWQ6IFt0aGlzLnN0aWNrZXIuX2lkXVxuICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgc2VsZi5hcHAuY2xvc2UoKTtcbiAgICAgICAgICAgICAgc3dlZXRTdWNjZXNzKFwi6KGo5oOF5bey5re75YqgXCIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChzd2VldEVycm9yKTtcbiAgICAgICAgfSxcbiAgICAgICAgbW92ZVN0aWNrZXIoKSB7XG4gICAgICAgICAgY29uc3Qge3N0aWNrZXJ9ID0gdGhpcztcbiAgICAgICAgICBjb25zdCBib2R5ID0ge1xuICAgICAgICAgICAgdHlwZTogXCJtb3ZlXCIsXG4gICAgICAgICAgICBzdGlja2Vyc0lkOiBbc3RpY2tlci5jb2xsZWN0ZWQuX2lkXVxuICAgICAgICAgIH07XG4gICAgICAgICAgbmtjQVBJKFwiL3N0aWNrZXJcIiwgXCJQT1NUXCIsIGJvZHkpXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgIHNlbGYuYXBwLmNsb3NlKCk7XG4gICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goc3dlZXRFcnJvcik7XG4gICAgICAgIH0sXG4gICAgICAgIHNoYXJlU3RpY2tlcigpIHtcbiAgICAgICAgICBjb25zdCB7c3RpY2tlcn0gPSB0aGlzO1xuICAgICAgICAgIGNvbnN0IGJvZHkgPSB7XG4gICAgICAgICAgICB0eXBlOiBcInNoYXJlXCIsXG4gICAgICAgICAgICBzdGlja2Vyc0lkOiBbc3RpY2tlci5faWRdXG4gICAgICAgICAgfTtcbiAgICAgICAgICBua2NBUEkoXCIvc3RpY2tlclwiLCBcIlBPU1RcIiwgYm9keSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgc3dlZXRTdWNjZXNzKFwi5pON5L2c5oiQ5YqfXCIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChzd2VldEVycm9yKTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVtb3ZlU3RpY2tlcigpIHtcbiAgICAgICAgICBjb25zdCB7c3RpY2tlcn0gPSB0aGlzO1xuICAgICAgICAgIHN3ZWV0UXVlc3Rpb24oYOehruWumuimgeWIoOmZpOihqOaDhe+8n2ApXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGJvZHkgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJkZWxldGVcIixcbiAgICAgICAgICAgICAgICBzdGlja2Vyc0lkOiBbc3RpY2tlci5jb2xsZWN0ZWQuX2lkXVxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICByZXR1cm4gbmtjQVBJKFwiL3N0aWNrZXJcIiwgXCJQT1NUXCIsIGJvZHkpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgc2VsZi5hcHAuY2xvc2UoKTtcbiAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChzd2VldEVycm9yKTtcbiAgICAgICAgfSxcbiAgICAgICAgaW5pdCgpIHtcbiAgICAgICAgICAvLyDml6cg5pWw5o2u57uf5LiA5ZCO5Y+v56e76ZmkXG4gICAgICAgICAgY29uc3QgZG9tID0gJChcIltkYXRhLXN0aWNrZXItcmlkXVwiKTtcblxuICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBkb20ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGQgPSBkb20uZXEoaSk7XG4gICAgICAgICAgICBpZihkLmF0dHIoXCJkYXRhLXN0aWNrZXItaW5pdFwiKSA9PT0gXCJ0cnVlXCIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgZC5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBzZWxmLmFwcC5vcGVuKCQodGhpcykuYXR0cihcImRhdGEtc3RpY2tlci1yaWRcIiksICEhJCh0aGlzKS5hdHRyKFwiZGF0YS1zdGlja2VyLW1hbmFnZW1lbnRcIikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkLmF0dHIoXCJkYXRhLXN0aWNrZXItaW5pdFwiLCBcInRydWVcIik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8g5pawXG4gICAgICAgICAgY29uc3QgZG9tMiA9ICQoXCJzcGFuW2RhdGEtdGFnPSdua2Nzb3VyY2UnXVtkYXRhLXR5cGU9J3N0aWNrZXInXVwiKTtcbiAgICAgICAgICBkb20yLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBkID0gJCh0aGlzKTtcbiAgICAgICAgICAgIGlmKGQuYXR0cihcImRhdGEtc3RpY2tlci1pbml0XCIpID09PSBcInRydWVcIikgcmV0dXJuO1xuICAgICAgICAgICAgZC5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBzZWxmLmFwcC5vcGVuKCQodGhpcykuYXR0cihcImRhdGEtaWRcIiksICEhJCh0aGlzKS5hdHRyKFwiZGF0YS1zdGlja2VyLW1hbmFnZW1lbnRcIikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkLmF0dHIoXCJkYXRhLXN0aWNrZXItaW5pdFwiLCBcInRydWVcIik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9wZW4ocmlkLCBtYW5hZ2VtZW50KSB7XG4gICAgICAgICAgc2VsZi5hcHAubWFuYWdlbWVudCA9ICEhbWFuYWdlbWVudDtcbiAgICAgICAgICBzZWxmLmRvbS5tb2RhbChcInNob3dcIik7XG4gICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICBua2NBUEkoYC9zdGlja2VyLyR7cmlkfT90PWpzb25gLCBcIkdFVFwiKVxuICAgICAgICAgICAgLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgICAgICAgIHNlbGYuYXBwLnN0aWNrZXIgPSBkYXRhLnN0aWNrZXI7XG4gICAgICAgICAgICAgIHNlbGYuYXBwLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goc3dlZXRFcnJvcik7XG4gICAgICAgIH0sXG4gICAgICAgIGNsb3NlKCkge1xuICAgICAgICAgIHNlbGYuZG9tLm1vZGFsKFwiaGlkZVwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIHNlbGYuaW5pdFBhbmVsID0gc2VsZi5hcHAuaW5pdDtcbiAgfVxufVxuY29uc3Qgc3RpY2tlclZpZXdlciA9IG5ldyBTdGlja2VyVmlld2VyKCk7XG5OS0MubWV0aG9kcy5pbml0U3RpY2tlclZpZXdlciA9IHN0aWNrZXJWaWV3ZXIuYXBwLmluaXQ7XG4iXX0=
