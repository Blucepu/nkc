!function n(o,i,a){function s(e,r){if(!i[e]){if(!o[e]){var t="function"==typeof require&&require;if(!r&&t)return t(e,!0);if(l)return l(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}t=i[e]={exports:{}},o[e][0].call(t.exports,function(r){return s(o[e][1][r]||r)},t,t.exports,n,o,i,a)}return i[e].exports}for(var l="function"==typeof require&&require,r=0;r<a.length;r++)s(a[r]);return s}({1:[function(r,e,t){"use strict";function s(r,e){var t;if("undefined"==typeof Symbol||null==r[Symbol.iterator]){if(Array.isArray(r)||(t=function(r,e){if(!r)return;if("string"==typeof r)return l(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);"Object"===t&&r.constructor&&(t=r.constructor.name);if("Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return l(r,e)}(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var n=0,e=function(){};return{s:e,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(r){throw r},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){t=r[Symbol.iterator]()},n:function(){var r=t.next();return i=r.done,r},e:function(r){a=!0,o=r},f:function(){try{i||null==t.return||t.return()}finally{if(a)throw o}}}}function l(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function o(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}NKC.modules.LibraryPath=function(){function e(){!function(r){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var a=this;a.dom=$("#moduleLibraryPath"),a.dom.modal({show:!1,backdrop:"static"}),a.app=new Vue({el:"#moduleLibraryPathApp",data:{uid:NKC.configs.uid,folders:[],warning:"",folder:"",originFolders:[],permission:[],form:{type:"",folder:"",name:"",description:""}},computed:{originFoldersId:function(){return this.originFolders.map(function(r){return r._id})},selectedFolderId:function(){if(this.folder)return this.folder._id},activeLine:function(){var r=this.folders,o=this.folder,i=0;return function r(e){for(var t=0;t<e.length;t++){var n=e[t];if(i++,n._id===o._id)return;if(n.folders&&n.folders.length)return r(n.folders)}}(r),i},nav:function(){if(this.folder)return this.getFolderNav(this.folder)},path:function(){if(this.nav)return"/"+this.nav.map(function(r){return r.name}).join("/")}},methods:{per:function(r){return this.permission.includes(r)},submitForm:function(){var r,e=this.form,t=e.type,n=e.folder,o=e.name,i=e.description,e="create"===t?(r="POST","/library/".concat(n._id,"/list")):(r="PUT","/library/".concat(n._id));nkcAPI(e,r,{name:o,description:i}).then(function(){a.app.form.folder="","create"===t?(n.close=!0,n.loaded=!1,n.folderCount=(n.folderCount||0)+1,a.app.switchFolder(n)):(n.name=o,n.description=i)}).catch(function(r){sweetError(r)})},toForm:function(r,e){"modify"===(this.form.type=r)?(this.form.name=e.name,this.form.description=e.description):(this.form.name="",this.form.description=""),this.form.folder=e},getFolderNav:function(r){for(var e=this.originFolders,t=r.lid,n=[r];t;){var o=s(e);try{for(o.s();!(i=o.n()).done;){var i=i.value;i._id===t&&(n.unshift(i),t=i.lid)}}catch(r){o.e(r)}finally{o.f()}}return n},saveToOrigin:function(r){var e=a.app,t=e.originFoldersId,n=e.originFolders,o=s(r);try{for(o.s();!(i=o.n()).done;){var i=i.value;t.includes(i._id)||n.push(i);i=i.folders,i=void 0===i?[]:i;a.app.saveToOrigin(i)}}catch(r){o.e(r)}finally{o.f()}},scrollToActive:function(){var t=this;setTimeout(function(){var r=t.activeLine,e=30*(r=0<(r-=3)?r:0),r=t.$refs.listBody;NKC.methods.scrollTop(r,e)},100)},submit:function(){this.folder&&(a.callback({folder:this.folder,nav:this.nav,path:this.path}),this.close())},switchFolder:function(r){this.selectFolder(r),r.close?(r.close=!1,r.loaded||this.getFolders(r)):r.close=!0},selectFolder:function(r){this.folder=r},initFolders:function(e){var r="/library?type=init&lid=".concat(e,"&t=").concat(Date.now());nkcAPI(r,"GET").then(function(r){a.app.folders=r.folders,a.app.folder=r.folder,a.app.permission=r.permission,a.app.saveToOrigin(r.folders),e&&a.app.scrollToActive()}).catch(function(r){sweetError(r)})},getFolders:function(e){var r=(e?"/library?type=getFolders&lid=".concat(e._id,"&t="):"/library?type=getFolders&t=").concat(Date.now());nkcAPI(r,"GET").then(function(r){a.app.permission=r.permission,e&&(e.loaded=!0),r.folders.map(function(r){r.close=!0,r.loaded=!1,r.folders=[],e&&(r.parent=e)}),e?e.folders=r.folders:a.app.folders=r.folders,a.app.saveToOrigin(r.folders)}).catch(function(r){e&&(e.close=!0),sweetError(r)})},open:function(r){var e=0<arguments.length&&void 0!==r?r:{},r=e.lid,e=e.warning,e=void 0===e?"":e;this.warning=e,r?(this.folder="",this.initFolders(r)):this.folders&&this.folders.length||this.getFolders(),a.dom.modal("show")},close:function(){a.dom.modal("hide")}}})}var r,t,n;return r=e,(t=[{key:"open",value:function(r,e){this.callback=r,this.app.open(e)}},{key:"close",value:function(){this.app.close()}}])&&o(r.prototype,t),n&&o(r,n),e}()},{}]},{},[1]);