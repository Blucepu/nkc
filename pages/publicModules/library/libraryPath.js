!function i(a,s,l){function f(e,r){if(!s[e]){if(!a[e]){var t="function"==typeof require&&require;if(!r&&t)return t(e,!0);if(c)return c(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var o=s[e]={exports:{}};a[e][0].call(o.exports,function(r){return f(a[e][1][r]||r)},o,o.exports,i,a,s,l)}return s[e].exports}for(var c="function"==typeof require&&require,r=0;r<l.length;r++)f(l[r]);return f}({1:[function(r,e,t){"use strict";function c(r,e){var t;if("undefined"==typeof Symbol||null==r[Symbol.iterator]){if(Array.isArray(r)||(t=function(r,e){if(!r)return;if("string"==typeof r)return l(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);"Object"===t&&r.constructor&&(t=r.constructor.name);if("Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return l(r,e)}(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var n=0,o=function(){};return{s:o,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(r){throw r},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){t=r[Symbol.iterator]()},n:function(){var r=t.next();return a=r.done,r},e:function(r){s=!0,i=r},f:function(){try{a||null==t.return||t.return()}finally{if(s)throw i}}}}function l(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function o(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}NKC.modules.LibraryPath=function(){function r(){!function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var f=this;f.dom=$("#moduleLibraryPath"),f.dom.modal({show:!1,backdrop:"static"}),f.app=new Vue({el:"#moduleLibraryPathApp",data:{uid:NKC.configs.uid,folders:[],warning:"",folder:"",originFolders:[],permission:[],form:{type:"",folder:"",name:"",description:""}},computed:{originFoldersId:function(){return this.originFolders.map(function(r){return r._id})},selectedFolderId:function(){if(this.folder)return this.folder._id},activeLine:function(){var r=this.folders,o=this.folder,i=0;return function r(e){for(var t=0;t<e.length;t++){var n=e[t];if(i++,n._id===o._id)return;if(n.folders&&n.folders.length)return r(n.folders)}}(r),i},nav:function(){if(this.folder)return this.getFolderNav(this.folder)},path:function(){if(this.nav)return"/"+this.nav.map(function(r){return r.name}).join("/")}},methods:{per:function(r){return this.permission.includes(r)},submitForm:function(){var r,e=this.form,t=e.type,n=e.folder,o=e.name,i=e.description,a="create"===t?(r="POST","/library/".concat(n._id,"/list")):(r="PUT","/library/".concat(n._id));nkcAPI(a,r,{name:o,description:i}).then(function(){f.app.form.folder="","create"===t?(n.close=!0,n.loaded=!1,n.folderCount=(n.folderCount||0)+1,f.app.switchFolder(n)):(n.name=o,n.description=i)}).catch(function(r){sweetError(r)})},toForm:function(r,e){"modify"===(this.form.type=r)?(this.form.name=e.name,this.form.description=e.description):(this.form.name="",this.form.description=""),this.form.folder=e},getFolderNav:function(r){for(var e=this.originFolders,t=r.lid,n=[r];t;){var o,i=c(e);try{for(i.s();!(o=i.n()).done;){var a=o.value;a._id===t&&(n.unshift(a),t=a.lid)}}catch(r){i.e(r)}finally{i.f()}}return n},saveToOrigin:function(r){var e,t=f.app,n=t.originFoldersId,o=t.originFolders,i=c(r);try{for(i.s();!(e=i.n()).done;){var a=e.value;n.includes(a._id)||o.push(a);var s=a.folders,l=void 0===s?[]:s;f.app.saveToOrigin(l)}}catch(r){i.e(r)}finally{i.f()}},scrollToActive:function(){var n=this;setTimeout(function(){var r=n.activeLine,e=30*(r=0<(r-=3)?r:0),t=n.$refs.listBody;NKC.methods.scrollTop(t,e)},100)},submit:function(){this.folder&&(f.callback({folder:this.folder,nav:this.nav,path:this.path}),this.close())},switchFolder:function(r){this.selectFolder(r),r.close?(r.close=!1,r.loaded||this.getFolders(r)):r.close=!0},selectFolder:function(r){this.folder=r},initFolders:function(e){var r="/library?type=init&lid=".concat(e,"&t=").concat(Date.now());nkcAPI(r,"GET").then(function(r){f.app.folders=r.folders,f.app.folder=r.folder,f.app.permission=r.permission,f.app.saveToOrigin(r.folders),e&&f.app.scrollToActive()}).catch(function(r){sweetError(r)})},getFolders:function(e){var r=e?"/library?type=getFolders&lid=".concat(e._id,"&t=").concat(Date.now()):"/library?type=getFolders&t=".concat(Date.now());nkcAPI(r,"GET").then(function(r){f.app.permission=r.permission,e&&(e.loaded=!0),r.folders.map(function(r){r.close=!0,r.loaded=!1,r.folders=[],e&&(r.parent=e)}),e?e.folders=r.folders:f.app.folders=r.folders,f.app.saveToOrigin(r.folders)}).catch(function(r){e&&(e.close=!0),sweetError(r)})},open:function(r){var e=0<arguments.length&&void 0!==r?r:{},t=e.lid,n=e.warning,o=void 0===n?"":n;this.warning=o,t?(this.folder="",this.initFolders(t)):this.folders&&this.folders.length||this.getFolders(),f.dom.modal("show")},close:function(){f.dom.modal("hide")}}})}var e,t,n;return e=r,(t=[{key:"open",value:function(r,e){this.callback=r,this.app.open(e)}},{key:"close",value:function(){this.app.close()}}])&&o(e.prototype,t),n&&o(e,n),r}()},{}]},{},[1]);