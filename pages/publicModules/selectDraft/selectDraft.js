(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

NKC.modules.SelectDraft = /*#__PURE__*/function () {
  function _class() {
    _classCallCheck(this, _class);

    var self = this;
    self.dom = $("#moduleSelectDraft");
    self.app = new Vue({
      el: "#moduleSelectDraftApp",
      data: {
        uid: NKC.configs.uid,
        paging: {},
        perpage: 7,
        loading: true,
        drafts: []
      },
      methods: {
        fromNow: NKC.methods.fromNow,
        initDom: function initDom() {
          var height = "43.5rem";
          self.dom.css({
            height: height
          });
          self.dom.draggable({
            scroll: false,
            handle: ".module-sd-title",
            drag: function drag(event, ui) {
              if (ui.position.top < 0) ui.position.top = 0;
              var height = $(window).height();
              if (ui.position.top > height - 30) ui.position.top = height - 30;
              var width = self.dom.width();
              if (ui.position.left < 100 - width) ui.position.left = 100 - width;
              var winWidth = $(window).width();
              if (ui.position.left > winWidth - 100) ui.position.left = winWidth - 100;
            }
          });
          var width = $(window).width();

          if (width < 700) {
            // 小屏幕
            self.dom.css({
              "width": width * 0.8,
              "top": 0,
              "right": 0
            });
          } else {
            // 宽屏
            self.dom.css("left", (width - self.dom.width()) * 0.5 - 20);
          }

          self.dom.show();
        },
        getDraftInfo: function getDraftInfo(draft) {
          var type = draft.type,
              thread = draft.thread,
              forum = draft.forum;
          var info = "";

          if (type === "newThread") {
            info = "\u53D1\u8868\u6587\u7AE0";
          } else if (type === "newPost") {
            info = "\u5728\u6587\u7AE0\u300A".concat(thread.title, "\u300B\u4E0B\u53D1\u8868\u56DE\u590D");
          } else if (type === "modifyPost") {
            info = "\u4FEE\u6539\u6587\u7AE0\u300A".concat(thread.title, "\u300B\u4E0B\u7684\u56DE\u590D");
          } else if (type === "modifyThread") {
            info = "\u4FEE\u6539\u6587\u7AE0\u300A".concat(thread.title, "\u300B");
          } else {
            info = "\u4FEE\u6539\u4E13\u4E1A\u300A".concat(forum.title, "\u300B\u7684\u4E13\u4E1A\u8BF4\u660E");
          }

          return info;
        },
        insert: function insert(data) {
          self.callback(data);
          data.delay = 3;

          var func = function func() {
            setTimeout(function () {
              data.delay--;

              if (data.delay > 0) {
                func();
              }
            }, 1000);
          };

          func();
        },
        removeDraft: function removeDraft(draft) {
          var _this = this;

          sweetQuestion("确定要删除草稿吗？").then(function () {
            nkcAPI('/u/' + _this.uid + "/drafts/" + draft.did, "DELETE").then(function () {
              self.app.getDrafts(self.app.paging.page);
            })["catch"](function (data) {
              sweetError(data);
            });
          });
        },
        getDrafts: function getDrafts() {
          var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
          nkcAPI("/u/".concat(this.uid, "/profile/draft?page=").concat(page, "&perpage=").concat(this.perpage), "GET").then(function (data) {
            data.drafts.map(function (d) {
              d.delay = 0;
            });
            self.app.drafts = data.drafts;
            self.app.paging = data.paging;
            self.app.loading = false;
          })["catch"](sweetError);
        },
        loadDraft: function loadDraft(d) {
          sweetQuestion("\u7EE7\u7EED\u521B\u4F5C\u5C06\u4F1A\u8986\u76D6\u7F16\u8F91\u5668\u4E2D\u5168\u90E8\u5185\u5BB9\uFF0C\u786E\u5B9A\u7EE7\u7EED\uFF1F").then(function () {
            if (window.PostInfo && window.PostInfo.showCloseInfo) {
              window.PostInfo.showCloseInfo = false;
            }

            window.location.href = "/editor?type=redit&id=".concat(d.did);
          })["catch"](sweetError);
        },
        refresh: function refresh() {
          this.getDrafts(self.app.paging.page);
        },
        open: function open(callback) {
          self.callback = callback;
          this.initDom();
          this.getDrafts();
        },
        close: function close() {
          self.dom.hide();
        }
      }
    });
    self.open = self.app.open;
    self.close = self.app.close;
  }

  return _class;
}();

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9fYnJvd3Nlci1wYWNrQDYuMS4wQGJyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsInBhZ2VzL3B1YmxpY01vZHVsZXMvc2VsZWN0RHJhZnQvc2VsZWN0RHJhZnQubWpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7OztBQ0FBLEdBQUcsQ0FBQyxPQUFKLENBQVksV0FBWjtBQUNFLG9CQUFjO0FBQUE7O0FBQ1osUUFBTSxJQUFJLEdBQUcsSUFBYjtBQUNBLElBQUEsSUFBSSxDQUFDLEdBQUwsR0FBVyxDQUFDLENBQUMsb0JBQUQsQ0FBWjtBQUNBLElBQUEsSUFBSSxDQUFDLEdBQUwsR0FBVyxJQUFJLEdBQUosQ0FBUTtBQUNqQixNQUFBLEVBQUUsRUFBRSx1QkFEYTtBQUVqQixNQUFBLElBQUksRUFBRTtBQUNKLFFBQUEsR0FBRyxFQUFFLEdBQUcsQ0FBQyxPQUFKLENBQVksR0FEYjtBQUVKLFFBQUEsTUFBTSxFQUFFLEVBRko7QUFHSixRQUFBLE9BQU8sRUFBRSxDQUhMO0FBSUosUUFBQSxPQUFPLEVBQUUsSUFKTDtBQUtKLFFBQUEsTUFBTSxFQUFFO0FBTEosT0FGVztBQVNqQixNQUFBLE9BQU8sRUFBRTtBQUNQLFFBQUEsT0FBTyxFQUFFLEdBQUcsQ0FBQyxPQUFKLENBQVksT0FEZDtBQUVQLFFBQUEsT0FGTyxxQkFFRztBQUNSLGNBQU0sTUFBTSxHQUFHLFNBQWY7QUFDQSxVQUFBLElBQUksQ0FBQyxHQUFMLENBQVMsR0FBVCxDQUFhO0FBQ1gsWUFBQSxNQUFNLEVBQU47QUFEVyxXQUFiO0FBR0EsVUFBQSxJQUFJLENBQUMsR0FBTCxDQUFTLFNBQVQsQ0FBbUI7QUFDakIsWUFBQSxNQUFNLEVBQUUsS0FEUztBQUVqQixZQUFBLE1BQU0sRUFBRSxrQkFGUztBQUdqQixZQUFBLElBQUksRUFBRSxjQUFTLEtBQVQsRUFBZ0IsRUFBaEIsRUFBb0I7QUFDeEIsa0JBQUcsRUFBRSxDQUFDLFFBQUgsQ0FBWSxHQUFaLEdBQWtC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VUFBQSxhQUFhLHdJQUFiLENBQ0csSUFESCxDQUNRLFlBQU07QUFDVixnQkFBRyxNQUFNLENBQUMsUUFBUCxJQUFtQixNQUFNLENBQUMsUUFBUCxDQUFnQixhQUF0QyxFQUFxRDtBQUNuRCxjQUFBLE1BQU0sQ0FBQyxRQUFQLENBQWdCLGFBQWhCLEdBQWdDLEtBQWhDO0FBQ0Q7O0FBQ0QsWUFBQSxNQUFNLENBQUMsUUFBUCxDQUFnQixJQUFoQixtQ0FBZ0QsQ0FBQyxDQUFDLEdBQWxEO0FBQ0QsV0FOSCxXQU9TLFVBUFQ7QUFRRCxTQWhHTTtBQWlHUCxRQUFBLE9BakdPLHFCQWlHRztBQUNSLGVBQUssU0FBTCxDQUFlLElBQUksQ0FBQyxHQUFMLENBQVMsTUFBVCxDQUFnQixJQUEvQjtBQUNELFNBbkdNO0FBb0dQLFFBQUEsSUFwR08sZ0JBb0dGLFFBcEdFLEVBb0dRO0FBQ2IsVUFBQSxJQUFJLENBQUMsUUFBTCxHQUFnQixRQUFoQjtBQUNBLGVBQUssT0FBTDtBQUNBLGVBQUssU0FBTDtBQUNELFNBeEdNO0FBeUdQLFFBQUEsS0F6R08sbUJBeUdDO0FBQ04sVUFBQSxJQUFJLENBQUMsR0FBTCxDQUFTLElBQVQ7QUFDRDtBQTNHTTtBQVRRLEtBQVIsQ0FBWDtBQXVIQSxJQUFBLElBQUksQ0FBQyxJQUFMLEdBQVksSUFBSSxDQUFDLEdBQUwsQ0FBUyxJQUFyQjtBQUNBLElBQUEsSUFBSSxDQUFDLEtBQUwsR0FBYSxJQUFJLENBQUMsR0FBTCxDQUFTLEtBQXRCO0FBQ0Q7O0FBN0hIO0FBQUEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJOS0MubW9kdWxlcy5TZWxlY3REcmFmdCA9IGNsYXNzIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5kb20gPSAkKFwiI21vZHVsZVNlbGVjdERyYWZ0XCIpO1xyXG4gICAgc2VsZi5hcHAgPSBuZXcgVnVlKHtcclxuICAgICAgZWw6IFwiI21vZHVsZVNlbGVjdERyYWZ0QXBwXCIsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICB1aWQ6IE5LQy5jb25maWdzLnVpZCxcclxuICAgICAgICBwYWdpbmc6IHt9LFxyXG4gICAgICAgIHBlcnBhZ2U6IDcsXHJcbiAgICAgICAgbG9hZGluZzogdHJ1ZSxcclxuICAgICAgICBkcmFmdHM6IFtdXHJcbiAgICAgIH0sXHJcbiAgICAgIG1ldGhvZHM6IHtcclxuICAgICAgICBmcm9tTm93OiBOS0MubWV0aG9kcy5mcm9tTm93LFxyXG4gICAgICAgIGluaXREb20oKSB7XHJcbiAgICAgICAgICBjb25zdCBoZWlnaHQgPSBcIjQzLjVyZW1cIjtcclxuICAgICAgICAgIHNlbGYuZG9tLmNzcyh7XHJcbiAgICAgICAgICAgIGhlaWdodFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBzZWxmLmRvbS5kcmFnZ2FibGUoe1xyXG4gICAgICAgICAgICBzY3JvbGw6IGZhbHNlLFxyXG4gICAgICAgICAgICBoYW5kbGU6IFwiLm1vZHVsZS1zZC10aXRsZVwiLFxyXG4gICAgICAgICAgICBkcmFnOiBmdW5jdGlvbihldmVudCwgdWkpIHtcclxuICAgICAgICAgICAgICBpZih1aS5wb3NpdGlvbi50b3AgPCAwKSB1aS5wb3NpdGlvbi50b3AgPSAwO1xyXG4gICAgICAgICAgICAgIGNvbnN0IGhlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKTtcclxuICAgICAgICAgICAgICBpZih1aS5wb3NpdGlvbi50b3AgPiBoZWlnaHQgLSAzMCkgdWkucG9zaXRpb24udG9wID0gaGVpZ2h0IC0gMzA7XHJcbiAgICAgICAgICAgICAgY29uc3Qgd2lkdGggPSBzZWxmLmRvbS53aWR0aCgpO1xyXG4gICAgICAgICAgICAgIGlmKHVpLnBvc2l0aW9uLmxlZnQgPCAxMDAgLSB3aWR0aCkgdWkucG9zaXRpb24ubGVmdCA9IDEwMCAtIHdpZHRoO1xyXG4gICAgICAgICAgICAgIGNvbnN0IHdpbldpZHRoID0gJCh3aW5kb3cpLndpZHRoKCk7XHJcbiAgICAgICAgICAgICAgaWYodWkucG9zaXRpb24ubGVmdCA+IHdpbldpZHRoIC0gMTAwKSB1aS5wb3NpdGlvbi5sZWZ0ID0gd2luV2lkdGggLSAxMDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgY29uc3Qgd2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTtcclxuICAgICAgICAgIGlmKHdpZHRoIDwgNzAwKSB7XHJcbiAgICAgICAgICAgIC8vIOWwj+Wxj+W5lVxyXG4gICAgICAgICAgICBzZWxmLmRvbS5jc3Moe1xyXG4gICAgICAgICAgICAgIFwid2lkdGhcIjogd2lkdGggKiAwLjgsXHJcbiAgICAgICAgICAgICAgXCJ0b3BcIjogMCxcclxuICAgICAgICAgICAgICBcInJpZ2h0XCI6IDBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDlrr3lsY9cclxuICAgICAgICAgICAgc2VsZi5kb20uY3NzKFwibGVmdFwiLCAod2lkdGggLSBzZWxmLmRvbS53aWR0aCgpKSowLjUgLSAyMCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBzZWxmLmRvbS5zaG93KCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXREcmFmdEluZm8oZHJhZnQpIHtcclxuICAgICAgICAgIGNvbnN0IHt0eXBlLCB0aHJlYWQsIGZvcnVtfSA9IGRyYWZ0O1xyXG4gICAgICAgICAgbGV0IGluZm8gPSBcIlwiO1xyXG4gICAgICAgICAgaWYodHlwZSA9PT0gXCJuZXdUaHJlYWRcIikge1xyXG4gICAgICAgICAgICBpbmZvID0gYOWPkeihqOaWh+eroGA7XHJcbiAgICAgICAgICB9IGVsc2UgaWYodHlwZSA9PT0gXCJuZXdQb3N0XCIpIHtcclxuICAgICAgICAgICAgaW5mbyA9IGDlnKjmlofnq6DjgIoke3RocmVhZC50aXRsZX3jgIvkuIvlj5Hooajlm57lpI1gO1xyXG4gICAgICAgICAgfSBlbHNlIGlmKHR5cGUgPT09IFwibW9kaWZ5UG9zdFwiKSB7XHJcbiAgICAgICAgICAgIGluZm8gPSBg5L+u5pS55paH56ug44CKJHt0aHJlYWQudGl0bGV944CL5LiL55qE5Zue5aSNYDtcclxuICAgICAgICAgIH0gZWxzZSBpZih0eXBlID09PSBcIm1vZGlmeVRocmVhZFwiKSB7XHJcbiAgICAgICAgICAgIGluZm8gPSBg5L+u5pS55paH56ug44CKJHt0aHJlYWQudGl0bGV944CLYDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGluZm8gPSBg5L+u5pS55LiT5Lia44CKJHtmb3J1bS50aXRsZX3jgIvnmoTkuJPkuJror7TmmI5gO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIGluZm87XHJcbiAgICAgICAgfSxcclxuICAgICAgICBpbnNlcnQoZGF0YSkge1xyXG4gICAgICAgICAgc2VsZi5jYWxsYmFjayhkYXRhKTtcclxuICAgICAgICAgIGRhdGEuZGVsYXkgPSAzO1xyXG4gICAgICAgICAgY29uc3QgZnVuYyA9ICgpID0+IHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgZGF0YS5kZWxheSAtLTtcclxuICAgICAgICAgICAgICBpZihkYXRhLmRlbGF5ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZnVuYygpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgMTAwMCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBmdW5jKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZW1vdmVEcmFmdChkcmFmdCkge1xyXG4gICAgICAgICAgc3dlZXRRdWVzdGlvbihcIuehruWumuimgeWIoOmZpOiNieeov+WQl++8n1wiKVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgbmtjQVBJKCcvdS8nICsgdGhpcy51aWQgKyBcIi9kcmFmdHMvXCIgKyBkcmFmdC5kaWQsIFwiREVMRVRFXCIpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgc2VsZi5hcHAuZ2V0RHJhZnRzKHNlbGYuYXBwLnBhZ2luZy5wYWdlKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICBzd2VldEVycm9yKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldERyYWZ0cyhwYWdlID0gMCkge1xyXG4gICAgICAgICAgbmtjQVBJKGAvdS8ke3RoaXMudWlkfS9wcm9maWxlL2RyYWZ0P3BhZ2U9JHtwYWdlfSZwZXJwYWdlPSR7dGhpcy5wZXJwYWdlfWAsIFwiR0VUXCIpXHJcbiAgICAgICAgICAgIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICAgIGRhdGEuZHJhZnRzLm1hcChkID0+IHtcclxuICAgICAgICAgICAgICAgIGQuZGVsYXkgPSAwO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIHNlbGYuYXBwLmRyYWZ0cyA9IGRhdGEuZHJhZnRzO1xyXG4gICAgICAgICAgICAgIHNlbGYuYXBwLnBhZ2luZyA9IGRhdGEucGFnaW5nO1xyXG4gICAgICAgICAgICAgIHNlbGYuYXBwLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKHN3ZWV0RXJyb3IpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbG9hZERyYWZ0KGQpIHtcclxuICAgICAgICAgIHN3ZWV0UXVlc3Rpb24oYOe7p+e7reWIm+S9nOWwhuS8muimhueblue8lui+keWZqOS4reWFqOmDqOWGheWuue+8jOehruWumue7p+e7re+8n2ApXHJcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICBpZih3aW5kb3cuUG9zdEluZm8gJiYgd2luZG93LlBvc3RJbmZvLnNob3dDbG9zZUluZm8pIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5Qb3N0SW5mby5zaG93Q2xvc2VJbmZvID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYC9lZGl0b3I/dHlwZT1yZWRpdCZpZD0ke2QuZGlkfWA7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChzd2VldEVycm9yKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICB0aGlzLmdldERyYWZ0cyhzZWxmLmFwcC5wYWdpbmcucGFnZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvcGVuKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICBzZWxmLmNhbGxiYWNrID0gY2FsbGJhY2s7XHJcbiAgICAgICAgICB0aGlzLmluaXREb20oKTtcclxuICAgICAgICAgIHRoaXMuZ2V0RHJhZnRzKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjbG9zZSgpIHtcclxuICAgICAgICAgIHNlbGYuZG9tLmhpZGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgc2VsZi5vcGVuID0gc2VsZi5hcHAub3BlbjtcclxuICAgIHNlbGYuY2xvc2UgPSBzZWxmLmFwcC5jbG9zZTtcclxuICB9XHJcbn07Il19
