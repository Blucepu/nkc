!function s(r,a,u){function h(e,t){if(!a[e]){if(!r[e]){var o="function"==typeof require&&require;if(!t&&o)return o(e,!0);if(f)return f(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var i=a[e]={exports:{}};r[e][0].call(i.exports,function(t){return h(r[e][1][t]||t)},i,i.exports,s,r,a,u)}return a[e].exports}for(var f="function"==typeof require&&require,t=0;t<u.length;t++)h(u[t]);return h}({1:[function(t,e,o){"use strict";function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}function s(t){f(this,s),this.id="nkcBullet_".concat(t.postId),t.id=this.id,this.info=t}var u=function(){function t(){f(this,t),this.dom=$('<a class="bullet" target="_blank"><img class="bullet-avatar" /><p class="bullet-content"></p></a>'),this.working=!1,this.top=0,this.speed=0,this.width=0,this.left=0,this.timeout=null}return i(t,[{key:"initMouseEvent",value:function(){function t(){var t=i.dom.offset().left,e=i.dom.width(),o=i.getTransitionTimeByDistance(t+e);i.dom.css({transform:"translatex(0)",transition:"transform ".concat(o,"ms linear 0s"),"z-index":"5555"}),n.createTimeout(o)}function e(){i.removeTimeout();var t=i.dom.offset().left;i.dom.css({transform:"translatex(".concat(t-i.left,"px)"),transition:"transform 0ms linear 0s","z-index":"9999"})}var n=this,i=this;this.dom.on("mouseover",e),this.dom.on("touchstart",e),this.dom.on("mouseleave",t),this.dom.on("touchend",t)}},{key:"clearMouseEvent",value:function(){this.dom.off("mouseover").off("mouseleave").off("touchstart").off("touchend")}},{key:"setInfo",value:function(t){this.clearMouseEvent(),this.working=!0;var e=t.contentUrl,o=t.id,n=t.avatarUrl,i=t.content,s=t.username;this.dom.attr({href:e,"data-id":o}),this.dom.find(".bullet-avatar").attr({src:n,alt:s}),this.dom.find(".bullet-content").text(i)}},{key:"setPosition",value:function(t){var e=t.top,o=t.speed;this.clearMouseEvent(),this.speed=o,this.top=e;var n=$(body).width(),i=this.dom.width();this.left=-i,this.dom.css({transform:"translatex(".concat(n+i,"px)"),transition:"transform 0ms",left:this.left+"px",top:e+"px"}),this.initMouseEvent()}},{key:"getTransitionTimeByDistance",value:function(t){return Math.round(t/(this.speed/1e3))}},{key:"removeTimeout",value:function(){clearTimeout(this.timeout)}},{key:"createTimeout",value:function(t){var e=this;this.timeout=setTimeout(function(){e.working=!1},t)}},{key:"getDom",value:function(){return this.dom}},{key:"move",value:function(){var t=this.dom.width(),e=$(body).width(),o=this.getTransitionTimeByDistance(t+e);this.dom.css({transform:"translatex(0)",transition:"transform ".concat(o,"ms linear 0s")}),this.createTimeout(o)}}]),t}(),l=function(){function o(t){var e=t.top;f(this,o),768<$(body).width()?this.speed=Math.round(50*Math.random()+60):this.speed=Math.round(50*Math.random()+40),this.top=e,this.boat=null}return i(o,[{key:"isFree",value:function(){var t,e=!0;return!this.boat||(t=this.boat.getDom()).offset().left+t.width()>$("body").width()&&(e=!1),e}}]),o}(),r=function(){function h(t){f(this,h);var e=t||{},o=e.trackCount,n=void 0===o?8:o,i=e.offsetTop,s=void 0===i?60:i,r=e.boatCount,a=void 0===r?64:r;this.id="nkcBullet".concat(Date.now()).concat(Math.round(1e3*Math.random())),this.setTimeoutId=null,this.bullets=[],this.boats=[],this.boatCount=a,this.tracks=[];for(var u=0;u<n;u++)this.tracks.push(new l({top:s+46*u}))}return i(h,[{key:"add",value:function(t){var e=new s(t);this.bullets.push(e),this.setTimeoutId||this.transition()}},{key:"getFreeBoats",value:function(){for(var t=this.tracks.length,e=[],o=0;o<this.boats.length;o++){var n=this.boats[o];if(!n.working&&(e.push(n),t<=e))break}var i=t-e.length;if(0<i)for(var s=this.boatCount-this.boats.length,r=0;r<(s<i?s:i);r++){var a=new u;this.boats.push(a),e.push(a)}return e}},{key:"transition",value:function(){var u=this,h=this,f=this.tracks,l=this.bullets;this.setTimeoutId=setTimeout(function(){for(var t=h.getFreeBoats(),e=0;e<f.length;e++){var o,n,i,s,r,a=f[e];a.isFree()&&((o=l.shift())&&(n=a.top,i=a.speed,(s=t.pop())&&(s.setInfo(o.info),r=(a.boat=s).getDom(),$(body).append(r),s.setPosition({top:n,speed:i}),s.move())))}l.length?h.transition():u.setTimeoutId=null},300)}}]),h}();NKC.modules.BulletComments=r},{}]},{},[1]);