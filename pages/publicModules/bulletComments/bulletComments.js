!function n(i,s,r){function a(e,t){if(!s[e]){if(!i[e]){var o="function"==typeof require&&require;if(!t&&o)return o(e,!0);if(u)return u(e,!0);throw(o=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",o}o=s[e]={exports:{}},i[e][0].call(o.exports,function(t){return a(i[e][1][t]||t)},o,o.exports,n,i,s,r)}return s[e].exports}for(var u="function"==typeof require&&require,t=0;t<r.length;t++)a(r[t]);return a}({1:[function(t,e,o){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}function a(t){r(this,a),this.id="nkcBullet_".concat(t.postId),t.id=this.id,this.info=t}var u=function(){function t(){r(this,t),this.dom=$('<a class="bullet" target="_blank"><img class="bullet-avatar" /><p class="bullet-content"></p></a>'),this.working=!1,this.top=0,this.speed=0,this.width=0,this.left=0,this.timeout=null}return i(t,[{key:"initMouseEvent",value:function(){function t(){var t=n.dom.offset().left,e=n.dom.width(),e=n.getTransitionTimeByDistance(t+e);n.dom.css({transform:"translatex(0)",transition:"transform ".concat(e,"ms linear 0s"),"z-index":"5555"}),o.createTimeout(e)}function e(){n.removeTimeout();var t=n.dom.offset().left;n.dom.css({transform:"translatex(".concat(t-n.left,"px)"),transition:"transform 0ms linear 0s","z-index":"9999"})}var o=this,n=this;this.dom.on("mouseover",e),this.dom.on("touchstart",e),this.dom.on("mouseleave",t),this.dom.on("touchend",t)}},{key:"clearMouseEvent",value:function(){this.dom.off("mouseover").off("mouseleave").off("touchstart").off("touchend")}},{key:"setInfo",value:function(t){this.clearMouseEvent(),this.working=!0;var e=t.contentUrl,o=t.id,n=t.avatarUrl,i=t.content,t=t.username;this.dom.attr({href:e,"data-id":o}),this.dom.find(".bullet-avatar").attr({src:n,alt:t}),this.dom.find(".bullet-content").text(i)}},{key:"setPosition",value:function(t){var e=t.top,o=t.speed;this.clearMouseEvent(),this.speed=o,this.top=e;t=$(body).width(),o=this.dom.width();this.left=-o,this.dom.css({transform:"translatex(".concat(t+o,"px)"),transition:"transform 0ms",left:this.left+"px",top:e+"px"}),this.initMouseEvent()}},{key:"getTransitionTimeByDistance",value:function(t){return Math.round(t/(this.speed/1e3))}},{key:"removeTimeout",value:function(){clearTimeout(this.timeout)}},{key:"createTimeout",value:function(t){var e=this;this.timeout=setTimeout(function(){e.working=!1},t)}},{key:"getDom",value:function(){return this.dom}},{key:"move",value:function(){var t=this.dom.width(),e=$(body).width(),e=this.getTransitionTimeByDistance(t+e);this.dom.css({transform:"translatex(0)",transition:"transform ".concat(e,"ms linear 0s")}),this.createTimeout(e)}}]),t}(),h=function(){function e(t){t=t.top;r(this,e),this.speed=Math.round(50*Math.random()+130),this.top=t,this.boat=null}return i(e,[{key:"isFree",value:function(){var t,e=!0;return!this.boat||(t=this.boat.getDom()).offset().left+t.width()>$("body").width()&&(e=!1),e}}]),e}(),s=function(){function s(t){r(this,s);var e=t||{},t=e.trackCount,o=void 0===t?8:t,t=e.offsetTop,n=void 0===t?60:t,e=e.boatCount,e=void 0===e?64:e;this.id="nkcBullet".concat(Date.now()).concat(Math.round(1e3*Math.random())),this.setTimeoutId=null,this.bullets=[],this.boats=[],this.boatCount=e,this.tracks=[];for(var i=0;i<o;i++)this.tracks.push(new h({top:n+46*i}))}return i(s,[{key:"add",value:function(t){t=new a(t);this.bullets.push(t),this.setTimeoutId||this.transition()}},{key:"getFreeBoats",value:function(){for(var t=this.tracks.length,e=[],o=0;o<this.boats.length;o++){var n=this.boats[o];if(!n.working&&(e.push(n),t<=e))break}var i=t-e.length;if(0<i)for(var s=this.boatCount-this.boats.length,r=0;r<(s<i?s:i);r++){var a=new u;this.boats.push(a),e.push(a)}return e}},{key:"transition",value:function(){var a=this,u=this,h=this.tracks,f=this.bullets;this.setTimeoutId=setTimeout(function(){for(var t=u.getFreeBoats(),e=0;e<h.length;e++){var o,n,i,s,r=h[e];r.isFree()&&((o=f.shift())&&(n=r.top,i=r.speed,(s=t.pop())&&(s.setInfo(o.info),r=(r.boat=s).getDom(),$(body).append(r),s.setPosition({top:n,speed:i}),s.move())))}f.length?u.transition():a.setTimeoutId=null},300)}}]),s}();NKC.modules.BulletComments=s},{}]},{},[1]);