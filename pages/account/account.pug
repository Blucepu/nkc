extends ../bootstrap_base
block title
  title 个人中心
  +includeCSS("/css/account.css")
block content
  .container-fluid.max-width
    .row
      .col-xs-12.col-md-3.box-shadow-panel
        .account-nav
          .account-user-banner
            a(href=`/banner/${data.user.banner}?t=lg` target="_blank")
              img(src=`/banner/${data.user.banner}`)
          .account-user-avatar
            a(href=`/avatar/${data.user.avatar}?t=lg` target="_blank")
              img(src=`/avatar/${data.user.avatar}`)
          .account-user-name=data.user.username
          .account-user-level
            span.user-grade(style=`color: ${data.user.grade.color};`)
              span= data.user.grade.displayName
              img.grade-icon(src=`/default/v${data.user.grade._id}l.png` title=data.user.grade.displayName)
          .account-user-certs=data.user.info.certsName
          .account-user-description!=markdown_safe(data.user.description)
          .account-user-kcb
            .col-xs-6
              img(src="/statics/kcb.png")
              span=data.user.kcb/100
            .col-xs-6
              img(src="/statics/xsf.png")
              span=data.user.xsf
          .account-user-links
            .account-user-links
              a(href=`/u/${data.user.uid}`).col-xs-6.account-user-link
                .fa.fa-user-circle-o
                | 个人名片
              if state.userColumn
                a(href=`/m/${state.userColumn._id}`).col-xs-6.account-user-link
                  .fa.fa-columns
                  | 我的专栏
              else
                a(href=`/column/apply`).col-xs-6.account-user-link
                  .fa.fa-columns
                  | 开设专栏
              a(href="/message").col-xs-6.account-user-link
                .fa.fa-comments
                | 消息中心
              a(href=`/u/${data.user.uid}/settings`).col-xs-6.account-user-link
                .fa.fa-cog
                | 账号设置
          for navLink in data.navLinks
            .account-ul
              .account-name=navLink.name
              .account-lis
                for link in navLink.links
                  a.account-li(href=link.url class=link.type===data.t?"active":"")
                    .name=link.name
                      span=link.count || ""
                    .fa.fa-angle-right
      .col-xs-12.col-md-7.box-shadow-panel
        if !data.t
          .account-info
            .row
              .col-xs-6.col-md-3
                a(href=`/account/thread` title="点击查看全部文章")
                  .account-info-value=data.user.threadCount
                  .account-info-name 文章
              .col-xs-6.col-md-3
                a(href=`/account/post` title="点击查看回复")
                  .account-info-value=data.user.threadCount
                  .account-info-name 回复
              .col-xs-6.col-md-3
                a(href=`/account/finance` title="点击查看账单")
                  .account-info-value=data.user.kcb/100
                  .account-info-name 科创币
              .col-xs-6.col-md-3
                a
                  .account-info-value=data.user.xsf
                  .account-info-name 学术分
              .col-xs-12.col-md-12
          .account-summary
            include ../user/summary/calendar
          .account-summary
            include ../user/summary/pie
        else if data.t === "thread"
          .account-threads
            include ../publicModules/paging/paging
            for thread in data.threads
              .account-thread
                .account-thread-avatar
                  if thread.firstPost.cover
                    div
                      img(src=tools.getUrl("postCover", thread.firstPost.cover))
                .account-thread-content
                  .account-thread-title
                    a(href=`/t/${thread.tid}`)=thread.firstPost.t
                  .account-thread-abstract=thread.firstPost.abstractCN || thread.firstPost.c
                  .account-thread-info
                    //-.thread-time=format("YYYY/MM/DD HH:mm:ss", thread.toc)
                    .thread-time=`${fromNow(thread.toc)}`
                    if thread.firstPost.voteUp
                      .thread-thumbup
                        .fa.fa-thumbs-up
                        span=thread.firstPost.voteUp
                    if thread.hits
                      .thread-hits
                        .fa.fa-eye
                        span=thread.hits
                    if thread.count - 1
                      .thread-comment
                        .fa.fa-comment
                        span=thread.count - 1
            .m-t-05
              include ../publicModules/paging/paging_input
      .col-xs-12.col-md-2.box-shadow-panel
        div
          p Lorem ipsum dolor sit amet, consectetur adipisicing elit. Aliquam animi assumenda at, consequuntur distinctio, dolorem dolores eligendi ex labore laborum neque, nulla officia perferendis porro quas quod soluta tempora vero?

block scripts
  include ../user/summary/summary
  +includeJS("../user/summary/calendar.js")
  +includeJS("../user/summary/pie.js")
  +includeJS("/js/account.js")