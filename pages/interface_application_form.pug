-let aggregate = 0;
-for(let b of applicationForm.budgetMoney)
  -aggregate += (b.count*b.money)
mixin list(key, value)
  .col-xs-12.col-md-12.aForm-body
    .col-xs-3.col-md-3
      .title= `${key}：`
    .col-xs-9.col-md-9.content
      .title= value
mixin head(value)
  .col-xs-12.col-md-12.aForm-body
    br
    br
    hr
  .col-xs-12.col-md-12.aForm-body
    h3(style='color: #000;')= value
.row
  .aForm
    .col-xs-12.col-md-12.aForm-body
      h2.text-center 申请表预览
      br
      br
      br
    +list('项目名称', applicationForm.project.t)
    +list('基金名称', `${fund.name}`)
    +list('申请金额', `${aggregate}元`)
    +list('申请人ID', applicationForm.applicant.user.username)
    if applicationForm.from === 'team'
      .col-xs-12.col-md-12.aForm-body
        .col-xs-3.col-md-3
          .title= `组员ID：`
        .col-xs-9.col-md-9.content
          .title
            -let names = '';
            -let n = 0;
            -for (let aUser of members)
              if aUser.agree === true
                -const username = aUser.user.username;
                if n === 0
                  -names += username;
                else
                  -names += `, ${username}`;
            .title=`${names || '暂未有组员接受邀请'}`
    +list('申请时间', applicationForm.toc.toLocaleDateString())
    +head('申请人信息')
    +list('真实姓名', applicationForm.applicant.name)
    +list('电话号码', applicationForm.applicant.mobile)
    +list('身份证号码', applicationForm.applicant.idCardNumber)
    -const method = applicationForm.account.paymentMethod === 'alipay'?'支付宝': '微信';
    +list('收款方式', method)
    +list('收款账号', applicationForm.account.number)
    .col-xs-12.col-md-12.aForm-body
      .col-xs-3.col-md-3
        .title= `自我介绍：`
      .col-xs-9.col-md-9
        .row
          p= applicationForm.applicant.description
    .col-xs-12.col-md-12.aForm-body
      .col-xs-3.col-md-3
        .title= `申请人照片：`
      .col-xs-9.col-md-9
        .row
          if applicationForm.applicant.lifePhotos.length === 0
            p 未上传生活照
          else
            -for(let id of applicationForm.applicant.lifePhotos)
              a(href=`/photo/${id}` target='_blank')
                img(src=`/photo_small/${id}` style='width: 50%; padding: 0.5rem')
    +head('项目信息')
    +list('项目名称', applicationForm.project.t)
    .col-xs-12.col-md-12.aForm-body
      .col-xs-3.col-md-3
        .title= `项目内容：`
      .col-xs-9.col-md-9
        .row
          p= applicationForm.project.c
    +head('其他信息')
    +list('研究周期', applicationForm.projectCycle+'（天）')
    .col-xs-12.col-md-12.aForm-body
      .col-xs-3.col-md-3
        .title= `资金用途：`
      .col-xs-9.col-md-9
        .row
          if typeof applicationForm.budgetMoney === 'string'
            p= applicationForm.budgetMoney
          else
            #budgetMoney
              .fund-money-list.head
                .purpose 用途
                .count 数量
                .money 单价(元)
                .total 合计(元)
              -for(let p of budgetMoney)
                -const total = p.count*p.money;
                .fund-money-list
                  .purpose= p.purpose
                  .count= p.count
                  .money= p.money
                  .total= total
            h3=`总计：${aggregate}元`
    .col-xs-12.col-md-12.aForm-body
      .col-xs-3.col-md-3
        .title= `附加帖子：`
      .col-xs-9.col-md-9
        .row
          .selectedThreads
            -for(let i = 0; i < applicationForm.threads.applying.length; i++)
              -const thread = applicationForm.threads.applying[i];
              -const firstPost = thread.firstPost;
              -let postString = {tid: firstPost.tid, uid: firstPost.uid, username: firstPost.user.username, t: firstPost.t, toc: firstPost.toc.toLocaleString(), pid: firstPost.pid};
              -postString = JSON.stringify(postString);
              .threadList
                .col-xs-10.col-md-10
                  .displayNone.postString= postString
                  span 文号：
                  span.threadNumber!= `${firstPost.pid}&nbsp;&nbsp;`
                  a(href=`/m/${firstPost.uid}` target="_blank")= firstPost.user.username
                  span!= `&nbsp;发表于 ${firstPost.toc.toLocaleString()}`
                  br
                  a(href=`/t/${thread.tid}` target="_blank")= firstPost.t


