(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

var data = NKC.methods.getDataById('data');
var usersObj = {};
data.users.map(function (ug) {
  ug.data.map(function (u) {
    return usersObj[u.uid] = u;
  });
});
var app = new Vue({
  el: '#app',
  data: {
    edit: !data.category,
    category: data.category || {
      name: '',
      description: '',
      friendsId: []
    },
    users: data.users,
    usersObj: usersObj
  },
  computed: {
    selectedUsers: function selectedUsers() {
      var arr = [];
      var self = this;
      this.category.friendsId.map(function (uid) {
        var u = self.usersObj[uid];
        if (u) arr.push(u);
      });
      return arr;
    },
    selectedUsersId: function selectedUsersId() {
      var selectedUsers = this.selectedUsers;
      return selectedUsers.map(function (u) {
        return u.uid;
      });
    }
  },
  methods: {
    getUrl: NKC.methods.tools.getUrl,
    selectUser: function selectUser(u) {
      var friendsId = this.category.friendsId;
      var index = friendsId.indexOf(u.uid);

      if (index === -1) {
        friendsId.push(u.uid); // Vue.set(friendsId, friendsId.length, u.uid)
      } else {
        this.unSelectUser(u);
      }
    },
    unSelectUser: function unSelectUser(u) {
      var friendsId = this.category.friendsId;
      var index = friendsId.indexOf(u.uid);

      if (index !== -1) {
        friendsId.splice(index, 1);
      }
    },
    save: function save() {
      var self = this;
      var _self$category = self.category,
          _id = _self$category._id,
          name = _self$category.name,
          description = _self$category.description;
      var method, url;

      if (_id) {
        method = 'PATCH';
        url = "/friend_category/".concat(_id);
      } else {
        method = 'POST';
        url = "/friend_category";
      }

      return nkcAPI(url, method, {
        name: name,
        description: description,
        friendsId: self.selectedUsersId
      }).then(function (data) {
        self.edit = false;
        NKC.methods.appToast('保存成功');

        if (!_id) {
          NKC.methods.visitUrl("/message/category?cid=".concat(data.category._id));
        }
      })["catch"](NKC.methods.appToast);
    },
    visitUserHome: function visitUserHome(u) {
      NKC.methods.visitUrl(NKC.methods.tools.getUrl('messageUserDetail', u.uid), true);
    },
    toEdit: function toEdit() {
      this.edit = true;
    },
    remove: function remove() {
      var self = this;
      sweetQuestion("\u5220\u9664\u5206\u7EC4\u300C".concat(this.category.name, "\u300D\uFF1F")).then(function () {
        return nkcAPI("/friend_category/".concat(self.category._id), 'DELETE').then(function () {
          NKC.methods.appToast('删除成功');
          NKC.methods.appClosePage();
        })["catch"](NKC.methods.appToast);
      });
    }
  }
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9fYnJvd3Nlci1wYWNrQDYuMS4wQGJyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsInBhZ2VzL21lc3NhZ2UvYXBwQ2F0ZWdvcnkvYXBwQ2F0ZWdvcnkubWpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxJQUFNLElBQUksR0FBRyxHQUFHLENBQUMsT0FBSixDQUFZLFdBQVosQ0FBd0IsTUFBeEIsQ0FBYjtBQUNBLElBQU0sUUFBUSxHQUFHLEVBQWpCO0FBQ0EsSUFBSSxDQUFDLEtBQUwsQ0FBVyxHQUFYLENBQWUsVUFBQSxFQUFFLEVBQUk7QUFDbkIsRUFBQSxFQUFFLENBQUMsSUFBSCxDQUFRLEdBQVIsQ0FBWSxVQUFBLENBQUM7QUFBQSxXQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBSCxDQUFSLEdBQWtCLENBQXRCO0FBQUEsR0FBYjtBQUNELENBRkQ7QUFHQSxJQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUosQ0FBUTtBQUNsQixFQUFBLEVBQUUsRUFBRSxNQURjO0FBRWxCLEVBQUEsSUFBSSxFQUFFO0FBQ0osSUFBQSxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsUUFEUjtBQUVKLElBQUEsUUFBUSxFQUFFLElBQUksQ0FBQyxRQUFMLElBQWlCO0FBQ3pCLE1BQUEsSUFBSSxFQUFFLEVBRG1CO0FBRXpCLE1BQUEsV0FBVyxFQUFFLEVBRlk7QUFHekIsTUFBQSxTQUFTLEVBQUU7QUFIYyxLQUZ2QjtBQU9KLElBQUEsS0FBSyxFQUFFLElBQUksQ0FBQyxLQVBSO0FBUUosSUFBQSxRQUFRLEVBQVI7QUFSSSxHQUZZO0FBWWxCLEVBQUEsUUFBUSxFQUFFO0FBQ1IsSUFBQSxhQURRLDJCQUNRO0FBQ2QsVUFBTSxHQUFHLEdBQUcsRUFBWjtBQUNBLFVBQU0sSUFBSSxHQUFHLElBQWI7QUFDQSxXQUFLLFFBQUwsQ0FBYyxTQUFkLENBQXdCLEdBQXhCLENBQTRCLFVBQUEsR0FBRyxFQUFJO0FBQ2pDLFlBQU0sQ0FBQyxH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RTtBQUNQLFdBQUssSUFBTCxHQUFZLElBQVo7QUFDRCxLQWpETTtBQWtEUCxJQUFBLE1BbERPLG9CQWtERTtBQUNQLFVBQU0sSUFBSSxHQUFHLElBQWI7QUFDQSxNQUFBLGFBQWEseUNBQVMsS0FBSyxRQUFMLENBQWMsSUFBdkIsa0JBQWIsQ0FDRyxJQURILENBQ1EsWUFBTTtBQUNWLGVBQU8sTUFBTSw0QkFBcUIsSUFBSSxDQUFDLFFBQUwsQ0FBYyxHQUFuQyxHQUEwQyxRQUExQyxDQUFOLENBQ0osSUFESSxDQUNDLFlBQU07QUFDVixVQUFBLEdBQUcsQ0FBQyxPQUFKLENBQVksUUFBWixDQUFxQixNQUFyQjtBQUNBLFVBQUEsR0FBRyxDQUFDLE9BQUosQ0FBWSxZQUFaO0FBQ0QsU0FKSSxXQUtFLEdBQUcsQ0FBQyxPQUFKLENBQVksUUFMZCxDQUFQO0FBTUQsT0FSSDtBQVNEO0FBN0RNO0FBM0JTLENBQVIsQ0FBWiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImNvbnN0IGRhdGEgPSBOS0MubWV0aG9kcy5nZXREYXRhQnlJZCgnZGF0YScpO1xyXG5jb25zdCB1c2Vyc09iaiA9IHt9O1xyXG5kYXRhLnVzZXJzLm1hcCh1ZyA9PiB7XHJcbiAgdWcuZGF0YS5tYXAodSA9PiB1c2Vyc09ialt1LnVpZF0gPSB1KTtcclxufSk7XHJcbmNvbnN0IGFwcCA9IG5ldyBWdWUoe1xyXG4gIGVsOiAnI2FwcCcsXHJcbiAgZGF0YToge1xyXG4gICAgZWRpdDogIWRhdGEuY2F0ZWdvcnksXHJcbiAgICBjYXRlZ29yeTogZGF0YS5jYXRlZ29yeSB8fCB7XHJcbiAgICAgIG5hbWU6ICcnLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJycsXHJcbiAgICAgIGZyaWVuZHNJZDogW10sXHJcbiAgICB9LFxyXG4gICAgdXNlcnM6IGRhdGEudXNlcnMsXHJcbiAgICB1c2Vyc09iaixcclxuICB9LFxyXG4gIGNvbXB1dGVkOiB7XHJcbiAgICBzZWxlY3RlZFVzZXJzKCkge1xyXG4gICAgICBjb25zdCBhcnIgPSBbXTtcclxuICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XHJcbiAgICAgIHRoaXMuY2F0ZWdvcnkuZnJpZW5kc0lkLm1hcCh1aWQgPT4ge1xyXG4gICAgICAgIGNvbnN0IHUgPSBzZWxmLnVzZXJzT2JqW3VpZF07XHJcbiAgICAgICAgaWYodSkgYXJyLnB1c2godSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gYXJyO1xyXG4gICAgfSxcclxuICAgIHNlbGVjdGVkVXNlcnNJZCgpIHtcclxuICAgICAgY29uc3Qge3NlbGVjdGVkVXNlcnN9ID0gdGhpcztcclxuICAgICAgcmV0dXJuIHNlbGVjdGVkVXNlcnMubWFwKHUgPT4gdS51aWQpO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgbWV0aG9kczoge1xyXG4gICAgZ2V0VXJsOiBOS0MubWV0aG9kcy50b29scy5nZXRVcmwsXHJcbiAgICBzZWxlY3RVc2VyKHUpIHtcclxuICAgICAgY29uc3QgZnJpZW5kc0lkID0gdGhpcy5jYXRlZ29yeS5mcmllbmRzSWQ7XHJcbiAgICAgIGNvbnN0IGluZGV4ID0gZnJpZW5kc0lkLmluZGV4T2YodS51aWQpO1xyXG4gICAgICBpZihpbmRleCA9PT0gLTEpIHtcclxuICAgICAgICBmcmllbmRzSWQucHVzaCh1LnVpZCk7XHJcbiAgICAgICAgLy8gVnVlLnNldChmcmllbmRzSWQsIGZyaWVuZHNJZC5sZW5ndGgsIHUudWlkKVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMudW5TZWxlY3RVc2VyKHUpO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgdW5TZWxlY3RVc2VyKHUpIHtcclxuICAgICAgY29uc3QgZnJpZW5kc0lkID0gdGhpcy5jYXRlZ29yeS5mcmllbmRzSWQ7XHJcbiAgICAgIGNvbnN0IGluZGV4ID0gZnJpZW5kc0lkLmluZGV4T2YodS51aWQpO1xyXG4gICAgICBpZihpbmRleCAhPT0gLTEpIHtcclxuICAgICAgICBmcmllbmRzSWQuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNhdmUoKSB7XHJcbiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICBjb25zdCB7X2lkLCBuYW1lLCBkZXNjcmlwdGlvbn0gPSBzZWxmLmNhdGVnb3J5O1xyXG4gICAgICBsZXQgbWV0aG9kLCB1cmw7XHJcbiAgICAgIGlmKF9pZCkge1xyXG4gICAgICAgIG1ldGhvZCA9ICdQQVRDSCc7XHJcbiAgICAgICAgdXJsID0gYC9mcmllbmRfY2F0ZWdvcnkvJHtfaWR9YDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBtZXRob2QgPSAnUE9TVCc7XHJcbiAgICAgICAgdXJsID0gYC9mcmllbmRfY2F0ZWdvcnlgO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBua2NBUEkodXJsLCBtZXRob2QsIHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uLFxyXG4gICAgICAgIGZyaWVuZHNJZDogc2VsZi5zZWxlY3RlZFVzZXJzSWRcclxuICAgICAgfSlcclxuICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgc2VsZi5lZGl0ID0gZmFsc2U7XHJcbiAgICAgICAgICBOS0MubWV0aG9kcy5hcHBUb2FzdCgn5L+d5a2Y5oiQ5YqfJyk7XHJcbiAgICAgICAgICBpZighX2lkKSB7XHJcbiAgICAgICAgICAgIE5LQy5tZXRob2RzLnZpc2l0VXJsKGAvbWVzc2FnZS9jYXRlZ29yeT9jaWQ9JHtkYXRhLmNhdGVnb3J5Ll9pZH1gKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChOS0MubWV0aG9kcy5hcHBUb2FzdCk7XHJcbiAgICB9LFxyXG4gICAgdmlzaXRVc2VySG9tZSh1KSB7XHJcbiAgICAgIE5LQy5tZXRob2RzLnZpc2l0VXJsKE5LQy5tZXRob2RzLnRvb2xzLmdldFVybCgnbWVzc2FnZVVzZXJEZXRhaWwnLCB1LnVpZCksIHRydWUpO1xyXG4gICAgfSxcclxuICAgIHRvRWRpdCgpIHtcclxuICAgICAgdGhpcy5lZGl0ID0gdHJ1ZTtcclxuICAgIH0sXHJcbiAgICByZW1vdmUoKSB7XHJcbiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICBzd2VldFF1ZXN0aW9uKGDliKDpmaTliIbnu4TjgIwke3RoaXMuY2F0ZWdvcnkubmFtZX3jgI3vvJ9gKVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgIHJldHVybiBua2NBUEkoYC9mcmllbmRfY2F0ZWdvcnkvJHtzZWxmLmNhdGVnb3J5Ll9pZH1gLCAnREVMRVRFJylcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgIE5LQy5tZXRob2RzLmFwcFRvYXN0KCfliKDpmaTmiJDlip8nKTtcclxuICAgICAgICAgICAgICBOS0MubWV0aG9kcy5hcHBDbG9zZVBhZ2UoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKE5LQy5tZXRob2RzLmFwcFRvYXN0KTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxufSlcclxuIl19
