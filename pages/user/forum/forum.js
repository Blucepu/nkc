(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

var data = NKC.methods.getDataById("data");
var stepCheckerMap = new Map([["protocol", // 开办指南
function (_ref) {
  var protocol = _ref.protocol;
  return protocol.haveReadProtocol ? {
    passed: true
  } : {
    passed: false,
    message: "请先仔细阅读开办指南"
  };
}], ["enter_info", // 录入信息
function (_ref2) {
  var enterInfo = _ref2.enterInfo;
  return enterInfo.newForumName && enterInfo.reason && enterInfo.youWantToDo ? {
    passed: true
  } : {
    passed: false,
    message: "请先完整填写"
  };
}], ["send_invite", // 发送邀请
function (vm) {
  var sendInvite = vm.sendInvite;

  if (sendInvite.userId.length < 3) {
    return {
      passed: false,
      message: "至少选择3个人"
    };
  } else {
    vm.commitData();
    return {
      passed: true
    };
  }
}], ["sucess_section", // 提交成功提示
function (vm) {}]]);
var stepNames = Array.from(stepCheckerMap.keys());
new Vue({
  el: "#app",
  data: {
    step: 0,
    protocol: {
      haveReadProtocol: false
    },
    enterInfo: {
      newForumName: "",
      reason: "",
      youWantToDo: ""
    },
    sendInvite: {
      userId: [],
      users: []
    },
    process: true,
    myPForums: data.myPForums,
    reviewNewForumGuide: data.reviewNewForumGuide
  },
  computed: {
    stepName: function stepName() {
      return stepNames[this.step] || stepNames[0];
    }
  },
  methods: {
    toStep: function toStep(index) {
      var checker = this.checker,
          stepName = this.stepName;

      var _checker = checker(stepName),
          passed = _checker.passed,
          message = _checker.message;

      return passed ? this.step = index : sweetError(message);
    },
    checker: function checker(stepName) {
      var vm = this;

      if (stepCheckerMap.has(stepName)) {
        var stepChecker = stepCheckerMap.get(stepName);
        return typeof stepChecker === "function" ? stepChecker(vm) : {};
      }

      return {};
    },
    selectUsers: function selectUsers() {
      var self = this;
      selectUserModule.open(function (_ref3) {
        var usersId = _ref3.usersId;
        usersId.map(function (uid) {
          if (self.sendInvite.userId.indexOf(uid) >= 0) return;
          nkcAPI("/u/" + uid, "GET").then(function (data) {
            var user = data.targetUser;
            var uid = user.uid;
            var username = user.username || "未知";
            var avatarUrl;

            if (user.avatar) {
              avatarUrl = "/a/".concat(user.avatar, "?c=userAvatar&t=sm");
            } else {}

            avatarUrl = "/a/default?c=userAvatar&t=sm";
            self.sendInvite.users.push({
              username: username,
              avatarUrl: avatarUrl,
              uid: uid
            });
            self.sendInvite.userId.push(uid);
          })["catch"](sweetError);
        });
      }, {
        userCount: 99
      });
    },
    deleteFounder: function deleteFounder(index) {
      this.sendInvite.users.splice(index, 1);
      this.sendInvite.userId.splice(index, 1);
    },
    commitData: function commitData() {
      var enterInfo = this.enterInfo,
          sendInvite = this.sendInvite;
      var self = this;
      return nkcAPI("/u/".concat(NKC.configs.uid, "/forum"), "POST", {
        info: enterInfo,
        invites: sendInvite.userId
      }).then(function () {
        console.log("提交成功");
        self.process = false;
      })["catch"](sweetError);
    }
  }
}); // 选择用户组件

var selectUserModule = new NKC.modules.SelectUser();

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwYWdlcy91c2VyL2ZvcnVtL2ZvcnVtLm1qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUEsSUFBSSxJQUFJLEdBQUcsR0FBRyxDQUFDLE9BQUosQ0FBWSxXQUFaLENBQXdCLE1BQXhCLENBQVg7QUFFQSxJQUFNLGNBQWMsR0FBRyxJQUFJLEdBQUosQ0FBUSxDQUM3QixDQUFDLFVBQUQsRUFBZ0I7QUFDZCxnQkFBdUI7QUFBQSxNQUFaLFFBQVksUUFBWixRQUFZO0FBQ3JCLFNBQU8sUUFBUSxDQUFDLGdCQUFULEdBQ0g7QUFBQyxJQUFBLE1BQU0sRUFBQztBQUFSLEdBREcsR0FFSDtBQUFDLElBQUEsTUFBTSxFQUFDLEtBQVI7QUFBZSxJQUFBLE9BQU8sRUFBRTtBQUF4QixHQUZKO0FBR0QsQ0FMSCxDQUQ2QixFQVE3QixDQUFDLFlBQUQsRUFBaUI7QUFDZixpQkFBd0I7QUFBQSxNQUFiLFNBQWEsU0FBYixTQUFhO0FBQ3RCLFNBQU8sU0FBUyxDQUFDLFlBQVYsSUFBMEIsU0FBUyxDQUFDLE1BQXBDLElBQThDLFNBQVMsQ0FBQyxXQUF4RCxHQUNIO0FBQUMsSUFBQSxNQUFNLEVBQUU7QUFBVCxHQURHLEdBRUg7QUFBQyxJQUFBLE1BQU0sRUFBRSxLQUFUO0FBQWdCLElBQUEsT0FBTyxFQUFFO0FBQXpCLEdBRko7QUFHRCxDQUxILENBUjZCLEVBZTdCLENBQUMsYUFBRCxFQUFpQjtBQUNmLFVBQVMsRUFBVCxFQUFhO0FBQ1gsTUFBSSxVQUFVLEdBQUcsRUFBRSxDQUFDLFVBQXBCOztBQUNBLE1BQUcsVUFBVSxDQUFDLE1BQVgsQ0FBa0IsTUFBbEIsR0FBMkIsQ0FBOUIsRUFBaUM7QUFDL0IsV0FBTztBQUFDLE1BQUEsTUFBTSxFQUFFLEtBQVQ7QUFBZ0IsTUFBQSxPQUFPLEVBQUU7QUFBekIsS0FBUDtBQUNELEdBRkQsTUFFTztBQUNMLElBQUEsRUFBRSxDQUFDLFVB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QUFNRDtBQXJETTtBQXpCSCxDQUFSLEUsQ0FtRkE7O0FBQ0EsSUFBTSxnQkFBZ0IsR0FBRyxJQUFJLEdBQUcsQ0FBQyxPQUFKLENBQVksVUFBaEIsRUFBekIiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJsZXQgZGF0YSA9IE5LQy5tZXRob2RzLmdldERhdGFCeUlkKFwiZGF0YVwiKTtcclxuXHJcbmNvbnN0IHN0ZXBDaGVja2VyTWFwID0gbmV3IE1hcChbXHJcbiAgW1wicHJvdG9jb2xcIiwgICAgLy8g5byA5Yqe5oyH5Y2XXHJcbiAgICBmdW5jdGlvbih7IHByb3RvY29sIH0pIHtcclxuICAgICAgcmV0dXJuIHByb3RvY29sLmhhdmVSZWFkUHJvdG9jb2xcclxuICAgICAgICA/IHtwYXNzZWQ6dHJ1ZX1cclxuICAgICAgICA6IHtwYXNzZWQ6ZmFsc2UsIG1lc3NhZ2U6IFwi6K+35YWI5LuU57uG6ZiF6K+75byA5Yqe5oyH5Y2XXCJ9XHJcbiAgICB9XHJcbiAgXSxcclxuICBbXCJlbnRlcl9pbmZvXCIsICAgLy8g5b2V5YWl5L+h5oGvXHJcbiAgICBmdW5jdGlvbih7IGVudGVySW5mbyB9KSB7XHJcbiAgICAgIHJldHVybiBlbnRlckluZm8ubmV3Rm9ydW1OYW1lICYmIGVudGVySW5mby5yZWFzb24gJiYgZW50ZXJJbmZvLnlvdVdhbnRUb0RvXHJcbiAgICAgICAgPyB7cGFzc2VkOiB0cnVlfVxyXG4gICAgICAgIDoge3Bhc3NlZDogZmFsc2UsIG1lc3NhZ2U6IFwi6K+35YWI5a6M5pW05aGr5YaZXCJ9XHJcbiAgICB9XHJcbiAgXSxcclxuICBbXCJzZW5kX2ludml0ZVwiLCAgLy8g5Y+R6YCB6YKA6K+3XHJcbiAgICBmdW5jdGlvbih2bSkge1xyXG4gICAgICBsZXQgc2VuZEludml0ZSA9IHZtLnNlbmRJbnZpdGU7XHJcbiAgICAgIGlmKHNlbmRJbnZpdGUudXNlcklkLmxlbmd0aCA8IDMpIHtcclxuICAgICAgICByZXR1cm4ge3Bhc3NlZDogZmFsc2UsIG1lc3NhZ2U6IFwi6Iez5bCR6YCJ5oupM+S4quS6ulwifVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZtLmNvbW1pdERhdGEoKTtcclxuICAgICAgICByZXR1cm4ge3Bhc3NlZDogdHJ1ZX1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIF0sXHJcbiAgW1wic3VjZXNzX3NlY3Rpb25cIiwgIC8vIOaPkOS6pOaIkOWKn+aPkOekulxyXG4gICAgZnVuY3Rpb24odm0pIHtcclxuICAgICAgXHJcbiAgICB9XHJcbiAgXVxyXG5dKVxyXG5cclxuY29uc3Qgc3RlcE5hbWVzID0gQXJyYXkuZnJvbShzdGVwQ2hlY2tlck1hcC5rZXlzKCkpO1xyXG5cclxubmV3IFZ1ZSh7XHJcbiAgZWw6IFwiI2FwcFwiLFxyXG4gIGRhdGE6IHtcclxuICAgIHN0ZXA6IDAsXHJcbiAgICBwcm90b2NvbDoge1xyXG4gICAgICBoYXZlUmVhZFByb3RvY29sOiBmYWxzZSxcclxuICAgIH0sXHJcbiAgICBlbnRlckluZm86IHtcclxuICAgICAgbmV3Rm9ydW1OYW1lOiBcIlwiLFxyXG4gICAgICByZWFzb246IFwiXCIsXHJcbiAgICAgIHlvdVdhbnRUb0RvOiBcIlwiXHJcbiAgICB9LFxyXG4gICAgc2VuZEludml0ZToge1xyXG4gICAgICB1c2VySWQ6IFtdLFxyXG4gICAgICB1c2VyczogW11cclxuICAgIH0sXHJcbiAgICBwcm9jZXNzOiB0cnVlLFxyXG4gICAgbXlQRm9ydW1zOiBkYXRhLm15UEZvcnVtcyxcclxuICAgIHJldmlld05ld0ZvcnVtR3VpZGU6IGRhdGEucmV2aWV3TmV3Rm9ydW1HdWlkZVxyXG4gIH0sXHJcbiAgY29tcHV0ZWQ6IHtcclxuICAgIHN0ZXBOYW1lKCkge1xyXG4gICAgICByZXR1cm4gc3RlcE5hbWVzW3RoaXMuc3RlcF0gfHwgc3RlcE5hbWVzWzBdO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgbWV0aG9kczoge1xyXG4gICAgdG9TdGVwKGluZGV4KSB7XHJcbiAgICAgIGxldCB7IGNoZWNrZXIsIHN0ZXBOYW1lIH0gPSB0aGlzO1xyXG4gICAgICBsZXQgeyBwYXNzZWQsIG1lc3NhZ2UgfSA9IGNoZWNrZXIoc3RlcE5hbWUpO1xyXG4gICAgICByZXR1cm4gcGFzc2VkXHJcbiAgICAgICAgPyB0aGlzLnN0ZXAgPSBpbmRleFxyXG4gICAgICAgIDogc3dlZXRFcnJvcihtZXNzYWdlKTtcclxuICAgIH0sXHJcbiAgICBjaGVja2VyKHN0ZXBOYW1lKSB7XHJcbiAgICAgIGxldCB2bSA9IHRoaXM7XHJcbiAgICAgIGlmKHN0ZXBDaGVja2VyTWFwLmhhcyhzdGVwTmFtZSkpIHtcclxuICAgICAgICBsZXQgc3RlcENoZWNrZXIgPSBzdGVwQ2hlY2tlck1hcC5nZXQoc3RlcE5hbWUpO1xyXG4gICAgICAgIHJldHVybiB0eXBlb2Ygc3RlcENoZWNrZXIgPT09IFwiZnVuY3Rpb25cIlxyXG4gICAgICAgICAgPyBzdGVwQ2hlY2tlcih2bSlcclxuICAgICAgICAgIDoge31cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4ge307XHJcbiAgICB9LFxyXG4gICAgc2VsZWN0VXNlcnMoKSB7XHJcbiAgICAgIGxldCBzZWxmID0gdGhpcztcclxuICAgICAgc2VsZWN0VXNlck1vZHVsZS5vcGVuKCh7dXNlcnNJZH0pID0+IHtcclxuICAgICAgICB1c2Vyc0lkLm1hcCh1aWQgPT4ge1xyXG4gICAgICAgICAgaWYoc2VsZi5zZW5kSW52aXRlLnVzZXJJZC5pbmRleE9mKHVpZCkgPj0gMCkgcmV0dXJuO1xyXG4gICAgICAgICAgbmtjQVBJKFwiL3UvXCIgKyB1aWQsIFwiR0VUXCIpXHJcbiAgICAgICAgICAgIC50aGVuKGRhdGEgPT4ge1xyXG4gICAgICAgICAgICAgIGxldCB1c2VyID0gZGF0YS50YXJnZXRVc2VyO1xyXG4gICAgICAgICAgICAgIGxldCB1aWQgPSB1c2VyLnVpZDtcclxuICAgICAgICAgICAgICBsZXQgdXNlcm5hbWUgPSB1c2VyLnVzZXJuYW1lIHx8IFwi5pyq55+lXCI7XHJcbiAgICAgICAgICAgICAgbGV0IGF2YXRhclVybDtcclxuICAgICAgICAgICAgICBpZih1c2VyLmF2YXRhcikge1xyXG4gICAgICAgICAgICAgICAgYXZhdGFyVXJsID0gYC9hLyR7dXNlci5hdmF0YXJ9P2M9dXNlckF2YXRhciZ0PXNtYDtcclxuICAgICAgICAgICAgICB9IGVsc2Uge31cclxuICAgICAgICAgICAgICAgIGF2YXRhclVybCA9IGAvYS9kZWZhdWx0P2M9dXNlckF2YXRhciZ0PXNtYFxyXG4gICAgICAgICAgICAgIHNlbGYuc2VuZEludml0ZS51c2Vycy5wdXNoKHt1c2VybmFtZSwgYXZhdGFyVXJsLCB1aWR9KTtcclxuICAgICAgICAgICAgICBzZWxmLnNlbmRJbnZpdGUudXNlcklkLnB1c2godWlkKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKHN3ZWV0RXJyb3IpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0sIHt1c2VyQ291bnQ6IDk5fSlcclxuICAgIH0sXHJcbiAgICBkZWxldGVGb3VuZGVyKGluZGV4KSB7XHJcbiAgICAgIHRoaXMuc2VuZEludml0ZS51c2Vycy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICB0aGlzLnNlbmRJbnZpdGUudXNlcklkLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICB9LFxyXG4gICAgY29tbWl0RGF0YSgpIHtcclxuICAgICAgbGV0IHsgZW50ZXJJbmZvLCBzZW5kSW52aXRlIH0gPSB0aGlzO1xyXG4gICAgICBsZXQgc2VsZiA9IHRoaXM7XHJcbiAgICAgIHJldHVybiBua2NBUEkoYC91LyR7TktDLmNvbmZpZ3MudWlkfS9mb3J1bWAsIFwiUE9TVFwiLCB7aW5mbzogZW50ZXJJbmZvLCBpbnZpdGVzOiBzZW5kSW52aXRlLnVzZXJJZH0pXHJcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coXCLmj5DkuqTmiJDlip9cIik7XHJcbiAgICAgICAgICBzZWxmLnByb2Nlc3MgPSBmYWxzZTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChzd2VldEVycm9yKTtcclxuICAgIH1cclxuICB9XHJcbn0pXHJcblxyXG5cclxuLy8g6YCJ5oup55So5oi357uE5Lu2XHJcbmNvbnN0IHNlbGVjdFVzZXJNb2R1bGUgPSBuZXcgTktDLm1vZHVsZXMuU2VsZWN0VXNlcigpOyJdfQ==
