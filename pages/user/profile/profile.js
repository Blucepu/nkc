!function s(r,i,o){function u(t,e){if(!i[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},r[t][0].call(n.exports,function(e){return u(r[t][1][e]||e)},n,n.exports,s,r,i,o)}return i[t].exports}for(var c="function"==typeof require&&require,e=0;e<o.length;e++)u(o[e]);return u}({1:[function(e,t,n){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}window.draft=new(function(){function e(){s(this,e)}return i(e,[{key:"removeDraft",value:function(e){nkcAPI("/u/"+NKC.configs.uid+"/drafts/"+e,"DELETE").then(function(){window.location.reload()}).catch(function(e){sweetError(e)})}},{key:"removeDraftSingle",value:function(e){var t=this;sweetQuestion("确定要删除当前草稿？删除后不可恢复。").then(function(){t.removeDraft(e)}).catch(function(){})}},{key:"removeAll",value:function(){var e=this;sweetQuestion("确定要删除全部草稿？删除后不可恢复。").then(function(){e.removeDraft("all")}).catch(function(){})}},{key:"getInputs",value:function(){return $(".draft-checkbox input")}},{key:"getSelectedDraftsId",value:function(){for(var e=[],t=this.getInputs(),n=0;n<t.length;n++){var s=t.eq(n);s.prop("checked")&&e.push(s.attr("data-did"))}return e}},{key:"selectAll",value:function(){var e=this.getSelectedDraftsId(),t=this.getInputs();e.length!==t.length?t.prop("checked",!0):t.prop("checked",!1)}},{key:"removeSelectedDrafts",value:function(){var e,t=this.getSelectedDraftsId(),n=this;t.length&&(e=t.join("-"),sweetQuestion("确定要删除已勾选的草稿？删除后不可恢复。").then(function(){n.removeDraft(e)}).catch(function(){}))}}]),e}());var o=NKC.methods.getDataById("subUsersId");window.SubscribeTypes||(window.SubscribeTypes=new NKC.modules.SubscribeTypes),window.user=new(function(){function e(){s(this,e),this.subUsersId=o.subUsersId,this.subForumsId=o.subForumsId,this.subColumnsId=o.subColumnsId,this.subThreadsId=o.subThreadsId,this.collectionThreadsId=o.collectionThreadsId,this.subscribes=o.subscribes}return i(e,[{key:"moveSub",value:function(e){this.moveSubs([e])}},{key:"moveSubs",value:function(e){var n=0<arguments.length&&void 0!==e?e:[],s=[],t=this;n.map(function(e){e=t.subscribes[e];e&&s.push(e)});e=[];if(1===s.length)e=s[0].cid;else if(0===s.length)return;n=s.map(function(e){return e._id}),SubscribeTypes.open(function(t){nkcAPI("/account/subscribes","PUT",{type:"modifyType",typesId:t,subscribesId:n}).then(function(){SubscribeTypes.close(),s.map(function(e){e.cid=t}),sweetSuccess("执行成功")}).catch(function(e){sweetError(e)})},{selectedTypesId:e,hideInfo:!0,selectTypesWhenSubscribe:!0})}},{key:"subscribe",value:function(t,n){var s,r,i=$(".account-follower-buttons[data-".concat(n,"='").concat(t,"']"));"user"===n?(s=this.subUsersId,r=SubscribeTypes.subscribeUserPromise):"forum"===n?(s=this.subForumsId,r=SubscribeTypes.subscribeForumPromise):"column"===n?(s=this.subColumnsId,t=Number(t),r=SubscribeTypes.subscribeColumnPromise):"thread"===n?(s=this.subThreadsId,r=SubscribeTypes.subscribeThreadPromise):"collection"===n&&(s=this.collectionThreadsId,r=SubscribeTypes.collectionThreadPromise);var o=!s.includes(t);new Promise(function(t,e){["user","collection","thread"].includes(n)&&o?SubscribeTypes.open(function(e){t(e)}):t()}).then(function(e){return e?r(t,o,e):r(t,o)}).then(function(){var e;SubscribeTypes.close(),o?("collection"===n?sweetSuccess("收藏成功"):sweetSuccess("关注成功"),i.addClass("active"),-1===s.indexOf(t)&&s.push(t)):("collection"===n?sweetSuccess("收藏已取消"):sweetSuccess("关注已取消"),i.removeClass("active"),-1!==(e=s.indexOf(t))&&s.splice(e,1))}).catch(sweetError)}},{key:"editType",value:function(){SubscribeTypes.open(function(){},{editType:!0})}}]),e}()),window.removeBlacklist=function(e,t){NKC.methods.removeUserFromBlacklist(e).then(function(e){!e||(e=$('[data-type="blacklist"][data-id="'.concat(t,'"]')))&&e.length&&e.remove()})},NKC.configs.isApp&&window.ready().then(function(){newEvent("userChanged",function(e){e.user&&(window.location.href=window.location.pathname.replace(/\/u\/([0-9]+\/)/gi,"/u/"+e.user.uid+"/"))})})},{}]},{},[1]);