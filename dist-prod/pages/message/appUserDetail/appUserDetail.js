!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e=NKC.methods.getDataById("data");e.friend&&(e.friend.info._phone=e.friend.info.phone.map((function(e){return{number:e}})),e.friend.info._phone.length||(e.friend.info._phone=[{number:""}])),window.app=new Vue({el:"#app",data:{friend:e.friend,fc:e.friendCategories,targetUser:e.targetUser,targetUserName:e.targetUserName,inBlacklist:e.inBlacklist,friendImageUrl:"",showNote:!1},methods:{visitUserHome:function(){NKC.methods.visitUrl("/u/".concat(this.targetUser.uid),!0)},_removeFriend:function(){var e=this.targetUser.uid;return nkcAPI("/friend/"+e,"DELETE",{})},addFriend:function(e){var t=this._removeFriend;e?sweetQuestion("确定要删除该好友？").then((function(){return t()})).then((function(){NKC.methods.appToast("删除成功"),NKC.methods.appReloadPage()})).catch(NKC.methods.appToast):NKC.methods.visitUrl("/message/addFriend?uid=".concat(this.targetUser.uid),!0)},moveToBlacklist:function(){var e=this.targetUser.uid,t=this.inBlacklist;this.friend,this._removeFriend,Promise.resolve().then((function(){})).then((function(){return t?NKC.methods.removeUserFromBlacklist(e):NKC.methods.addUserToBlacklist(e,"message")})).then((function(e){e&&NKC.methods.appReloadPage()})).catch(NKC.methods.appToast)},sendToUser:function(){var e=this.targetUser.uid,t=this.targetUserName;NKC.methods.rn.emit("toChat",{uid:e,type:"UTU",username:t})},selectLocation:function(){var e=this;NKC.methods.appSelectLocation().then((function(t){e.friend.info.location=t.location.join("  ")}))},addPhone:function(){this.friend.info._phone.push({number:""})},removePhone:function(e){this.friend.info._phone.splice(e,1)},setFriendImageUrl:function(){this.friendImageUrl="/friend/".concat(this.targetUser.uid,"/image?t=").concat(Date.now())},selectFriendImage:function(){this.$refs.input.value=null,this.$refs.input.click()},removeFriendImage:function(){this.friend.info.image=!1},selectedFriendImage:function(){var e=this,t=this.$refs.input.files;if(t.length){var n=t[0],i=new FormData;i.append("file",n),NKC.methods.appToast("上传中，请稍候"),nkcUploadFile("/friend/".concat(e.targetUser.uid,"/image"),"POST",i).then((function(){NKC.methods.appToast("上传成功"),e.setFriendImageUrl(),e.friend.info.image=!0})).catch(NKC.methods.appToast)}},switchNote:function(){this.showNote=!this.showNote},saveFriendInfo:function(){var e=this.friend,t=this.targetUser;e.info.phone=e.info._phone.map((function(e){return e.number})),nkcAPI("/message/settings/".concat(t.uid),"PUT",{info:e.info,cid:e.cid}).then((function(){NKC.methods.appToast("保存成功")})).catch(NKC.methods.appToast)}},mounted:function(){this.setFriendImageUrl()}})}));
