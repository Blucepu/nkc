!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e}).apply(this,arguments)}var t=NKC.methods.getDataById("data"),n={};t.users.map((function(e){e.data.map((function(e){return n[e.uid]=e}))}));var s=new Vue({el:"#app",data:{edit:!t.category,category:t.category||{name:"",description:"",friendsId:[]},users:t.users,usersObj:n},computed:{selectedUsers:function(){var e=[],t=this;return this.category.friendsId.map((function(n){var s=t.usersObj[n];s&&e.push(s)})),e},selectedUsersId:function(){return this.selectedUsers.map((function(e){return e.uid}))}},methods:{getUrl:NKC.methods.tools.getUrl,selectUser:function(e){var t=this.category.friendsId;-1===t.indexOf(e.uid)?t.push(e.uid):this.unSelectUser(e)},unSelectUser:function(e){var t=this.category.friendsId,n=t.indexOf(e.uid);-1!==n&&t.splice(n,1)},save:function(){var e,t,n=this,s=n.category,r=s._id,i=s.name,o=s.description;return r?(e="PUT",t="/friend_category/".concat(r)):(e="POST",t="/friend_category"),nkcAPI(t,e,{name:i,description:o,friendsId:n.selectedUsersId}).then((function(e){n.edit=!1,NKC.methods.appToast("保存成功"),r||NKC.methods.visitUrl("/message/category?cid=".concat(e.category._id))})).catch(NKC.methods.appToast)},visitUserHome:function(e){NKC.methods.visitUrl(NKC.methods.tools.getUrl("messageUserDetail",e.uid),!0)},toEdit:function(){this.edit=!0},remove:function(){var e=this;sweetQuestion("删除分组「".concat(this.category.name,"」？")).then((function(){return nkcAPI("/friend_category/".concat(e.category._id),"DELETE").then((function(){NKC.methods.appToast("删除成功"),NKC.methods.appClosePage()})).catch(NKC.methods.appToast)}))}}});e(window,{usersObj:n,app:s})}));
