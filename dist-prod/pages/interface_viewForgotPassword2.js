!function(o){"function"==typeof define&&define.amd?define(o):o()}((function(){"use strict";function o(){return(o=Object.assign||function(o){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=e[n])}return o}).apply(this,arguments)}var r="86";function e(o){geid("error_info").innerHTML='<strong style="color:red;">'+o+"</strong>",display("error_info_panel"),screenTopWarning(o)}function n(o){geid("error_info2").innerHTML='<strong style="color:red;">'+o+"</strong>",display("error_info_panel2"),screenTopWarning(o)}function t(o){geid("error_info2").innerHTML='<strong style="color:#4169E1;">'+o+"</strong>",display("error_info_panel2"),screenTopAlert(o)}function i(o){$(o).css("border-color","#f88"),$(o).focus(),$(o).blur((function(){$(o).css("border-color","")}))}function s(o){var r=0;return o.match(/([a-zA-Z])+/)&&r++,o.match(/([0-9])+/)&&r++,o.match(/[^a-zA-Z0-9]+/)&&r++,r}o(window,{chooseCountryNum:function(o){r=parseInt(o)},error_report:e,info_report:function(o){geid("error_info").innerHTML='<strong style="color:#4169E1;">'+o+"</strong>",display("error_info_panel"),screenTopWarning(o)},error_report2:n,info_report2:t,submit:function(){return Promise.resolve().then((function(){var o={username:gv("username"),mobile:gv("phone"),mcode:gv("mcode")};if(""==o.username)throw i("#username"),{error:"请填写用户名！"};if(""==o.mobile)throw i("#phone"),{error:"请填写手机号码！"};if(""==o.mcode)throw i("#mcode"),{error:"请填写手机验证码！"};return nkcAPI("/forgotPassword/mobile","POST",{username:o.username,mobile:o.mobile,mcode:o.mcode,nationCode:r})})).then((function(o){window.location="/forgotPassword/mobile?mobile="+o.mobile+"&mcode="+o.mcode+"&nationCode="+o.nationCode})).catch((function(o){e(o.error||o)}))},submit2:function(){var o=$("#phone2").val(),r=$("#mcode2").val(),a=$("#password").val(),c=$("#password2").val(),d=$("#nationCode").val();return Promise.resolve().then((function(){if(""===o)throw{error:"请填写手机号码。"};if(!/^[0-9]*$/.test(o))return i("#phone2"),e("手机号码格式不正确。");if(""==a)throw i("#password"),{error:"请填写密码。"};if(a.length<8)throw i("#password"),{error:"密码长度不能小于8位。"};if(s(a)<2)throw i("#password"),{error:"密码要具有数字、字母和符号三者中的至少两者。"};if(a!=c)throw i("#password2"),{error:"两遍密码不一致。"};return nkcAPI("/forgotPassword/mobile","PUT",{mobile:o,mcode:r,password:a,nationCode:d})})).then((function(o){t("修改密码成功！"),setTimeout((function(){window.location="/"}),5e3)})).catch((function(o){n(o.error)}))},getMcode:function(){var o=geid("phone").value.trim(),n=geid("username").value.trim();return""==n?(i("#username"),e("请填写用户名。")):""===o?(i("#phone"),e("请填写手机号码。")):void nkcAPI("/sendMessage/getback","post",{mobile:o,username:n,nationCode:r}).then((function(o){var r=120,e=setInterval((function(){$("#getMcode").attr("disabled",!0),$("#getMcode").text(r+"秒后可重发"),0==r&&($("#getMcode").text("获取手机验证码"),$("#getMcode").val("Submit").removeAttr("disabled"),clearInterval(e));r--}),1e3)})).catch((function(o){e(o.error)}))},getFocus:i,checkPass:s})}));
