!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function t(e,t){var n,r={"y+":t.getFullYear().toString(),"M+":(t.getMonth()+1).toString(),"d+":t.getDate().toString(),"H+":t.getHours().toString(),"m+":t.getMinutes().toString(),"s+":t.getSeconds().toString()};for(var a in r)(n=new RegExp("("+a+")").exec(e))&&(e=e.replace(n[1],1===n[1].length?r[a]:r[a].padStart(n[1].length,"0")));return e}var n=new Date,r=$("#timeRange");if(r[0]){var a,i=r.data("stime"),o=r.data("etime");i&&o&&(a=i+" - "+o);var l=r[0];laydate.render({elem:l,format:"yyyy-M-d H:m:s",value:a,type:"datetime",range:!0,done:function(e){$("#timeRange").val(e)}})}function s(e,t){return new Date(e.getTime()-t)}var c=$("#cleanupTimeRange");if(c[0]){i=c.data("stime"),o=c.data("etime");var d=c[0],u=s(n,7776e6),g=t("yyyy-M-d",u);laydate.render({elem:d,format:"yyyy-M-d H:m:s",value:(i||t("yyyy-M-d",u)+" 0:0:0")+" - "+(o||t("yyyy-M-d",u)+" 23:59:59"),type:"datetime",range:!0,max:g+" 23:59:59",done:function(e){$("#cleanupTimeRange").val(e)}})}function m(){var e;r.length&&(e=r.val().trim()),c.length&&(e=c.val().trim());var t,n,a,i,o=e.split(" - "),l=o[0],s=o[1];$("#userId").length&&(t=$("#userId").val().trim()),$("#ipAdress").length&&(n=$("#ipAdress").val().trim()),$("#operationId").length&&(a=$("#operationId").val().trim()),$("#logType").length&&(i=$("#logType").val().trim());var d=new Date(l).getTime(),u=new Date(s).getTime();return d&&u&&d>u?(sweetError("结束时间不能早于开始时间"),null):{sTime:l,eTime:s,uid:t||"",operationId:a||"",ip:n||"",logType:i||"user"}}e(window,{delLogs:function(){var e=$("#startTime").val().trim(),t=$("#endTime").val().trim(),n=$("#userId").val().trim(),r=$("#ipAdress").val().trim();if(""!==e&&""!==t){var a=new Date(e),i=new Date(t);if(a.getTime()>i.getTime())screenTopWarning("结束时间不能早于开始时间");else if(!1!==confirm("确定删除该条件下的日志？")){nkcAPI("/e/log/public?sTime="+e+"&eTime="+t+"&uid="+n+"&ip="+r,"DELETE",{}).then((function(){screenTopAlert("已删除相关条件下的日志"),setTimeout((function(){window.location.reload()}),1e3)})).catch((function(e){screenTopWarning(e.error)}))}}else screenTopWarning("请输入完整的时间区间")},dateFormat:t,subCalcDate:s,checkFormData:m,searchLogs:function(){var e=m();if(e){var t=$("#dataT").attr("data-t");t=t||"";var n="/e/log/public?c="+NKC.methods.strToBase64(JSON.stringify(e));t&&(n+="&t="+t),NKC.methods.visitUrl(n)}},deleteCurrentRecord:function(){var e=m();return sweetQuestion("确认删除当前查询结果中的所有日志吗？").then((function(){return nkcAPI("/e/log/public?del="+NKC.methods.strToBase64(JSON.stringify(e)),"DELETE")})).then((function(){sweetSuccess("删除成功")})).catch(sweetError)}})}));
