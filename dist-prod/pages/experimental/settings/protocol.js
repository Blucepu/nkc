!function(o){"function"==typeof define&&define.amd?define(o):o()}((function(){"use strict";function o(){return(o=Object.assign||function(o){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=e[n])}return o}).apply(this,arguments)}function t(){var o=$("#protocolName").val();if(!o)throw"请填写协议名称";var t=$("#protocolTypeId").val();if(!t)throw"请使用小写英文填写协议类型ID";if(/.*[\u4e00-\u9fa5]+.*$/.test(t))throw"协议类型ID不可包含中文字符";t=t.toLocaleLowerCase();var e=$("#protocolTypeName").val();if(!e)throw"请使用中文填写协议类型名称";var n=ue.getContent();return{protocolName:o,protocolTypeId:t,protocolTypeName:e,protocolContent:n=common.URLifyHTML(n)}}$("document").ready((function(){if($("#protocolHide").length>0){var o=$("#protocolHide").text();ue.ready((function(){ue.setContent(o)}))}})),o(window,{test:function(){var o=document.getElementById("text-elem").innerHTML;o=common.URLifyHTML(o)},addProtocol:function(){try{var o=t()}catch(o){return screenTopWarning(o)}document.getElementById("updateAdd").disabled=!0,nkcAPI("/e/settings/protocol","POST",o).then((function(o){screenTopAlert("保存成功"),openToNewLocation("/e/settings/protocol/"+o.protocolTypeId)})).catch((function(o){screenTopWarning(o||o.error),document.getElementById("updateAdd").disabled=!1}))},turnProtocolUpdate:function(o){openToNewLocation("/e/settings/protocol/"+o+"?visitType=update")},updateProtocol:function(o){try{var e=t()}catch(o){return screenTopWarning(o)}e.id=o,document.getElementById("updateEdit").disabled=!0,nkcAPI("/e/settings/protocol/"+o,"PUT",e).then((function(o){screenTopAlert("保存成功"),openToNewLocation("/e/settings/protocol/"+o.protocolTypeId)})).catch((function(o){screenTopWarning(o||o.error),document.getElementById("updateEdit").disabled=!1}))},deleteProtocol:function(o){var t={id:o};confirm("是否删除当前协议？")&&nkcAPI("/e/settings/protocol/"+o,"POST",t).then((function(o){screenTopAlert("该协议已删除"),openToNewLocation("/e/settings/protocol")})).catch((function(o){screenTopWarning(o||o.error)}))},getProtocol:t})}));
