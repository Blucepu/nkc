!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e}).apply(this,arguments)}var t=NKC.methods.getDataById("data"),s=new NKC.modules.SelectUser;t.transferSettings.kcbOnce=t.transferSettings.kcbOnce/100;var r=new Vue({el:"#app",data:{error:"",password:"",submitting:!1,num:1,transferSettings:t.transferSettings,enabledScores:t.enabledScores,shopScore:t.shopScore,from:{type:"bank",user:""},to:{type:"user",user:""},scoreType:"score1"},computed:{warning:function(){var e=this.from,t=this.to;return"user"!==e.type||e.user?"user"!==t.type||t.user?"bank"===e.type&&"bank"===t.type||"user"===e.type&&"user"===t.type&&t.user.uid===e.user.uid?"支付方和收款方不能相同":this.password?void 0:"请输入登录密码":"未指定收款方用户":"未指定支付方用户"}},methods:{fromNow:NKC.methods.fromNow,format:NKC.methods.format,visitUrl:NKC.methods.visitUrl,getUrl:NKC.methods.tools.getUrl,checkNumber:NKC.methods.checkData.checkNumber,saveTransferSettings:function(){var e=this.checkNumber,t=this.transferSettings,s=this.shopScore;Promise.resolve().then((function(){return e(t.kcbOnce,{name:"单次转账"+s.name+"上限",min:0,fractionDigits:2}),e(t.countOneDay,{name:"每天转账总次数上限",min:0}),e(t.countToUserOneDay,{name:"对同一用户每天转账次数上限",min:0}),nkcAPI("/e/settings/transfer","PUT",{transferSettings:t})})).then((function(){sweetSuccess("保存成功")})).catch(sweetError)},getUser:function(e){s.open((function(t){r[e].user=t.users[0]}),{userCount:1})},submit:function(){this.error="",this.submitting=!0,nkcAPI("/e/settings/transfer","POST",{from:"bank"===this.from.type?"bank":this.from.user.uid,to:"bank"===this.to.type?"bank":this.to.user.uid,password:this.password,scoreType:this.scoreType,num:this.num}).then((function(e){sweetSuccess("操作成功"),e.from&&(r.from.user=e.from),e.to&&(r.to.user=e.to),r.submitting=!1,r.password=""})).catch((function(e){sweetError(e),r.submitting=!1}))}}});e(window,{SelectUser:s,app:r})}));
