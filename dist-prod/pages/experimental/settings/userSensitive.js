!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(){return(e=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function n(){var e=$("#searchInput").val();if(!e)return screenTopWarning("输入内容不能为空");var n=$("#searchType").val();n="用户名"===n?"username":"UID"===n?"uid":"手机号"===n?"mobile":"email",NKC.methods.visitUrl("/e/settings/sensitive?searchType="+n+"&content="+e)}$("#searchInput").keydown((function(e){13===e.which&&n()})),window.ModifyAccountInfo=void 0,$((function(){window.ModifyAccountInfo=new NKC.modules.ModifyAccountSensitiveInfo})),e(window,{searchUser:n,createElements:function(e){var n=$("#searchResult"),t=n.find("tbody");if(t.html(""),e){for(var r=0;r<e.length;r++){var a=e[r];if(!a)return;var o=newElement("tr",{},{}),i=newElement("th",{},{}),s=newElement("img",{src:NKC.methods.tools.getUrl("userAvatar",a.avatar)},{width:"2rem",height:"2rem","margin-right":"0.5rem","border-radius":"50%"}),l=newElement("a",{href:"/u/"+a.uid},{}).text(a.username);i.append(s,l);var c=newElement("th",{},{}).text(a.threadCount),d=newElement("th",{},{}).text(a.postCount),m="text-danger",u="未通过";a.volumeA&&(u="通过",m="text-success");var p,f,h=newElement("th",{class:m},{}).text(u);m="text-danger",a.volumeB?(m="text-success",a.paperB?(p=newElement("a",{href:"/exam/categories/editor?cid="+a.paperB._id,target:"_blank",class:m}),f=newElement("span",{},{}).text("通过 - "+a.paperB.name),p.append(f)):f=newElement("span",{},{}).text("通过 - 试卷丢失")):f=newElement("span",{},{}).text("未通过");var v=newElement("th",{class:m},{});p?v.append(p):v.append(f);var w=newElement("th",{},{}).text("mobile"===a.registerType?"手机":"邮箱"),g=newElement("th",{},{}).text(NKC.methods.format("YYYY-MM-DD HH:mm:ss",a.toc)),E=newElement("th",{},{}).text(a.regIP+" : "+a.regPort),x=newElement("th",{},{});(l=newElement("button",{onclick:"editUserInfo('"+a.uid+"')"},{}).text("编辑")).addClass("btn btn-default btn-sm"),x.append(l),o.append(i,c,d,h,v,w,g,E,x),t.append(o)}n.show()}},saveUserInfo:function(e,n){var t={username:$("#username").val(),description:$("#description").val(),email:$("#email").val(),nationCode:$("#nationCodeSelect").val(),mobile:$("#mobile").val()};t.nationCode=parseInt(t.nationCode),nkcAPI("/e/settings/user/"+e,"PUT",t).then((function(){n?n():screenTopAlert("保存成功")})).catch((function(e){screenTopWarning(e.error||e)}))},editorRole:function(e,n){var t;t="add"===n?{operation:"addRole",roleDisplayName:$("#addSelect").val()}:{operation:"removeRole",roleDisplayName:$("#removeSelect").val()},nkcAPI("/e/settings/user/"+e,"PUT",t).then((function(){window.location.reload()})).catch((function(e){screenTopWarning(e.error||e)}))},editUserInfo:function(e){ModifyAccountInfo.open({uid:e})}})}));
