!function(n){"function"==typeof define&&define.amd?define(n):n()}((function(){"use strict";function n(){return(n=Object.assign||function(n){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}return n}).apply(this,arguments)}var r=$("#data").text(),e=[],t=[],o=[];function i(n){var r=$("#forumsDiv");r.html("");for(var e=0;e<n.length;e++){var t=f(n[e]),o=newElement("span",{class:"forum-span","data-fid":t.fid}).css({border:"2px solid #ffffff","background-color":t.color,"border-radius":"7px",padding:"0.5rem 1rem",margin:"0 0.5rem 0.5rem 0"}).text(t.displayName);r.append(o)}a()}function f(n){for(var r=0;r<e.length;r++){var t=e[r];if(t.fid===n)return t}}function a(){var n=$("span.forum-span");n.on("click",(function(){n.css({border:"2px solid #ffffff"}),0===o.length&&$(this).css({border:"2px solid #000000"});var r=[];if((s=$(this).attr("data-fid"))||screenTopWarning("数据错误，请刷新"),o.push(s),2===o.length){for(var e=t.indexOf(o[0]),f=t.indexOf(o[1]),a=0;a<t.length;a++){var s;(s=t[a])===o[0]?r.push(t[f]):s===o[1]?r.push(t[e]):r.push(s)}o=[],i(t=r)}}))}r&&(r=JSON.parse(r),e=r.forums||[],t=r.fidArr||[]),$((function(){i(t)})),n(window,{data:r,forums:e,fidArr:t,selectedFid:o,createSpan:i,getForumByFid:f,initEvent:a,saveForumsOrder:function(){nkcAPI("/e/settings/forum","PUT",{fidArr:t}).then((function(){screenTopAlert("保存成功")})).catch((function(n){screenTopWarning(n.error||n)}))},newForum:function(n){var r=prompt("请输入名称：");if(null!==r)return""===r?screenTopWarning("名称不能为空"):void nkcAPI("/f","POST",{displayName:r,forumType:n}).then((function(n){screenTopAlert("新建成功，正在前往设置"),setTimeout((function(){openToNewLocation("/f/"+n.forum.fid+"/settings")}),1500)})).catch((function(n){screenTopWarning(n.error||n)}))}})}));
