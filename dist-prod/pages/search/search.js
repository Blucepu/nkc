!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])}return t}).apply(this,arguments)}window.SubscribeTypes=void 0;var e=!!localStorage.getItem("search_complexOptions"),o=new Vue({el:"#app",data:{selectedForums:[],author:"",digest:!1,timeStart:{year:1970,month:1,day:1},timeEnd:{year:(new Date).getFullYear(),month:(new Date).getMonth()+1,day:(new Date).getDate()},sortType:"",sort:"",relation:"",t:"",c:"",complexOptions:e},computed:{timeStartDay:function(){return NKC.methods.getDayCountByYearMonth(this.timeStart.year,this.timeStart.month)},timeEndDay:function(){return NKC.methods.getDayCountByYearMonth(this.timeEnd.year,this.timeEnd.month)},options:function(){for(var t=[],e=0;e<this.selectedForums.length;e++)t.push(this.selectedForums[e].fid);var o={fid:t,timeStart:this.timeStart,timeEnd:this.timeEnd,sort:this.sort,author:this.author,digest:this.digest,sortType:this.sortType,relation:this.relation};return this.strToBase64(JSON.stringify(o))},selectedForumsId:function(){for(var t=[],e=0;e<this.selectedForums.length;e++)t.push(this.selectedForums[e].fid);return t}},methods:{strToBase64:function(t){return window.btoa(encodeURIComponent(t))},base64ToStr:function(t){return decodeURIComponent(window.atob(t))},addForum:function(t){for(var e=0;e<this.selectedForums.length;e++)if(this.selectedForums[e].fid===t.fid)return;this.selectedForums.push(t)},selectForum:function(){var t=this;window.ForumSelector||(window.ForumSelector=new NKC.modules.ForumSelector),window.ForumSelector.open((function(e){t.selectedForums.push(e.forum)}),{from:"readable",selectedForumsId:t.selectedForumsId,needThreadType:!1})},removeForum:function(t){var e=this.selectedForums.indexOf(t);this.selectedForums.splice(e,1)},clickNav:function(t){var e;"all"===t&&(e=""),"user"===t&&(e="&t=user"),"thread"===t&&(e="&t=thread"),"post"===t&&(e="&t=post"),"column"===t&&(e="&t=column"),"resource"===t&&(e="&t=resource"),NKC.methods.visitUrl("/search?c="+this.strToBase64(this.c||"")+e+"&d="+this.options)},search:function(){if(!this.c)return screenTopWarning("请输入关键词");NKC.methods.visitUrl("/search?c="+this.strToBase64(this.c||"")+(this.t?"&t="+this.t:"")+"&d="+this.options)},openMoreOptions:function(){this.complexOptions?(this.complexOptions=!1,this.selectedForums.length=0,this.author="",this.digest=!1,this.timeStart={year:1970,month:1,day:1},this.timeEnd={year:(new Date).getFullYear(),month:(new Date).getMonth()+1,day:(new Date).getDate()},this.sortType="",this.sort="",this.relation="",this.t="",localStorage.removeItem("search_complexOptions")):(this.complexOptions=!0,localStorage.setItem("search_complexOptions","1"))}},mounted:function(){var t=NKC.methods.getDataById("data");try{this.c=this.base64ToStr(t.c)}catch(e){console.log(e),this.c=t.c}this.t=t.t||"",this.selectedForums=t.selectedForums||[];var e=t.d;if(e)try{(e=JSON.parse(this.base64ToStr(e))).timeStart&&(this.timeStart=e.timeStart),e.timeEnd&&(this.timeEnd=e.timeEnd),e.sort&&(this.sort=e.sort),e.sortType&&(this.sortType=e.sortType),e.relation&&(this.relation=e.relation),e.author&&(this.author=e.author),e.digest&&(this.digest=e.digest),e.fid&&(this.fid=e.fid)}catch(t){}NKC.modules.SubscribeTypes&&(window.SubscribeTypes=new NKC.modules.SubscribeTypes)}});window.ResourceInfo=void 0,$((function(){window.ResourceInfo=new NKC.modules.ResourceInfo})),t(window,{initComplexOptions:e,app:o,showResource:function(t){ResourceInfo.open({lid:t})}})}));
