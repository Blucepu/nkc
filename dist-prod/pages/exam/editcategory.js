!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";new Vue({el:"#app",data:{category:{rolesId:[],name:"",description:"",volume:"A",passScore:"",from:[],disabled:!1},roles:[],from:[],showForums:!1},computed:{f:function(){for(var e=[],r=this.category.volume,o=0;o<this.from.length;o++){var n=this.from[o];n["count"+r]>0&&e.push(n)}return e},questionsCount:function(){for(var e=0,r=0;r<this.category.from.length;r++)e+=this.category.from[r].count||0;return e}},mounted:function(){var e=document.getElementById("data");e=e.innerHTML,e=JSON.parse(e),this.roles=e.roles,this.from=e.from,e.category&&(this.category=e.category)},methods:{addForum:function(e){for(var r=!1,o=0;o<this.category.from.length;o++){var n=this.category.from[o];e.type!==n.type||"pub"!==e.type&&e.fid!==n.fid||(r=!0)}r||this.category.from.push(e)},removeForum:function(e){var r=this.category.from.indexOf(e);this.category.from.splice(r,1)},save:function(){var e=this.category;if(""===e.name)return screenTopWarning("请输入考卷名称");if(""===e.description)return screenTopWarning("请输入考卷介绍");if(-1===["A","B"].indexOf(e.volume))return screenTopWarning("请选择考卷难度");if(0===e.from.length)return screenTopWarning("请选择试题来源");for(var r=0;r<e.from.length;r++){var o=e.from[r],n=o.forum?o.forum.displayName:"公共题库";if(0===o.count||""===o.count)return screenTopWarning(n+"的抽取数目不能小于1");var t={A:"基础题数目",B:"专业题数目"}[e.volume];if(o.count>o["count"+e.volume])return screenTopWarning(n+"的"+t+"不足");o.fid=o.forum?o.forum.fid:"",delete o.forum}if(e.passScore<1||e.passScore>this.questionsCount)return screenTopWarning("及格分数不能大于试题总数且不能小于1");if(e.time<=0)return screenTopWarning("答题时间必须大于0分钟");e.disabled=-1!==["true",!0].indexOf(e.disabled);var i="POST",a="/exam/categories";e._id&&(i="PUT",a="/exam/category/"+e._id),nkcAPI(a,i,{category:e}).then((function(){screenTopAlert("保存成功")})).catch((function(e){screenTopWarning(e)}))}}})}));
