!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function t(){$("#payForWater").hide()}$(document).ready((function(){$("input[type=radio][name=isWater]").change((function(){"no"==this.value?($("#waterStyle").attr("disabled","disabled"),$("#waterGravity").attr("disabled","disabled")):($("#waterStyle").removeAttr("disabled"),$("#waterGravity").removeAttr("disabled"))})),"no"==$('input:radio[name="isWater"]:checked').val()&&($("#waterStyle").attr("disabled","disabled"),$("#waterGravity").attr("disabled","disabled"))}));var a=NKC.methods.getDataById("data");NKC.methods.initSelectColor();var r=new Vue({el:"#watermarkApp",data:{waterSetting:a.waterSetting,noWatermark:a.noWatermark,columnName:a.columnName,username:a.user.username},methods:{getUrl:NKC.methods.tools.getUrl},computed:{watermarkFile:function(){var e={};if("siteLogo"===this.waterSetting.waterStyle){var t=this.noWatermark.file.normalAttachId;e.url=t?this.getUrl("watermark",t):this.getUrl("defaultFile","watermark_normal.png"),e.size="normal"}else{var a=this.noWatermark.file.smallAttachId;e.url=a?this.getUrl("watermark",a):this.getUrl("defaultFile","watermark_small.png"),e.size="small"}return e},watermarkName:function(){return"userLogo"===this.waterSetting.waterStyle?this.username:"coluLogo"===this.waterSetting.waterStyle?this.columnName:void 0}}});e(window,{changeWaterStyle:function(e){console.log($("#waterStyle option:selected").attr("data"))},changeWaterPosition:function(){console.log($("#waterGravity option:selected").attr("data"))},submit:function(e){var t;t="yes"==$('input:radio[name="isWater"]:checked').val();var a=$("#waterStyle option:selected").attr("data"),r=$("#waterGravity option:selected").attr("data");nkcAPI("/u/"+e+"/settings/water","PUT",{type:"save",waterAdd:t,waterStyle:a,waterGravity:r}).then((function(){sweetSuccess("修改成功")})).catch((function(e){sweetError(e)}))},isAlreadyPay:function(e){e||($("#payForWater").show(),$("#radio2").prop("checked",!1),$("#radio1").prop("checked",!0))},showButton:function(){$("#payForWater").show()},hideButton:t,yesPayForWater:function(e){nkcAPI("/u/"+e+"/settings/water","PUT",{type:"pay"}).then((function(){sweetSuccess("修改成功"),window.location.reload()})).catch((function(e){sweetError(e),t()}))},noPayForWater:function(){t(),$("#radio1").attr("checked",!0)},turnImg:function(){$("#newImg").attr("src","/default/"+$("#waterStyle").val()+$("#waterGravity").val()+".jpg"),r.waterSetting.waterStyle=$("#waterStyle").val(),r.waterSetting.waterGravity=$("#waterGravity").val()},saveAppInfo:function(){var e=$("input[name='homeThreadList']");e=e.eq(0).prop("checked")?"home":e.eq(1).prop("checked")?"latest":"subscribe";var t=$("input[name='envelope']");t=t.eq(0).prop("checked");var r=$("input[name='selectTypes']");r=r.eq(0).prop("checked");var n=$("input[data-control='selectColor']");n=n.val(),nkcAPI("/u/"+a.user.uid+"/settings/apps","PUT",{homeThreadList:e,color:n,showEnvelope:t,selectTypesWhenSubscribe:r}).then((function(){sweetSuccess("保存成功")})).catch((function(e){sweetError(e)}))},app:r})}));
