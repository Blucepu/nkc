!function(o){"function"==typeof define&&define.amd?define(o):o()}((function(){"use strict";function o(){return(o=Object.assign||function(o){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=e[n])}return o}).apply(this,arguments)}var t=[],e=[];function n(){i("#idCardAPhoto"),i("#idCardBPhoto"),i("#handheldIdCardPhoto"),i("#lifePhoto"),i("#certsPhoto")}function i(o){$(o).on("change",(function(){var t=$(o).get(0).files;if(0!==t.length){for(var e="<span>已选择图片</span><br>",n=0;n<t.length;n++){var i=t[n];e+="<span>文件名："+i.name+" <br> 文件大小："+a(i.size)+"</span><br>"}$(o+"Messages").html(e),r(o)}}))}function r(o){var n=$(o).get(0).files,i=n.length;if(0===i)return screenTopAlert("未选择任何图片！");if(1===i&&("#idCardAPhoto"===o||"#idCardBPhoto"===o)||"#handheldIdCardPhoto"===o){var r=n[0],a=new FormData;a.append("file",r),a.append("photoType",o),postUpload("/photo",a,h)}else{var c=1;!function n(r,a){if(!(r.length<=a)){var h=r[a],d=new FormData;d.append("file",h),d.append("photoType",o),postUpload("/photo",d,(function(o){!function(o){c++;var n=o.photoId,r=o.photoType;c>i&&$(r+"Messages").html($(r+"Messages").html()+"<h5>上传成功！</h5>"),"#lifePhoto"===r?(t.push(n),s()):"#certsPhoto"===r&&(e.push(n),l())}(o),n(r,a+1)}))}}(n,0)}}function a(o){var t=o/1024;return t>=1024?(t=(t/1024).toFixed(2))+" M":(t=t.toFixed(1))+" KB"}function h(o){window.location.reload()}function c(){for(var o=$("#lifePhotoDisplay div img"),e=0;e<o.length;e++){var n=o.eq(e).attr("photoId");-1===t.indexOf(n)&&t.push(n)}}function l(){var o="";if(0===e.length)o='<div class="blank" style="height: 20rem;line-height: 20rem">暂无数据</div>';else for(var t=0;t<e.length;t++){var n=e[t];o+='<div class="col-xs-12 col-md-4"><div class="settings-img-remove glyphicon glyphicon-remove" onclick="removePhoto('+n+')")></div><img src="/photo_small/'+n+'" photoId="'+n+'"></div>'}$("#certsPhotoDisplay").html(o)}function s(){var o="";if(0===t.length)o='<div class="blank" style="height: 20rem;line-height: 20rem">暂无数据</div>';else for(var e=0;e<t.length;e++){var n=t[e];o+='<div class="col-xs-12 col-md-4"><div class="settings-img-remove glyphicon glyphicon-remove" onclick="removePhoto('+n+')")></div><img src="/photo_small/'+n+'" photoId="'+n+'"></div>'}$("#lifePhotoDisplay").html(o)}function d(){for(var o=$("#certsPhotoDisplay div img"),t=0;t<o.length;t++){var n=o.eq(t).attr("photoId");-1===e.indexOf(n)&&e.push(n)}}$((function(){n();try{c(),d()}catch(o){console.log(o)}})),o(window,{lifePhotoArr:t,certsPhotoArr:e,init:n,chooseFile:i,uploadFile:r,outSize:a,uploadSuccess:h,initLifePhoto:c,displayCertsPhoto:l,displayLifePhoto:s,initCertsPhoto:d,removePhoto:function(o){nkcAPI("/photo/"+o,"DELETE",{}).then((function(o){window.location.reload()})).catch((function(o){screenTopWarning(o.error)}))},submitAuth:function(o){nkcAPI("/auth","POST",{number:o}).then((function(o){screenTopAlert("提交成功，请耐心等待审核。"),setTimeout((function(){window.location.reload()}),2e3)})).catch((function(o){screenTopWarning(o.error)}))},unSubmitAuth:function(o,t){nkcAPI("/auth/"+o+"?number="+t,"DELETE",{}).then((function(o){screenTopAlert("撤销成功！"),window.location.reload()})).catch((function(o){screenTopWarning(o.error)}))}})}));
