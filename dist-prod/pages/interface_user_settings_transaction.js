!function(n){"function"==typeof define&&define.amd?define(n):n()}((function(){"use strict";function n(){return(n=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var c=arguments[t];for(var s in c)Object.prototype.hasOwnProperty.call(c,s)&&(n[s]=c[s])}return n}).apply(this,arguments)}var t=NKC.methods.getDataById("data"),c=new NKC.modules.SelectAddress,s=new Vue({el:"#app",data:{alipayAccounts:t.alipayAccounts||[],addresses:t.addresses||[],bankAccounts:t.bankAccounts||[],user:t.user,account:"",accountBank:""},methods:{format:NKC.methods.format,selectAddress:function(n){c.open((function(t){n.location=t.join(" ")}),{onlyChina:!0})},addAddress:function(){this.addresses.push({location:"",address:"",username:"",mobile:""})},remove:function(n){this.addresses.splice(n,1),this.save("remove")},save:function(n){var t=this.addresses;nkcAPI("/u/"+this.user.uid+"/settings/transaction","PUT",{addresses:t}).then((function(){"remove"!==n&&sweetSuccess("保存成功")})).catch((function(n){sweetError(n)}))},modifyAccount:function(n){this.account=n},modifyBankAccount:function(n){this.accountBank=n},post:function(n){return nkcAPI("/u/"+this.user.uid+"/settings/alipay","POST",n)},postBank:function(n){return nkcAPI("/u/"+s.user.uid+"/settings/bank","POST",n)},setDefault:function(n){for(var t=this.alipayAccounts,c=0;c<t.length;c++)t[c].default=!1;n.default=!0,this.saveAccounts()},setDefaultBank:function(n){for(var t=this.bankAccounts,c=0;c<t.length;c++)t[c].default=!1;n.default=!0,this.saveBankAccounts()},deleteAccount:function(n){this.post({type:"deleteAccount",account:{account:n.account,name:n.name}}).then((function(){var t=s.alipayAccounts.indexOf(n);s.alipayAccounts.splice(t,1)})).catch((function(n){screenTopWarning(n)}))},deleteBankAccount:function(n){this.postBank({type:"deleteAccount",account:{account:n.account,name:n.name}}).then((function(){var t=s.bankAccounts.indexOf(n);s.bankAccounts.splice(t,1)})).catch((function(n){screenTopWarning(n)}))},addAccount:function(){for(var n=0;n<this.alipayAccounts.length;n++)if(!this.alipayAccounts[n].time)return;var t={};this.alipayAccounts.length||(t.default=!0),this.alipayAccounts.push(t),this.account=t},addAccountBank:function(){for(var n=0;n<this.bankAccounts.length;n++)if(!this.bankAccounts[n].time)return;var t={};this.bankAccounts.length||(t.default=!0),this.bankAccounts.push(t),this.accountBank=t},saveAccounts:function(){this.post({type:"saveAccounts",accounts:this.alipayAccounts}).then((function(n){s.alipayAccounts=n.alipayAccounts})).catch((function(n){screenTopWarning(n)}))},saveBankAccounts:function(){this.postBank({type:"saveAccounts",accounts:this.bankAccounts}).then((function(n){s.bankAccounts=n.bankAccounts})).catch((function(n){screenTopWarning(n)}))},cancelAccounts:function(n){if(n.time)return this.account="";var t=this.alipayAccounts.indexOf(n);this.alipayAccounts.splice(t,1)},cancelBankAccounts:function(n){if(n.time)return this.accountBank="";var t=this.bankAccounts.indexOf(n);this.bankAccounts.splice(t,1)}}});n(window,{SelectAddress:c,app:s})}));
