!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t}).apply(this,arguments)}var e=UE.getEditor("container",NKC.configs.ueditor.shopConfigs);function a(){$(".time").length&&$(".time").datetimepicker({language:"zh-CN",format:"yyyy-mm-dd hh:ii",autoclose:!0,todayHighlight:1,startView:2,minView:0,forceParse:0})}window.ue=e,window.testTh=void 0,NKC.modules.MoveThread&&(window.testTh=new NKC.modules.MoveThread),a(),window.productImageDomId=void 0;var i=0;function n(){var t=$("#productName").val();t=t.trim();var a=$("#productDescription").val(),i=$(".attention").val();if(i.length>200)throw"关键词不能超过200字";if(!(a=a.trim()))throw"请输入商品描述";$("#originalPrice").val(),$("#afterRebatePrice").text(),$("#stockQuantity").val();var n=$("input[name='stockCostMethod']:checked").val(),r=$("#vipDiscount").prop("checked"),s=[];$(".viptr").each((function(){var t=Number($(this).find(".viplevel").attr("vid")),e=Number($(this).find(".vipnum").val());(!e||isNaN(e)||e>100)&&(e=100);var a={vipLevel:t,vipNum:e};s.push(a)}));var c,l={priceShowToVisit:$("#priceShowToVisit").prop("checked"),priceShowAfterStop:$("#priceShowAfterStop").prop("checked")};if($("#isPurchaseLimit").prop("checked")){if(c=$("#purchaseLimitCount").val(),!(c=Number(c))||isNaN(c)||c<0)throw"限购数量应该是正整数且不大于商品的库存数量"}else c=-1;var p,u=!1;$("#isUploadCert").prop("checked")&&(u=!0,p=$("#uploadCertDescription").val());var h=[];if($("#productImages").find("img.picShow").each((function(){h.push($(this).attr("imageId"))})),0==h.length)throw"至少上传一张商品图";var m,f=h[0],b=e.getContent();b=common.URLifyHTML(b);var y="",P=$("input[name='shelfMethod']:checked").val();"insale"==P?m="insale":"notonshelf"==P?m="notonshelf":"insaletime"==P&&(m="notonshelf",y=$("#saleTime").val());var k=d(),w=g(),x=o(),T=[],N=!0,D={firstFreightPrice:null,addFreightPrice:null};if("freePost"!==$("input[name='freightMethod']:checked").val()){if(N=!1,$("#templateTable").find("tbody tr").each((function(){if($(this).find(".tempCheck").prop("checked")){var t={name:$(this).find(".tempName").text(),firstPrice:100*Number($(this).find(".firstFreightPrice").val()),addPrice:100*Number($(this).find(".addFreightPrice").val())};T.push(t)}})),0===T.length)throw"不免邮费时请至少选择一个运费模板";D.firstFreightPrice=T[0].firstPrice,D.addFreightPrice=T[0].addPrice}var C=[],S=v();if(!S)throw"商品分类为必选，请务必选一个";return C.push(S),$("#newPanelForum").find(".chooseForum").each((function(){var t=$(this).attr("fid");t&&"undefined"!==t&&C.push(t)})),{productName:t,productDescription:a,productDetails:b,imgIntroductions:h,imgMaster:f,uploadCert:u,uploadCertDescription:p,stockCostMethod:n,isFreePost:N,freightPrice:D,freightTemplates:T,productStatus:m,shelfTime:y,params:k,mainForumsId:C,productParams:w,singleParams:x,attention:i,purchaseLimitCount:c,vipDiscount:r,vipDisGroup:s,productSettings:l}}function r(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],a=!0,i=0;i<e.length;i++)if(t.indexOf(e[i])>0){a=!1;break}return a}function s(t){"prev"==t?i-=1:"next"==t?i+=1:"turn"==t&&(i=i),i<=0&&(i=0);var e=20;r()||(e=8);var a=[];nkcAPI("/me/media?quota="+e+"&skip="+i+"&type=picture","get",{}).then((function(t){for(var e in t.resources){var n="<div class='col-sm-3 col-xs-6' style='margin-bottom:20px;cursor: pointer;' onclick='insertImageToProduct("+t.resources[e].rid+")'><img class='img-thumbnail' style='width:100%;height:100px' src='/r/"+t.resources[e].rid+"'></div>";a.push(n)}i=parseInt(t.skip),$("#currentSkip").text(i+1),$("#maxSkip").text(t.maxSkip),$("#imageArrayDom").html(a)})).catch((function(t){i=parseInt(t.skip)}))}function o(){var t=[];return $("#useparams").prop("checked")?($("#singleParams tbody tr").each((function(e,a){var i={},n=$(a).find(".singleName").val();if(!n)throw"独立规格名称不能为空";var r=Number($(a).find(".singleOriginPrice").val());if(!r||isNaN(r))throw"请输入正确的独立规格价格";var s=Number($(a).find(".singleCount").val());s&&!isNaN(s)||(s=0);var o=Number($(a).find(".singlePrice").val()),d=$(a).find(".singleUseDiscount").prop("checked");if(o<0||isNaN(o))throw"独立规格优惠价格有误";if(d&&o<=0)throw"独立规格优惠价格有误";if(o>r)throw"独立规格中优惠价格不得大于原价格";i.name=n,i.originPrice=100*r,i.stocksSurplus=s,i.stocksTotal=s,i.price=100*o,i.useDiscount=d,t.push(i)})),0==t.length&&(t=[])):t=[],t}function d(){var t=[];return $("#useparams").prop("checked")?($("#paramsTable tbody tr").each((function(e,a){var i={};i.name=$(a).find(".pname").val();var n=$(a).find(".pvalue").val().split(",");i.values=n,t.push(i)})),0==t.length&&(t=[])):t=[],t}function c(){var t=[];return $("#paramsTable tbody tr").each((function(e,a){var i=$(a).find(".pvalue").val().split(",");t.push(i)})),t}function l(t){var e=t.length;if(0==e)return t;if(e>=2){for(var a=t[0].length,i=t[1].length,n=new Array(a*i),r=0,s=0;s<a;s++)for(var o=0;o<i;o++)t[0][s]instanceof Array?n[r]=t[0][s].concat(t[1][o]):n[r]=[t[0][s]].concat(t[1][o]),r++;var d=new Array(e-1);for(s=2;s<t.length;s++)d[s-1]=t[s];return d[0]=n,l(d)}return t[0]}$((function(){$("[data-toggle='popover']").popover()})),$(document).ready((function(){var t=document.getElementById("data");if(t){var e=(t=JSON.parse(t.innerHTML)).product,a=e.params;if(a.length>0)for(var i in a){var n='<tr><td style="width:5%"><a class="btn btn-danger btn-sm padding-0 margin-right-10" onclick="delParamTable(this)">删除</a></td><td style="width:10%"><input type="text" class="pname pnameCla" data-role="tagsinput" value="'+a[i].name+'"></td><td><input type="text" class="pvalue" data-role="tagsinput" style="width:100%" value="'+a[i].values+'"></td>><td style="width:5%"><a class="btn btn-info btn-sm padding-0 margin-right-10" onclick="saveNewParam(this)">保存</a></td></tr>';$("#paramsTable").find("tbody").append(n),$(".pvalue").tagsinput({maxChars:8,maxTags:20})}var r=e.productParams;if(a.length>0){var s="",o="";for(var d in r){var c;if("common"==r[d].type)c=r[d].useDiscount?'<input type="checkbox" class="usedis" checked>':'<input type="checkbox" class="usedis">',r[d].isEnable?s+='<tr><td contenteditable="false" sid="'+r[d].index+'" class="paraid">'+r[d].name+'</td><td style="width:15%"><button class="ban" onclick="banParam(this)">禁用</button><button class="enable" onclick="enableParam(this)" style="display:none">启用</button><span class="text-danger bantext" style="font-size:10px;margin-left:5px;display:none">禁用中</span></td><td><input type="text" class="oprice" style="width:100%" value="'+numToFloatTwo(r[d].originPrice)+'"></td><td><input type="text" class="count" style="width:100%" value="'+r[d].stocksSurplus+'"></td><td contenteditable="false">'+c+'</td><td><input type="text" class="dprice" style="width:100%" value="'+numToFloatTwo(r[d].price)+'"></td></tr>':s+='<tr style="background-color:#ddd"><td contenteditable="false" sid="'+r[d].index+'" class="paraid">'+r[d].name+'</td><td style="width:15%"><button class="ban" onclick="banParam(this)" style="display:none">禁用</button><button class="enable" onclick="enableParam(this)">启用</button><span class="text-danger bantext" style="font-size:10px;margin-left:5px">禁用中</span></td><td><input type="text" class="oprice" style="width:100%;background-color:#ddd" value="'+numToFloatTwo(r[d].originPrice)+'" readonly></td><td><input type="text" class="count" style="width:100%;background-color:#ddd" value="'+r[d].stocksSurplus+'" readonly></td><td contenteditable="false">'+c+'</td><td><input type="text" class="dprice" style="width:100%;background-color:#ddd" value="'+numToFloatTwo(r[d].price)+'" readonly></td></tr>';else c=r[d].useDiscount?'<input type="checkbox" class="singleUseDiscount" checked>':'<input type="checkbox" class="singleUseDiscount">',o+='<tr><td><input type="text" class="singleName" value="'+r[d].name+'"></td><td><input type="text" class="singleOriginPrice" value="'+numToFloatTwo(r[d].originPrice)+'"></td><td><input type="text" class="singleCount" value="'+r[d].stocksSurplus+'"></td><td>'+c+'</td><td><input type="text" class="singlePrice" value="'+numToFloatTwo(r[d].price)+'"></td><td><button onclick="delSingleParam(this)" class="btn btn-danger btn-sm padding-0 margin-right-10">删除</button></td></tr>'}$("#arrayTable").find("tbody").html(s),$("#singleParams").find("tbody").html(o)}}$("#test").tagsinput({maxChars:8,maxTags:20,trimValue:!0}),$("#ReplyContent").on("paste",(function(){setTimeout((function(){$("#text-elem img").each((function(){if(!$(this).attr("srcs"))return!0;var t=$(this).attr("srcs"),e="<img src='"+t+"' style='max-width: 100%'>";if(-1!==t.indexOf("kechuang"))return $(this).replaceWith(e),!0;if(1==new RegExp("file:").test(t))return $(this).replaceWith("<img src='/resources/site_specific/picdefault.png'>"),!0;if(t.length>10){var a={loadsrc:t},i=$(this);nkcAPI("/download","POST",a).then((function(t){i.attr("src",""),i.attr("srcs","");var e="<img src='/r/"+t.r.rid+"' style='max-width: 100%'>";i.replaceWith(e),list&&list.refresh()})).catch((function(t){i.attr("src",""),i.attr("srcs",""),i.replaceWith("<img src='/resources/site_specific/picdefault.png'>")}))}}))}),5e3)})),$("input[type=radio][name=shelfMethod]").change((function(){"insale"==this.value||"notonshelf"==this.value?$("#saleTimeDom").css("display","none"):"insaletime"==this.value&&$("#saleTimeDom").css("display","")})),$("#useparams").change((function(){$("#useparams").prop("checked")?($("#nouseParamsDom").css("display","none"),$("#useParamsDom").css("display","")):($("#nouseParamsDom").css("display",""),$("#useParamsDom").css("display","none"))})),$("#usedis").change((function(){$("#usedis").prop("checked")?$("#disCostDom").css("display",""):$("#disCostDom").css("display","none")})),$("#vipDiscount").change((function(){$("#vipDiscount").prop("checked")?$("#vipDisDom").css("display",""):$("#vipDisDom").css("display","none")})),$("#isPurchaseLimit").change((function(){$("#isPurchaseLimit").prop("checked")?$("#purchaseLimitDom").css("display",""):$("#purchaseLimitDom").css("display","none")})),$("#isUploadCert").change((function(){$("#isUploadCert").prop("checked")?$("#uploadCertDom").css("display",""):$("#uploadCertDom").css("display","none")})),$("input[type=radio][name=freightMethod]").change((function(){"payPost"==this.value?$("#freightPriceDom").css("display","block"):$("#freightPriceDom").css("display","none")})),$("#productDescription").on("input propertychange",(function(){$("#productDescriptionNum").text($("#productDescription").val().length)}))}));var p=!1,u=!0;function h(t){var e=t.length;if(0==e)return t;if(e>=2){var a=t[0].length,i=t[1].length,n=new Array(a*i),r=0;if(p)for(s=0;s<a;s++)for(o=0;o<i;o++)n[r]=t[0][s]+"-"+o,r++;else for(var s=0;s<a;s++)for(var o=0;o<i;o++)n[r]=s+"-"+o,r++;p=!0,u=!1;var d=new Array(e-1);for(s=2;s<t.length;s++)d[s-1]=t[s];return d[0]=n,h(d)}if(u){for(var c=[],l=0;l<t[0].length;l++)c.push(l);return p=!1,u=!0,c}return p=!1,u=!0,t[0]}function m(){var t=[];$(".pname").each((function(){t.push($(this).val())})),$("#paraGroup").text(t)}function f(){var t=c(),e=l(t),a=h(t),i="",n=$("#arrayTable").find("tbody");if(0!==t.length)for(var r=0;r<e.length;r++){var s,o,d,p,u,f,g=!1;if(n.find("tr").each((function(){e[r]==$(this).find(".paraid").text()&&(s=$(this).find(".oprice").val(),o=$(this).find(".count").val(),d=$(this).find(".usedis").prop("checked"),p=$(this).find(".dprice").val(),u=$(this).find(".ban").css("display"),g=!0)})),g)f=d?'<input type="checkbox" class="usedis" checked>':'<input type="checkbox" class="usedis">',i+="none"==u?'<tr style="background-color:#ddd"><td contenteditable="false" sid="'+a[r]+'" class="paraid">'+e[r]+'</td><td style="width:15%"><button class="ban" onclick="banParam(this)" style="display:none">禁用</button><button class="enable" onclick="enableParam(this)">启用</button><span class="text-danger bantext" style="font-size:10px;margin-left:5px;">禁用中</span></td><td><input type="text" class="oprice" style="width:100%;background-color:#ddd" value="'+s+'" readonly></td><td><input type="text" class="count" style="width:100%;background-color:#ddd" value="'+o+'" readonly></td><td contenteditable="false">'+f+'</td><td><input type="text" class="dprice" style="width:100%;background-color:#ddd" value="'+p+'" readonly></td></tr>':'<tr><td contenteditable="false" sid="'+a[r]+'" class="paraid">'+e[r]+'</td><td style="width:15%"><button class="ban" onclick="banParam(this)">禁用</button><button class="enable" onclick="enableParam(this)" style="display:none">启用</button><span class="text-danger bantext" style="font-size:10px;margin-left:5px;display:none">禁用中</span></td><td><input type="text" class="oprice" style="width:100%" value="'+s+'"></td><td><input type="text" class="count" style="width:100%" value="'+o+'"></td><td contenteditable="false">'+f+'</td><td><input type="text" class="dprice" style="width:100%" value="'+p+'"></td></tr>';else i+='<tr><td contenteditable="false" sid="'+a[r]+'" class="paraid">'+e[r]+'</td><td style="width:15%"><button class="ban" onclick="banParam(this)">禁用</button><button class="enable" onclick="enableParam(this)" style="display:none">启用</button><span class="text-danger bantext" style="font-size:10px;margin-left:5px;display:none">禁用中</span></td><td><input type="text" class="oprice" style="width:100%"></td><td><input type="text" class="count" style="width:100%"></td><td contenteditable="false"><input type="checkbox" class="usedis"></td><td><input type="text" class="dprice" style="width:100%"></td></tr>'}$("#arrayTable").find("tbody").html(i),m()}function g(){var t,e=!0,a=[],i=0;if($("#useparams").prop("checked")){if($("#arrayTable").find("tbody tr").each((function(t,n){e=!0;t=$(n).find(".paraid").attr("sid");var r=$(n).find(".paraid").text(),s=$(n).find(".ban").css("display"),o=$(n).find(".oprice").val();if((!o||""==o)&&"none"!==s)throw"未禁用的规格必须输入价格";var d=$(n).find(".count").val(),c=$(n).find(".usedis").prop("checked"),l=$(n).find(".dprice").val();if(isNaN(Number(o)))throw"价格不可以输入除数字以外的字符";"none"==s&&(e=!1,i++),o=""==(o=o.trim())||isNaN(Number(o))||Number(o)<0?-1:100*Number(o).toFixed(2),d=""==(d=d.trim())||isNaN(Number(d))||Number(d)<1?0:1*Number(d).toFixed(0),(l=""==(l=l.trim())||isNaN(Number(l))||Number(l)<0?0:100*Number(l).toFixed(2))>o&&(l=o);var p={index:t,name:r,isEnable:e,originPrice:o,stocksTotal:d,useDiscount:c,price:l};a.push(p)})),0==a.length)throw"多规格不可为空";if(a.length==i)throw"至少启用一个规格"}else{if(!(t=$("#originalPrice").val()))throw"请输入商品价格";var n=$("#usedis").prop("checked"),r=$("#afterDisCost").val();if(r||(r=t),Number(r)>Number(t))throw"优惠价不得高于商品原价";var s=$("#stockQuantity").val();if(!s)throw"请输入商品数量";para={index:"",name:"默认",isEnable:e,stocksTotal:1*Number(s).toFixed(0),originPrice:100*Number(t).toFixed(2),price:100*Number(r).toFixed(2),useDiscount:n},a.push(para)}return a}function v(){return $("#shopForums").val()}t(window,{testThOpen:function(){var t=[],e=[];$(".chooseForum").each((function(){var e=$(this).attr("fid");e&&"undefined"!==e&&t.push(e)})),$(".chooseCate").each((function(){var t=$(this).attr("cid");t&&"undefined"!==t&&e.push(t)})),testTh.open((function(t){for(var e="",a=t.forums,i=0;i<a.length;i++)e+='<div class="move-thread-forum-name" style="background-color:'+a[i].color+' "><span class="chooseForum" fid="'+a[i].fid+'">'+a[i].fName+' <span class="chooseCate" cid="'+a[i].cid+'"> '+a[i].cName+"</span></span></div>";$("#newPanelForum").html(e),testTh.close()}),{hideMoveType:!0,selectedForumsId:t,selectedCategoriesId:e,forumCountLimit:1})},initTime:a,submitToShelf:n,productToShelf:function(t){$("#saveProduct").attr("disabled",!0);try{var e=n()}catch(t){return $("#saveProduct").removeAttr("disabled"),screenTopWarning(t)}nkcAPI("/shop/manage/"+t+"/shelf","POST",{post:e}).then((function(e){screenTopAlert("上架成功"),openToNewLocation("/shop/manage/"+t+"/goodslist")})).catch((function(t){screenTopWarning(t.error||t),$("#saveProduct").removeAttr("disabled")}))},productToHouse:function(){},autoCalcuPrice:function(){var t=100;geid("useRebate").checked&&((t=parseInt(geid("rebate").value))||(t=100),0==t&&(t=1),t>99&&(t=100));var e=geid("originalPrice").value;parseInt(e)||(e=0);var a=e*t/100;$("#afterRebatePrice").text(a)},openImageManage:function(t){window.productImageDomId=t,s()},IsPC:r,manageImageLoader:s,prevPageManage:function(){s("prev")},nextPageManage:function(){s("next")},insertImageToProduct:function(t){$("#"+productImageDomId).find(".upload_image_item_border").css("display","none"),$("#"+productImageDomId).find(".upload_image_card").css("display","block"),$("#"+productImageDomId).find(".upload_image_card").find("img").attr("src","/r/"+t),$("#"+productImageDomId).find(".upload_image_card").find("img").attr("imageId",t),$("#"+productImageDomId).find(".upload_image_card").find("img").addClass("picShow"),$("#myModal").modal("hide")},deleteImageInProduct:function(t){$("#"+t).find(".upload_image_item_border").css("display","block"),$("#"+t).find(".upload_image_card").css("display","none"),$("#"+t).find(".upload_image_card").find("img").removeClass("picShow")},addNewParam:function(){if(5==$("#paramsTable tbody tr").length)return screenTopAlert("属性种类最大数量为5");$("#paramsTable").find("tbody").append('<tr><td style="width:5%"><a class="btn btn-danger btn-sm padding-0 margin-right-10" onclick="delParamTable(this)">删除</a></td><td style="width:10%"><input type="text" class="pname pnameCla" data-role="tagsinput"></td><td><input type="text" class="pvalue" data-role="tagsinput" style="width:100%"></td><td style="width:5%"><a class="btn btn-info btn-sm padding-0 margin-right-10" onclick="saveNewParam(this)">保存</a></td></tr>'),$(".pvalue").tagsinput({maxChars:8,maxTags:20})},addSingleParam:function(){$("#singleParams").find("tbody").append('<tr><td><input type="text" class="singleName"></td><td><input type="text" class="singleOriginPrice"></td><td><input type="text" class="singleCount"></td><td><input type="checkbox" class="singleUseDiscount"></td><td><input type="text" class="singlePrice"></td><td><button onclick="delSingleParam(this)" class="btn btn-danger btn-sm padding-0 margin-right-10">删除</button></td></tr>')},delSingleParam:function(t){$(t).parents("tr").remove()},getSingleParams:o,saveNewParam:function(t){var e=$(t).parents("tr").find(".pname").val(),a=$(t).parents("tr").find(".pvalue").val();return(e=e.trim())?(a=a.replace(/\s+/g,""))?void f():screenTopWarning("请输入规格属性"):screenTopWarning("请输入规格名称")},delParamTable:function(t){confirm("确定要删除当前属性吗？")&&($(t).parents("tr").remove(),f())},tableTurnParams:d,tableTurnMulArray:c,mulArrExchangeArr:l,mulArrExchangeStr:h,getParaGroup:m,mulArrTurnTable:f,banParam:function(t){$(t).parents("tr").css("background-color","#ddd"),$(t).parents("tr").find(".oprice").attr("readonly","true"),$(t).parents("tr").find(".oprice").css("background-color","#ddd"),$(t).parents("tr").find(".count").attr("readonly","true"),$(t).parents("tr").find(".count").css("background-color","#ddd"),$(t).parents("tr").find(".dprice").attr("readonly","true"),$(t).parents("tr").find(".dprice").css("background-color","#ddd"),$(t).parents("tr").find(".ban").css("display","none"),$(t).parents("tr").find(".enable").css("display",""),$(t).parents("tr").find(".bantext").css("display","")},enableParam:function(t){$(t).parents("tr").css("background-color",""),$(t).parents("tr").find(".oprice").removeAttr("readonly"),$(t).parents("tr").find(".oprice").css("background-color",""),$(t).parents("tr").find(".count").removeAttr("readonly"),$(t).parents("tr").find(".count").css("background-color",""),$(t).parents("tr").find(".dprice").removeAttr("readonly"),$(t).parents("tr").find(".dprice").css("background-color",""),$(t).parents("tr").find(".ban").css("display",""),$(t).parents("tr").find(".enable").css("display","none"),$(t).parents("tr").find(".bantext").css("display","none")},obtainProductPrice:g,addAttention:function(){$(".attentionList").append("<input class='attention form-control' type='text' placeholder='请用不超过15字来完成一个简短说明,不填写则无'>")},getShopForum:v,editProductShelf:function(t,e){$("#resaveBtn").attr("disabled",!0);var a,i=$("input[name='stockCostMethod']:checked").val();if($("#isPurchaseLimit").prop("checked")){if(a=$("#purchaseLimitCount").val(),!(a=Number(a))||isNaN(a)||a<0)return screenTopWarning("限购数量应该是正整数且不大于商品的库存数量")}else a=-1;var n=$("#vipDiscount").prop("checked"),r=[];$(".viptr").each((function(){var t=Number($(this).find(".viplevel").attr("vid")),e=Number($(this).find(".vipnum").val());(!e||isNaN(e)||e>100)&&(e=100);var a={vipLevel:t,vipNum:e};r.push(a)}));var s,c={priceShowToVisit:$("#priceShowToVisit").prop("checked"),priceShowAfterStop:$("#priceShowAfterStop").prop("checked")},l=!1;$("#isUploadCert").prop("checked")&&(l=!0,s=$("#uploadCertDescription").val());var p=[],u=!0,h={firstFreightPrice:null,addFreightPrice:null};if("freePost"!==$("input[name='freightMethod']:checked").val()){if(u=!1,$("#templateTable").find("tbody tr").each((function(){if($(this).find(".tempCheck").prop("checked")){var t={name:$(this).find(".tempName").text(),firstPrice:100*Number($(this).find(".firstFreightPrice").val()),addPrice:100*Number($(this).find(".addFreightPrice").val())};p.push(t)}})),0===p.length)throw"不免邮费时请至少选择一个运费模板";h.firstFreightPrice=p[0].firstPrice,h.addFreightPrice=p[0].addPrice}var m=[];if($("#productImages").find("img.picShow").each((function(){m.push($(this).attr("imageId"))})),0==m.length)return screenTopWarning("至少上传一张商品图");var f=m[0],v=d(),b=g(),y=o();nkcAPI("/shop/manage/"+t+"/goodslist/editProduct","PUT",{stockCostMethod:i,purchaseLimitCount:a,uploadCert:l,uploadCertDescription:s,isFreePost:u,freightPrice:h,freightTemplates:p,productId:e,params:v,productParams:b,singleParams:y,vipDiscount:n,vipDisGroup:r,productSettings:c,imgIntroductions:m,imgMaster:f}).then((function(e){screenTopAlert("修改成功"),openToNewLocation("/shop/manage/"+t+"/goodslist")})).catch((function(t){screenTopWarning(t.error||t),$("#resaveBtn").removeAttr("disabled")}))},appAttachHideOrShow:function(){loadMediaRe(),"block"===$("#attach").css("display")?($("#showOrHideAttach").text("插入图片、媒体、文件"),$("#attach").css("display","none")):($("#showOrHideAttach").text("收起附件管理器"),$("#attach").css("display","block"))}})}));
