!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e=NKC.methods.getDataById("data").dealInfo||{},n=e.address,t=void 0===n?"":n,i=e.dealDescription,a=void 0===i?"":i,c=e.dealAnnouncement,s=void 0===c?"":c,d=e.templates,o=void 0===d?[]:d,r="",m=t.indexOf("&");-1===m?(r=t,t=""):(r=t.slice(0,m),t=t.slice(m+1)),window.app=new Vue({el:"#address",data:{dealDescription:a,dealAnnouncement:s,address:t,templates:o,location:r},mounted:function(){window.SelectAddress=new NKC.modules.SelectAddress},methods:{selectAddress:function(e){SelectAddress.open((function(e){app.location=e.join("/")}),{onlyChina:!0})},checkString:NKC.methods.checkData.checkString,checkNumber:NKC.methods.checkData.checkNumber,save:function(){var e=this.dealDescription,n=this.dealAnnouncement,t=this.address,i=this.templates,a=this.location;Promise.resolve().then((function(){if(app.checkString(e,{name:"供货说明",minLength:0,maxLength:500}),app.checkString(n,{name:"全局公告",minLength:0,maxLength:500}),!a)throw"请选择区域";if(app.checkString(a,{name:"区域",minLength:1,maxLength:500}),!t)throw"请输入详细地址";return app.checkString(t,{name:"详细地址",minLength:1,maxLength:500}),i.map((function(e){e.firstPrice=parseFloat(e.firstPrice),e.addPrice=parseFloat(e.addPrice);var n=e.name,t=e.firstPrice,i=e.addPrice;app.checkString(n,{name:"模板名称",minLength:1,maxLength:100}),app.checkNumber(t,{name:"首件价格",min:0,fractionDigits:2}),app.checkNumber(i,{name:"首件后每件价格",min:0,fractionDigits:2})})),nkcAPI("/shop/manage/settings","PUT",{dealDescription:e,dealAnnouncement:n,address:t,templates:i,location:a})})).then((function(){sweetSuccess("保存成功")})).catch(sweetError)},addTemplate:function(){this.templates.push({name:"新建模板",firstPrice:0,addPrice:0})},removeTemplate:function(e){this.templates.splice(e,1)}}})}));
