!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var t={};function r(e){return e=(e/100).toFixed(2)}$(document).ready((function(){$("input[type=radio][name=address]").change((function(){$(".addressSelected").removeClass("addressSelected"),$(this).parents(".addressBox").addClass("addressSelected"),$("#finalAddress").text($(this).next().find(".address").text()),$("#finalName").text($(this).next().find(".username").text()),$("#finalMobile").text($(this).next().find(".mobile").text())}))})),e(window,{paramCert:t,submitOrders:function(){var e=$("input[name='address']:checked");return window.receiveAddress=e.next().find(".address").text(),window.receiveName=e.next().find(".username").text(),window.receiveMobile=e.next().find(".mobile").text(),sweetWarning("请选择收货地址")},addAddress:function(){},uploadCert:function(e){$("#input_"+e).click()},inputChange:function(e){var r=e.getAttribute("data-param-id"),n=e.files[0],i=new FormData;i.append("type","shopping"),i.append("file",n),uploadFilePromise("/shop/cert",i,(function(e){console.log(e)})).then((function(e){screenTopAlert("上传成功"),t[r]=e.cert._id,$(".cert-"+r+" button").removeClass("hidden")})).catch((function(e){sweetWarning(e)}))},viewCert:function(e){window.open("/shop/cert/"+t[e])},countAddOne:function(e){$(e).attr("disabled","true");var t=parseInt($(e).next().text());t++;var n=$(e).attr("productParamId"),i=$(e).attr("cartId");nkcAPI("/shop/bill/add","PUT",{productParamId:n,cartId:i,count:t}).then((function(n){$(e).removeAttr("disabled"),$(e).next().text(t+"");var a=n.singlePrices-100*Number($(e).parents("tr").find("#singlePrices").text());$(e).parents("tr").find("#singlePrices").text(r(n.singlePrices)),n.singlePrices;var o=$("#isFreePost"+i).attr("isFreePost"),d=0,s=0;o&&"false"===o&&(s=Number($("#tempArr"+i).find("option:selected").attr("dataffp")),d=Number($("#tempArr"+i).find("option:selected").attr("dataafp")));var l=s+d*(t-1),c=l-100*Number($("#freightSingle"+i).text());$("#freightSingle"+i).text(numToNumberTwo(l));var u=a+c;$("#billTotalPrice"+n.sellUid).text(numToNumberTwo(u+100*Number($("#billTotalPrice"+n.sellUid).text()))),$("#totalPrice").text(numToNumberTwo(u+100*Number($("#totalPrice").text())))})).catch((function(t){return $(e).removeAttr("disabled"),sweetWarning(t.error||t)}))},countPlusOne:function(e){$(e).attr("disabled","true");var t=parseInt($(e).prev().text());if(--t<1)return $(e).removeAttr("disabled"),sweetWarning("至少购买一件商品");var n=$(e).attr("productParamId"),i=$(e).attr("cartId");nkcAPI("/shop/bill/plus","PUT",{productParamId:n,cartId:i,count:t}).then((function(n){$(e).removeAttr("disabled"),$(e).prev().text(t+"");var a=n.singlePrices-100*Number($(e).parents("tr").find("#singlePrices").text());$(e).parents("tr").find("#singlePrices").text(r(n.singlePrices)),n.singlePrices;var o=$("#isFreePost"+i).attr("isFreePost"),d=0,s=0;o&&"false"===o&&(s=Number($("#tempArr"+i).find("option:selected").attr("dataffp")),d=Number($("#tempArr"+i).find("option:selected").attr("dataafp")));var l=s+d*(t-1),c=l-100*Number($("#freightSingle"+i).text());$("#freightSingle"+i).text(numToNumberTwo(l));var u=a+c;$("#billTotalPrice"+n.sellUid).text(numToNumberTwo(u+100*Number($("#billTotalPrice"+n.sellUid).text()))),$("#totalPrice").text(numToNumberTwo(u+100*Number($("#totalPrice").text())))})).catch((function(t){return $(e).removeAttr("disabled"),sweetWarning(t.error||t)}))},reCountSinglePrice:function(e){},numToFloatTwo:r,changeFreightTemplate:function(e){var t=$(e).attr("datauid"),r=$(e).attr("dataid");$(e).val();var n=Number($(e).find("option:selected").attr("dataffp")),i=Number($(e).find("option:selected").attr("dataafp")),a=100*Number($("#freightSingle"+r).text()),o=n+i*($("#cartCount"+r).text()-1),d=o-a;$("#freightSingle"+r).text(numToNumberTwo(o)),$("#billTotalPrice"+t).text(numToNumberTwo(d+100*Number($("#billTotalPrice"+t).text()))),$("#totalPrice").text(numToNumberTwo(d+100*Number($("#totalPrice").text())))}})}));
