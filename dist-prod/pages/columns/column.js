!function(o){"function"==typeof define&&define.amd?define(o):o()}((function(){"use strict";function o(){return(o=Object.assign||function(o){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(o[e]=n[e])}return o}).apply(this,arguments)}$((function(){window.CommonModal||(window.CommonModal=new NKC.modules.CommonModal),window.SubscribeTypes||(a=new NKC.modules.SubscribeTypes)}));var t=NKC.methods.getDataById("data"),n=t.color,e=t.listColor,r=t.toolColor,a=window.SubscribeTypes,i=window.CommonModal;function s(){$(".column-fast-set-body").toggle()}$((function(){NKC.methods.initSelectColor((function(o,t){"columnColor"===t?($("body").css({"background-color":o}),n=o):"listColor"===t?(console.log(o),$(".column-thread-list-container").css({"background-color":o}),e=o):"toolColor"===t&&($(".column-tool-container").css({"background-color":o}),r=o)}));var o=$(".column-subscribe"),t=o.find(".column-button"),i=o.find(".column-number"),s=o.attr("data-column-id");t.on("click",(function(){if("true"!==t.attr("data-disabled")){var n="true"===o.attr("data-subscribed"),e=Number(o.attr("data-number"));return o.attr("data-subscribed",!n),Promise.resolve().then((function(){return t.attr("data-disabled","true"),a.subscribeColumnPromise(s,!n)})).then((function(){(e+=n?-1:1)<=0?i.addClass("hidden"):i.removeClass("hidden"),i.text(e),o.attr("data-number",e),o.attr("data-subscribed",!n),t.attr("data-disabled","false")})).catch((function(o){t.attr("data-disabled","false"),sweetError(o)}))}}))})),o(window,{bodyBackgroundColor:n,CommonModal:i,SubscribeTypes:a,showSetDom:s,showShareDom:function(){$(".column-share-body").toggle()},saveSettings:function(){nkcAPI("/m/"+t.columnId,"PUT",{type:"color",color:n,listColor:e,toolColor:r}).then((function(){screenTopAlert("保存成功"),s()})).catch((function(o){screenTopWarning(o)}))},openNewWindow:function(o){var t=window.location.origin;new RegExp("^"+t,"i").test(o)?openToNewLocation(o):openToNewLocation(o,"_blank")},pushToHome:function(o,t){nkcAPI("/m/"+o+"/hot","push"===t?"POST":"DELETE").then((function(){window.location.reload()})).catch(sweetError)},subscribeColumn:function(o){if(!NKC.configs.uid)return NKC.methods.toLogin();var t=$('[data-type="subscriptionButton"][data-column-id="'+o+'"]'),n=$('[data-type="subscriptionNumber"][data-column-id="'+o+'"]'),e="true"===t.attr("data-subscribed"),r=Number(n.attr("data-number"));return Promise.resolve().then((function(){return a.subscribeColumnPromise(o,!e)})).then((function(){e?(r--,t.attr("data-subscribed","false").removeClass("btn-default").addClass("btn-primary").text("关注")):(r++,t.attr("data-subscribed","true").removeClass("btn-primary").addClass("btn-default").text("已关注")),n.attr("data-number",r).text(NKC.methods.tools.briefNumber(r))})).catch(sweetError)},toppedColumn:function(o,t){nkcAPI("/m/"+o+"/top","push"===t?"POST":"DELETE").then((function(){window.location.reload()})).catch(sweetError)}})}));
