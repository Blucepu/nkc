!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e=NKC.methods.getDataById("data"),t=new Vue({el:"#app",data:{column:e.column,user:e.user,selectedThreads:[],threads:[],chooseTid:[],succeed:!1,showThreads:!1,categories:e.categories,mainCategoriesId:[],minorCategoriesId:[],mainCategories:e.mainCategories,minorCategories:e.minorCategories,pid:"",paging:{page:0},description:"",error:""},mounted:function(){this.getThreads()},computed:{selectedThreadsId:function(){for(var e=this.selectedThreads,t=[],s=0;s<e.length;s++){var i=e[s];t.push(i.tid)}return t}},methods:{getUrl:NKC.methods.tools.getUrl,reset:function(){this.pid="",this.getThreads()},search:function(){this.pid&&nkcAPI("/t?type=selfThreads&pid="+this.pid+"&columnId="+this.column._id,"GET").then((function(e){t.paging="";for(var s=0;s<e.threads.length;s++)e.threads[s].showInfo=!1;t.threads=e.threads})).catch((function(e){sweetError(e)}))},selectPage:function(e,t){"null"!==e&&this.getThreads(t)},getThreadById:function(e){for(var t=this.threads,s=0;s<t.length;s++)if(t[s].tid===e)return t[s]},remove:function(e){this.selectedThreads.splice(e,1)},getThreads:function(e){e=e||0,this.chooseTid=[],nkcAPI("/t?type=selfThreads&columnId="+this.column._id+"&page="+e,"GET").then((function(e){t.paging=e.paging;for(var s=0;s<e.threads.length;s++)e.threads[s].showInfo=!1;t.threads=e.threads})).catch((function(e){screenTopWarning(e)}))},choose:function(){for(var e=this.selectedThreadsId,t=this.chooseTid,s=0;s<t.length;s++){var i=t[s];if(-1===e.indexOf(i)){var h=this.getThreadById(i);this.selectedThreads.push(h)}}this.chooseTid=[]},showThreadsToggle:function(){this.showThreads=!this.showThreads,this.chooseTid=[]},showAllThreadsInfo:function(){for(var e=this.threads,t=e.length,s=0,i=0;i<t;i++)e[i].showInfo&&s++;var h=!0;for(t===s&&(h=!1),i=0;i<t;i++)e[i].showInfo=h},checkAll:function(){var e=this.threads;if(this.chooseTid.length===e.length)this.chooseTid=[];else{this.chooseTid=[];for(var t=0;t<this.threads.length;t++)this.chooseTid.push(this.threads[t].tid)}},submit:function(){this.error="";var e=this.selectedThreadsId;return 0===e.length?this.error="请选择需要投稿的文章":this.mainCategoriesId&&0!==this.mainCategoriesId.length?void nkcAPI("/m/"+this.column._id+"/contribute","POST",{threadsId:e,mainCategoriesId:this.mainCategoriesId,minorCategoriesId:this.minorCategoriesId,description:this.description}).then((function(){t.succeed=!0})).catch((function(e){t.error=e.error||e})):this.error="请选择文章分类"}}})}));
