!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";var t=new function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var e=this;e.dom=$("#moduleStickerViewer"),e.dom.modal({show:!1}),e.app=new Vue({el:"#moduleStickerViewerApp",data:{sticker:"",uid:NKC.configs.uid,management:!1,loading:!1},mounted:function(){this.init()},methods:{getUrl:NKC.methods.tools.getUrl,fromNow:NKC.methods.fromNow,collection:function(){nkcAPI("/sticker","POST",{type:"collection",stickersId:[this.sticker._id]}).then((function(){e.app.close(),sweetSuccess("表情已添加")})).catch(sweetError)},moveSticker:function(){var t={type:"move",stickersId:[this.sticker.collected._id]};nkcAPI("/sticker","POST",t).then((function(){e.app.close(),window.location.reload()})).catch(sweetError)},shareSticker:function(){var t={type:"share",stickersId:[this.sticker._id]};nkcAPI("/sticker","POST",t).then((function(){sweetSuccess("操作成功")})).catch(sweetError)},removeSticker:function(){var t=this.sticker;sweetQuestion("确定要删除表情？").then((function(){var e={type:"delete",stickersId:[t.collected._id]};return nkcAPI("/sticker","POST",e)})).then((function(){e.app.close(),window.location.reload()})).catch(sweetError)},init:function(){for(var t=$("[data-sticker-rid]"),i=0;i<t.length;i++){var n=t.eq(i);"true"!==n.attr("data-sticker-init")&&(n.on("click",(function(){e.app.open($(this).attr("data-sticker-rid"),!!$(this).attr("data-sticker-management"))})),n.attr("data-sticker-init","true"))}$("span[data-tag='nkcsource'][data-type='sticker']").each((function(){var t=$(this);"true"!==t.attr("data-sticker-init")&&(t.on("click",(function(){e.app.open($(this).attr("data-id"),!!$(this).attr("data-sticker-management"))})),t.attr("data-sticker-init","true"))}))},open:function(t,i){e.app.management=!!i,e.dom.modal("show"),this.loading=!0,nkcAPI("/sticker/".concat(t,"?t=json"),"GET").then((function(t){e.app.sticker=t.sticker,e.app.loading=!1})).catch((function(t){sweetError(t),e.app.close()}))},close:function(){e.dom.modal("hide")}}}),e.initPanel=e.app.init};NKC.methods.initStickerViewer=t.app.init}));
