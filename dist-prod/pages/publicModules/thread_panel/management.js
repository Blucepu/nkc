!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var t,n;function o(){for(var e=$(".thread-checkbox input"),t=[],n=[],o=0;o<e.length;o++){var a=e.eq(o);if(a.prop("checked")){t.push(a.attr("data-thread-id"));var r={tid:a.attr("data-thread-id")},d=a.attr("data-thread-cids")||"",c=a.attr("data-thread-fids")||"";d&&(r.cids=d.split("-"),r.fids=c.split("-")),n.push(r)}}return{threadsId:t,threads:n}}function a(){for(var e=$(".thread-checkbox input"),t=[],n=0;n<e.length;n++){var o=e.eq(n);o.prop("checked")&&t.push(o.attr("data-post-id"))}return t}$((function(){window.MoveThread=new NKC.modules.MoveThread,window.DisabledPost=new NKC.modules.DisabledPost,t=window.MoveThread,n=window.DisabledPost})),e(window,{getSelectedThreadsId:o,getSelectedPostsId:a,disabledSelectedPosts:function(){var e=a();if(0===e.length)return screenTopWarning("请至少勾选一篇文章");n.open((function(t){var o,a=t.type,r=t.reason,d=t.remindUser,c=t.violation,i={postsId:e,reason:r,remindUser:d,violation:c};o="toDraft"===a?"/threads/draft":"/threads/recycle",n.lock(),nkcAPI(o,"POST",i).then((function(){screenTopAlert("操作成功"),n.close(),n.unlock()})).catch((function(e){screenTopWarning(e),n.unlock()}))}))},moveSelectedThreads:function(){var e=o(),n=e.threadsId,a={};if(0===n.length)return screenTopWarning("请至少勾选一篇文章");if(1===n.length){var r=e.threads[0];a.selectedCategoriesId=r.cids,a.selectedForumsId=r.fids}t.open((function(e){var o=e.forums,a=e.moveType,r=e.violation,d=e.violationReason;t.lock(),nkcAPI("/threads/move","POST",{forums:o,moveType:a,threadsId:n,violation:r,violationReason:d}).then((function(){screenTopAlert("操作成功"),t.close()})).catch((function(e){screenTopWarning(e),t.unlock()}))}),a)},managementThreads:function(){var e=$(".thread-checkbox label");e.toggle(),"none"===e.css("display")?($(".thread-checkbox input").prop("checked",!1),$(".management-thread-panel").css("display","none")):$(".management-thread-panel").css("display","inline")},selectAll:function(){if("none"!==$(".thread-checkbox label").css("display")){for(var e=$(".thread-checkbox input"),t=e.length,n=0,o=0;o<t;o++){e.eq(o).prop("checked")&&n++}t===n?e.prop("checked",!1):e.prop("checked",!0)}}})}));
