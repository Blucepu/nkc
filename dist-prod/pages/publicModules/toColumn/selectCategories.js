!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";NKC.modules.SelectColumnCategories=function(){var e=this;e.dom=$("#moduleSelectColumnCategories"),e.columnId=e.dom.attr("data-column-id");var t=!!e.dom.attr("data-to-column");e.app=new Vue({el:"#moduleSelectColumnCategories",data:{loaded:!1,choose:t?[!0]:[],mainCategories:[],minorCategories:[],selectedMainCategoriesId:[],selectedMinorCategoriesId:[],error:"",createCategory:!1,newCategory:{parentId:"",name:"",description:"",type:"main"}},mounted:function(){this.choose.length&&this.getCategories()},methods:{getMainCategoryById:function(e){for(var t=0;t<this.mainCategories.length;t++)if(this.mainCategories[t]._id===e)return this.mainCategories[t]},getMinorCategoryById:function(e){for(var t=0;t<this.minorCategories.length;t++)if(this.minorCategories[t]._id===e)return this.minorCategories[t]},getCategories:function(){nkcAPI("/m/"+e.columnId+"/category?from=fastPost","GET").then((function(t){e.app.loaded=!0;for(var o=0;o<t.mainCategories.length;o++){for(var i=t.mainCategories[o],r="",a=0;a<i.level;a++)r+="&nbsp;&nbsp;&nbsp;";i.str=r}e.app.mainCategories=t.mainCategories,e.app.minorCategories=t.minorCategories})).catch((function(t){e.app.loaded=!0,sweetError(t)}))},saveCategory:function(){var t=this;this.error="";var o=this.newCategory;return o.type?o.name?o.description?void nkcAPI("/m/"+e.columnId+"/category","POST",o).then((function(){t.getCategories(),t.createCategory=!1,t.newCategory={name:"",description:"",parentId:"",type:"main"}})).catch((function(e){sweetError(e)})):this.error="请输入分类介绍":this.error="请输入分类名":this.error="请选择分类类型"},addCategory:function(){this.createCategory=!0},cancelAddCategory:function(){this.createCategory=!1}},computed:{selectedMainCategories:function(){for(var e=[],t=0;t<this.selectedMainCategoriesId.length;t++){var o=this.getMainCategoryById(this.selectedMainCategoriesId[t]);o&&e.push(o)}return e},selectedMinorCategories:function(){for(var e=[],t=0;t<this.selectedMinorCategoriesId.length;t++){var o=this.getMinorCategoryById(this.selectedMinorCategoriesId[t]);o&&e.push(o)}return e}},watch:{choose:function(){this.choose.length>0&&0===this.mainCategories.length?this.getCategories():(e.app.loaded=!1,e.app.mainCategories=[],e.app.selectedMainCategoriesId=[],e.app.minorCategories=[],e.app.selectedMinorCategoriesId=[])}}}),e.getStatus=function(){return{selectedMainCategories:e.app.selectedMainCategories,selectedMainCategoriesId:e.app.selectedMainCategoriesId,selectedMinorCategories:e.app.selectedMinorCategories,selectedMinorCategoriesId:e.app.selectedMinorCategoriesId,checkbox:e.app.choose.length>0}}}}));
