!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function e(t){return(e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?o(t):e}function a(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,a=e(t);if(n){var i=e(this).constructor;o=Reflect.construct(a,arguments,i)}else o=a.apply(this,arguments);return r(this,o)}}var i=new(function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}(s,NKC.modules.DraggablePanel);var r,i,c,u=a(s);function s(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);var e="#moduleSharePanel",n=o(t=u.call(this,e));return n.dom=$(e),n.app=new Vue({el:e+"App",data:{loading:!0,shareType:"",shareId:"",url:"",cover:"",title:"",description:"",platforms:[{type:"wechat"},{type:"QQ"},{type:"qzone"},{type:"weibo"}],showQR:!1,clipboard:null},computed:{},mounted:function(){},methods:{getUrl:NKC.methods.tools.getUrl,open:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.showPanel();var e=t.shareType,o=t.shareId;n.app.shareType=e,n.app.shareId=o;var r="/s?type=".concat(e,"&id=").concat(o);nkcAPI(r,"GET").then((function(t){var e=t.result,o=e.url,r=e.cover,a=e.title,i=e.description;n.app.url=window.location.origin+o,n.app.cover=r,n.app.title=a,n.app.description=i,n.app.loading=!1,$(".wechat-container.qrcode-canvas").attr("data-init","false"),setTimeout((function(){NKC.methods.initQrcodeCanvas()}),500)})).catch(sweetError)},close:function(){this.showQR=!1,n.app.loading=!0,n.hidePanel()},share:function(t){if("wechat"===t)return this.showQR=!this.showQR;var e=this.url,o=this.title,r=this.description,a=this.cover;if("copy"===t){if(console.log(this.clipboard),this.clipboard)return;return this.clipboard=new ClipboardJS("#sharePanelButton",{text:function(t){return n.app.url}}),this.clipboard.on("success",(function(){screenTopAlert("链接已复制到粘贴板")}))}var i=window.open(),c=window.location.origin+a;i.location="QQ"===t?"http://connect.qq.com/widget/shareqq/index.html?url=".concat(e,"&title=").concat(o,"&pics=").concat(c,"&summary=").concat(r):"qzone"===t?"https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=".concat(e,"&title=").concat(o,"&pics=").concat(c,"&summary=").concat(r):"http://v.t.sina.com.cn/share/share.php?url=".concat(e,"&title=").concat(o,"&pic=").concat(c)}}}),t}return r=s,(i=[{key:"open",value:function(t,e){this.app.open(t,e)}}])&&t(r.prototype,i),c&&t(r,c),s}());window.sharePanel=i,NKC.methods.initSharePanel=function(){for(var t=$('[data-type="share"]'),e=function(e){var n=t.eq(e);if("true"===n.attr("data-init"))return"continue";n.on("click",(function(){var t=n.attr("data-share-type"),e=n.attr("data-share-id");i.open({shareType:t,shareId:e})})),n.attr("data-init","true")},n=0;n<t.length;n++)e(n)},$((function(){NKC.methods.initSharePanel()}))}));
