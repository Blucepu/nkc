!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";NKC.modules.SelectDraft=function(){return function t(){!function(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,t);var o=this;o.dom=$("#moduleSelectDraft"),o.app=new Vue({el:"#moduleSelectDraftApp",data:{uid:NKC.configs.uid,paging:{},perpage:7,loading:!0,drafts:[]},methods:{fromNow:NKC.methods.fromNow,initDom:function(){o.dom.css({height:"43.5rem"}),o.dom.draggable({scroll:!1,handle:".module-sd-title",drag:function(t,n){n.position.top<0&&(n.position.top=0);var e=$(window).height();n.position.top>e-30&&(n.position.top=e-30);var i=o.dom.width();n.position.left<100-i&&(n.position.left=100-i);var a=$(window).width();n.position.left>a-100&&(n.position.left=a-100)}});var t=$(window).width();t<700?o.dom.css({width:.8*t,top:0,right:0}):o.dom.css("left",.5*(t-o.dom.width())-20),o.dom.show()},getDraftInfo:function(t){var o=t.type,n=t.thread,e=t.forum;return"newThread"===o?"发表文章":"newPost"===o?"在文章《".concat(n.title,"》下发表回复"):"modifyPost"===o?"修改文章《".concat(n.title,"》下的回复"):"modifyThread"===o?"修改文章《".concat(n.title,"》"):"修改专业《".concat(e.title,"modifyForumLatestNotice"===o?"》最新页板块公告":"》的专业说明")},insert:function(t){var n=NKC.methods.ueditor.setContent(t.content);o.callback({content:n}),t.delay=3;!function o(){setTimeout((function(){t.delay--,t.delay>0&&o()}),1e3)}()},removeDraft:function(t){var n=this;sweetQuestion("确定要删除草稿吗？").then((function(){nkcAPI("/u/"+n.uid+"/drafts/"+t.did,"DELETE").then((function(){o.app.getDrafts(o.app.paging.page)})).catch((function(t){sweetError(t)}))}))},getDrafts:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;nkcAPI("/u/".concat(this.uid,"/profile/draft?page=").concat(t,"&perpage=").concat(this.perpage),"GET").then((function(t){t.drafts.map((function(t){t.delay=0})),o.app.drafts=t.drafts,o.app.paging=t.paging,o.app.loading=!1})).catch(sweetError)},loadDraft:function(t){sweetQuestion("继续创作将会覆盖编辑器中全部内容，确定继续？").then((function(){window.PostInfo&&window.PostInfo.showCloseInfo&&(window.PostInfo.showCloseInfo=!1),window.location.href="/editor?type=redit&id=".concat(t.did)})).catch(sweetError)},refresh:function(){this.getDrafts(o.app.paging.page)},open:function(t){o.callback=t,this.initDom(),this.getDrafts()},close:function(){o.dom.hide()}}}),o.open=o.app.open,o.close=o.app.close}}()}));
